(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function np(t,e){const n=Object.create(null),r=t.split(",");for(let i=0;i<r.length;i++)n[r[i]]=!0;return e?i=>!!n[i.toLowerCase()]:i=>!!n[i]}const IC="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",AC=np(IC);function xv(t){return!!t||t===""}function rp(t){if(de(t)){const e={};for(let n=0;n<t.length;n++){const r=t[n],i=ot(r)?OC(r):rp(r);if(i)for(const s in i)e[s]=i[s]}return e}else{if(ot(t))return t;if(He(t))return t}}const _C=/;(?![^(]*\))/g,MC=/:(.+)/;function OC(t){const e={};return t.split(_C).forEach(n=>{if(n){const r=n.split(MC);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Qt(t){let e="";if(ot(t))e=t;else if(de(t))for(let n=0;n<t.length;n++){const r=Qt(t[n]);r&&(e+=r+" ")}else if(He(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function NC(t,e){if(t.length!==e.length)return!1;let n=!0;for(let r=0;n&&r<t.length;r++)n=mu(t[r],e[r]);return n}function mu(t,e){if(t===e)return!0;let n=ym(t),r=ym(e);if(n||r)return n&&r?t.getTime()===e.getTime():!1;if(n=Ea(t),r=Ea(e),n||r)return t===e;if(n=de(t),r=de(e),n||r)return n&&r?NC(t,e):!1;if(n=He(t),r=He(e),n||r){if(!n||!r)return!1;const i=Object.keys(t).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in t){const a=t.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!mu(t[o],e[o]))return!1}}return String(t)===String(e)}function Sv(t,e){return t.findIndex(n=>mu(n,e))}const mm=t=>ot(t)?t:t==null?"":de(t)||He(t)&&(t.toString===kv||!Ce(t.toString))?JSON.stringify(t,Tv,2):String(t),Tv=(t,e)=>e&&e.__v_isRef?Tv(t,e.value):Ws(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[r,i])=>(n[`${r} =>`]=i,n),{})}:bu(e)?{[`Set(${e.size})`]:[...e.values()]}:He(e)&&!de(e)&&!Iv(e)?String(e):e,Ue={},qs=[],$n=()=>{},DC=()=>!1,RC=/^on[^a-z]/,yu=t=>RC.test(t),ip=t=>t.startsWith("onUpdate:"),Bt=Object.assign,sp=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},PC=Object.prototype.hasOwnProperty,Me=(t,e)=>PC.call(t,e),de=Array.isArray,Ws=t=>il(t)==="[object Map]",bu=t=>il(t)==="[object Set]",ym=t=>il(t)==="[object Date]",Ce=t=>typeof t=="function",ot=t=>typeof t=="string",Ea=t=>typeof t=="symbol",He=t=>t!==null&&typeof t=="object",Cv=t=>He(t)&&Ce(t.then)&&Ce(t.catch),kv=Object.prototype.toString,il=t=>kv.call(t),LC=t=>il(t).slice(8,-1),Iv=t=>il(t)==="[object Object]",op=t=>ot(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,sc=np(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),wu=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},BC=/-(\w)/g,ur=wu(t=>t.replace(BC,(e,n)=>n?n.toUpperCase():"")),FC=/\B([A-Z])/g,ko=wu(t=>t.replace(FC,"-$1").toLowerCase()),vu=wu(t=>t.charAt(0).toUpperCase()+t.slice(1)),Oh=wu(t=>t?`on${vu(t)}`:""),xa=(t,e)=>!Object.is(t,e),oc=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Tc=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},Od=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let bm;const VC=()=>bm||(bm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Jn;class $C{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Jn&&(this.parent=Jn,this.index=(Jn.scopes||(Jn.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Jn;try{return Jn=this,e()}finally{Jn=n}}}on(){Jn=this}off(){Jn=this.parent}stop(e){if(this.active){let n,r;for(n=0,r=this.effects.length;n<r;n++)this.effects[n].stop();for(n=0,r=this.cleanups.length;n<r;n++)this.cleanups[n]();if(this.scopes)for(n=0,r=this.scopes.length;n<r;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function UC(t,e=Jn){e&&e.active&&e.effects.push(t)}const ap=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Av=t=>(t.w&ti)>0,_v=t=>(t.n&ti)>0,zC=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=ti},HC=t=>{const{deps:e}=t;if(e.length){let n=0;for(let r=0;r<e.length;r++){const i=e[r];Av(i)&&!_v(i)?i.delete(t):e[n++]=i,i.w&=~ti,i.n&=~ti}e.length=n}},Nd=new WeakMap;let Jo=0,ti=1;const Dd=30;let Pn;const zi=Symbol(""),Rd=Symbol("");class lp{constructor(e,n=null,r){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,UC(this,r)}run(){if(!this.active)return this.fn();let e=Pn,n=Kr;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Pn,Pn=this,Kr=!0,ti=1<<++Jo,Jo<=Dd?zC(this):wm(this),this.fn()}finally{Jo<=Dd&&HC(this),ti=1<<--Jo,Pn=this.parent,Kr=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Pn===this?this.deferStop=!0:this.active&&(wm(this),this.onStop&&this.onStop(),this.active=!1)}}function wm(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Kr=!0;const Mv=[];function Io(){Mv.push(Kr),Kr=!1}function Ao(){const t=Mv.pop();Kr=t===void 0?!0:t}function mn(t,e,n){if(Kr&&Pn){let r=Nd.get(t);r||Nd.set(t,r=new Map);let i=r.get(n);i||r.set(n,i=ap()),Ov(i)}}function Ov(t,e){let n=!1;Jo<=Dd?_v(t)||(t.n|=ti,n=!Av(t)):n=!t.has(Pn),n&&(t.add(Pn),Pn.deps.push(t))}function Sr(t,e,n,r,i,s){const o=Nd.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&de(t))o.forEach((l,c)=>{(c==="length"||c>=r)&&a.push(l)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":de(t)?op(n)&&a.push(o.get("length")):(a.push(o.get(zi)),Ws(t)&&a.push(o.get(Rd)));break;case"delete":de(t)||(a.push(o.get(zi)),Ws(t)&&a.push(o.get(Rd)));break;case"set":Ws(t)&&a.push(o.get(zi));break}if(a.length===1)a[0]&&Pd(a[0]);else{const l=[];for(const c of a)c&&l.push(...c);Pd(ap(l))}}function Pd(t,e){const n=de(t)?t:[...t];for(const r of n)r.computed&&vm(r);for(const r of n)r.computed||vm(r)}function vm(t,e){(t!==Pn||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const jC=np("__proto__,__v_isRef,__isVue"),Nv=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Ea)),KC=cp(),qC=cp(!1,!0),WC=cp(!0),Em=GC();function GC(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const r=Be(this);for(let s=0,o=this.length;s<o;s++)mn(r,"get",s+"");const i=r[e](...n);return i===-1||i===!1?r[e](...n.map(Be)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){Io();const r=Be(this)[e].apply(this,n);return Ao(),r}}),t}function cp(t=!1,e=!1){return function(r,i,s){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&s===(t?e?uk:Bv:e?Lv:Pv).get(r))return r;const o=de(r);if(!t&&o&&Me(Em,i))return Reflect.get(Em,i,s);const a=Reflect.get(r,i,s);return(Ea(i)?Nv.has(i):jC(i))||(t||mn(r,"get",i),e)?a:Nt(a)?o&&op(i)?a:a.value:He(a)?t?Fv(a):xu(a):a}}const JC=Dv(),XC=Dv(!0);function Dv(t=!1){return function(n,r,i,s){let o=n[r];if(no(o)&&Nt(o)&&!Nt(i))return!1;if(!t&&(!Cc(i)&&!no(i)&&(o=Be(o),i=Be(i)),!de(n)&&Nt(o)&&!Nt(i)))return o.value=i,!0;const a=de(n)&&op(r)?Number(r)<n.length:Me(n,r),l=Reflect.set(n,r,i,s);return n===Be(s)&&(a?xa(i,o)&&Sr(n,"set",r,i):Sr(n,"add",r,i)),l}}function YC(t,e){const n=Me(t,e);t[e];const r=Reflect.deleteProperty(t,e);return r&&n&&Sr(t,"delete",e,void 0),r}function QC(t,e){const n=Reflect.has(t,e);return(!Ea(e)||!Nv.has(e))&&mn(t,"has",e),n}function ZC(t){return mn(t,"iterate",de(t)?"length":zi),Reflect.ownKeys(t)}const Rv={get:KC,set:JC,deleteProperty:YC,has:QC,ownKeys:ZC},ek={get:WC,set(t,e){return!0},deleteProperty(t,e){return!0}},tk=Bt({},Rv,{get:qC,set:XC}),up=t=>t,Eu=t=>Reflect.getPrototypeOf(t);function _l(t,e,n=!1,r=!1){t=t.__v_raw;const i=Be(t),s=Be(e);n||(e!==s&&mn(i,"get",e),mn(i,"get",s));const{has:o}=Eu(i),a=r?up:n?pp:Sa;if(o.call(i,e))return a(t.get(e));if(o.call(i,s))return a(t.get(s));t!==i&&t.get(e)}function Ml(t,e=!1){const n=this.__v_raw,r=Be(n),i=Be(t);return e||(t!==i&&mn(r,"has",t),mn(r,"has",i)),t===i?n.has(t):n.has(t)||n.has(i)}function Ol(t,e=!1){return t=t.__v_raw,!e&&mn(Be(t),"iterate",zi),Reflect.get(t,"size",t)}function xm(t){t=Be(t);const e=Be(this);return Eu(e).has.call(e,t)||(e.add(t),Sr(e,"add",t,t)),this}function Sm(t,e){e=Be(e);const n=Be(this),{has:r,get:i}=Eu(n);let s=r.call(n,t);s||(t=Be(t),s=r.call(n,t));const o=i.call(n,t);return n.set(t,e),s?xa(e,o)&&Sr(n,"set",t,e):Sr(n,"add",t,e),this}function Tm(t){const e=Be(this),{has:n,get:r}=Eu(e);let i=n.call(e,t);i||(t=Be(t),i=n.call(e,t)),r&&r.call(e,t);const s=e.delete(t);return i&&Sr(e,"delete",t,void 0),s}function Cm(){const t=Be(this),e=t.size!==0,n=t.clear();return e&&Sr(t,"clear",void 0,void 0),n}function Nl(t,e){return function(r,i){const s=this,o=s.__v_raw,a=Be(o),l=e?up:t?pp:Sa;return!t&&mn(a,"iterate",zi),o.forEach((c,u)=>r.call(i,l(c),l(u),s))}}function Dl(t,e,n){return function(...r){const i=this.__v_raw,s=Be(i),o=Ws(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=i[t](...r),u=n?up:e?pp:Sa;return!e&&mn(s,"iterate",l?Rd:zi),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function _r(t){return function(...e){return t==="delete"?!1:this}}function nk(){const t={get(s){return _l(this,s)},get size(){return Ol(this)},has:Ml,add:xm,set:Sm,delete:Tm,clear:Cm,forEach:Nl(!1,!1)},e={get(s){return _l(this,s,!1,!0)},get size(){return Ol(this)},has:Ml,add:xm,set:Sm,delete:Tm,clear:Cm,forEach:Nl(!1,!0)},n={get(s){return _l(this,s,!0)},get size(){return Ol(this,!0)},has(s){return Ml.call(this,s,!0)},add:_r("add"),set:_r("set"),delete:_r("delete"),clear:_r("clear"),forEach:Nl(!0,!1)},r={get(s){return _l(this,s,!0,!0)},get size(){return Ol(this,!0)},has(s){return Ml.call(this,s,!0)},add:_r("add"),set:_r("set"),delete:_r("delete"),clear:_r("clear"),forEach:Nl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=Dl(s,!1,!1),n[s]=Dl(s,!0,!1),e[s]=Dl(s,!1,!0),r[s]=Dl(s,!0,!0)}),[t,n,e,r]}const[rk,ik,sk,ok]=nk();function hp(t,e){const n=e?t?ok:sk:t?ik:rk;return(r,i,s)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?r:Reflect.get(Me(n,i)&&i in r?n:r,i,s)}const ak={get:hp(!1,!1)},lk={get:hp(!1,!0)},ck={get:hp(!0,!1)},Pv=new WeakMap,Lv=new WeakMap,Bv=new WeakMap,uk=new WeakMap;function hk(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dk(t){return t.__v_skip||!Object.isExtensible(t)?0:hk(LC(t))}function xu(t){return no(t)?t:dp(t,!1,Rv,ak,Pv)}function fk(t){return dp(t,!1,tk,lk,Lv)}function Fv(t){return dp(t,!0,ek,ck,Bv)}function dp(t,e,n,r,i){if(!He(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=i.get(t);if(s)return s;const o=dk(t);if(o===0)return t;const a=new Proxy(t,o===2?r:n);return i.set(t,a),a}function Gs(t){return no(t)?Gs(t.__v_raw):!!(t&&t.__v_isReactive)}function no(t){return!!(t&&t.__v_isReadonly)}function Cc(t){return!!(t&&t.__v_isShallow)}function Vv(t){return Gs(t)||no(t)}function Be(t){const e=t&&t.__v_raw;return e?Be(e):t}function fp(t){return Tc(t,"__v_skip",!0),t}const Sa=t=>He(t)?xu(t):t,pp=t=>He(t)?Fv(t):t;function gp(t){Kr&&Pn&&(t=Be(t),Ov(t.dep||(t.dep=ap())))}function mp(t,e){t=Be(t),t.dep&&Pd(t.dep)}function Nt(t){return!!(t&&t.__v_isRef===!0)}function yp(t){return pk(t,!1)}function pk(t,e){return Nt(t)?t:new gk(t,e)}class gk{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Be(e),this._value=n?e:Sa(e)}get value(){return gp(this),this._value}set value(e){const n=this.__v_isShallow||Cc(e)||no(e);e=n?e:Be(e),xa(e,this._rawValue)&&(this._rawValue=e,this._value=n?e:Sa(e),mp(this))}}function $v(t){return Nt(t)?t.value:t}const mk={get:(t,e,n)=>$v(Reflect.get(t,e,n)),set:(t,e,n,r)=>{const i=t[e];return Nt(i)&&!Nt(n)?(i.value=n,!0):Reflect.set(t,e,n,r)}};function Uv(t){return Gs(t)?t:new Proxy(t,mk)}class yk{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:n,set:r}=e(()=>gp(this),()=>mp(this));this._get=n,this._set=r}get value(){return this._get()}set value(e){this._set(e)}}function bk(t){return new yk(t)}var zv;class wk{constructor(e,n,r,i){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[zv]=!1,this._dirty=!0,this.effect=new lp(e,()=>{this._dirty||(this._dirty=!0,mp(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=r}get value(){const e=Be(this);return gp(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}zv="__v_isReadonly";function vk(t,e,n=!1){let r,i;const s=Ce(t);return s?(r=t,i=$n):(r=t.get,i=t.set),new wk(r,i,s||!i,n)}function qr(t,e,n,r){let i;try{i=r?t(...r):t()}catch(s){Su(s,e,n)}return i}function An(t,e,n,r){if(Ce(t)){const s=qr(t,e,n,r);return s&&Cv(s)&&s.catch(o=>{Su(o,e,n)}),s}const i=[];for(let s=0;s<t.length;s++)i.push(An(t[s],e,n,r));return i}function Su(t,e,n,r=!0){const i=e?e.vnode:null;if(e){let s=e.parent;const o=e.proxy,a=n;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,o,a)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){qr(l,null,10,[t,o,a]);return}}Ek(t,n,i,r)}function Ek(t,e,n,r=!0){console.error(t)}let Ta=!1,Ld=!1;const Mt=[];let Zn=0;const Js=[];let mr=null,_i=0;const Hv=Promise.resolve();let bp=null;function jv(t){const e=bp||Hv;return t?e.then(this?t.bind(this):t):e}function xk(t){let e=Zn+1,n=Mt.length;for(;e<n;){const r=e+n>>>1;Ca(Mt[r])<t?e=r+1:n=r}return e}function wp(t){(!Mt.length||!Mt.includes(t,Ta&&t.allowRecurse?Zn+1:Zn))&&(t.id==null?Mt.push(t):Mt.splice(xk(t.id),0,t),Kv())}function Kv(){!Ta&&!Ld&&(Ld=!0,bp=Hv.then(Wv))}function Sk(t){const e=Mt.indexOf(t);e>Zn&&Mt.splice(e,1)}function Tk(t){de(t)?Js.push(...t):(!mr||!mr.includes(t,t.allowRecurse?_i+1:_i))&&Js.push(t),Kv()}function km(t,e=Ta?Zn+1:0){for(;e<Mt.length;e++){const n=Mt[e];n&&n.pre&&(Mt.splice(e,1),e--,n())}}function qv(t){if(Js.length){const e=[...new Set(Js)];if(Js.length=0,mr){mr.push(...e);return}for(mr=e,mr.sort((n,r)=>Ca(n)-Ca(r)),_i=0;_i<mr.length;_i++)mr[_i]();mr=null,_i=0}}const Ca=t=>t.id==null?1/0:t.id,Ck=(t,e)=>{const n=Ca(t)-Ca(e);if(n===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return n};function Wv(t){Ld=!1,Ta=!0,Mt.sort(Ck);const e=$n;try{for(Zn=0;Zn<Mt.length;Zn++){const n=Mt[Zn];n&&n.active!==!1&&qr(n,null,14)}}finally{Zn=0,Mt.length=0,qv(),Ta=!1,bp=null,(Mt.length||Js.length)&&Wv()}}function kk(t,e,...n){if(t.isUnmounted)return;const r=t.vnode.props||Ue;let i=n;const s=e.startsWith("update:"),o=s&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=r[u]||Ue;d&&(i=n.map(f=>f.trim())),h&&(i=n.map(Od))}let a,l=r[a=Oh(e)]||r[a=Oh(ur(e))];!l&&s&&(l=r[a=Oh(ko(e))]),l&&An(l,t,6,i);const c=r[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,An(c,t,6,i)}}function Gv(t,e,n=!1){const r=e.emitsCache,i=r.get(t);if(i!==void 0)return i;const s=t.emits;let o={},a=!1;if(!Ce(t)){const l=c=>{const u=Gv(c,e,!0);u&&(a=!0,Bt(o,u))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!s&&!a?(He(t)&&r.set(t,null),null):(de(s)?s.forEach(l=>o[l]=null):Bt(o,s),He(t)&&r.set(t,o),o)}function Tu(t,e){return!t||!yu(e)?!1:(e=e.slice(2).replace(/Once$/,""),Me(t,e[0].toLowerCase()+e.slice(1))||Me(t,ko(e))||Me(t,e))}let kn=null,Jv=null;function kc(t){const e=kn;return kn=t,Jv=t&&t.type.__scopeId||null,e}function Xv(t,e=kn,n){if(!e||t._n)return t;const r=(...i)=>{r._d&&Vm(-1);const s=kc(e),o=t(...i);return kc(s),r._d&&Vm(1),o};return r._n=!0,r._c=!0,r._d=!0,r}function Nh(t){const{type:e,vnode:n,proxy:r,withProxy:i,props:s,propsOptions:[o],slots:a,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:g}=t;let m,w;const _=kc(t);try{if(n.shapeFlag&4){const y=i||r;m=Yn(u.call(y,y,h,s,f,d,p)),w=l}else{const y=e;m=Yn(y.length>1?y(s,{attrs:l,slots:a,emit:c}):y(s,null)),w=e.props?l:Ik(l)}}catch(y){sa.length=0,Su(y,t,1),m=Dt(Un)}let M=m;if(w&&g!==!1){const y=Object.keys(w),{shapeFlag:L}=M;y.length&&L&7&&(o&&y.some(ip)&&(w=Ak(w,o)),M=ni(M,w))}return n.dirs&&(M=ni(M),M.dirs=M.dirs?M.dirs.concat(n.dirs):n.dirs),n.transition&&(M.transition=n.transition),m=M,kc(_),m}const Ik=t=>{let e;for(const n in t)(n==="class"||n==="style"||yu(n))&&((e||(e={}))[n]=t[n]);return e},Ak=(t,e)=>{const n={};for(const r in t)(!ip(r)||!(r.slice(9)in e))&&(n[r]=t[r]);return n};function _k(t,e,n){const{props:r,children:i,component:s}=t,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return r?Im(r,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==r[d]&&!Tu(c,d))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Im(r,o,c):!0:!!o;return!1}function Im(t,e,n){const r=Object.keys(e);if(r.length!==Object.keys(t).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==t[s]&&!Tu(n,s))return!0}return!1}function Mk({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const Ok=t=>t.__isSuspense;function Nk(t,e){e&&e.pendingBranch?de(t)?e.effects.push(...t):e.effects.push(t):Tk(t)}function Dk(t,e){if(ct){let n=ct.provides;const r=ct.parent&&ct.parent.provides;r===n&&(n=ct.provides=Object.create(r)),n[t]=e}}function Dh(t,e,n=!1){const r=ct||kn;if(r){const i=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(i&&t in i)return i[t];if(arguments.length>1)return n&&Ce(e)?e.call(r.proxy):e}}function Rk(t,e){return vp(t,null,e)}const Am={};function Rh(t,e,n){return vp(t,e,n)}function vp(t,e,{immediate:n,deep:r,flush:i,onTrack:s,onTrigger:o}=Ue){const a=ct;let l,c=!1,u=!1;if(Nt(t)?(l=()=>t.value,c=Cc(t)):Gs(t)?(l=()=>t,r=!0):de(t)?(u=!0,c=t.some(w=>Gs(w)||Cc(w)),l=()=>t.map(w=>{if(Nt(w))return w.value;if(Gs(w))return Fi(w);if(Ce(w))return qr(w,a,2)})):Ce(t)?e?l=()=>qr(t,a,2):l=()=>{if(!(a&&a.isUnmounted))return h&&h(),An(t,a,3,[d])}:l=$n,e&&r){const w=l;l=()=>Fi(w())}let h,d=w=>{h=m.onStop=()=>{qr(w,a,4)}};if(Ia)return d=$n,e?n&&An(e,a,3,[l(),u?[]:void 0,d]):l(),$n;let f=u?[]:Am;const p=()=>{if(!!m.active)if(e){const w=m.run();(r||c||(u?w.some((_,M)=>xa(_,f[M])):xa(w,f)))&&(h&&h(),An(e,a,3,[w,f===Am?void 0:f,d]),f=w)}else m.run()};p.allowRecurse=!!e;let g;i==="sync"?g=p:i==="post"?g=()=>Zt(p,a&&a.suspense):(p.pre=!0,a&&(p.id=a.uid),g=()=>wp(p));const m=new lp(l,g);return e?n?p():f=m.run():i==="post"?Zt(m.run.bind(m),a&&a.suspense):m.run(),()=>{m.stop(),a&&a.scope&&sp(a.scope.effects,m)}}function Pk(t,e,n){const r=this.proxy,i=ot(t)?t.includes(".")?Yv(r,t):()=>r[t]:t.bind(r,r);let s;Ce(e)?s=e:(s=e.handler,n=e);const o=ct;ro(this);const a=vp(i,s.bind(r),n);return o?ro(o):Hi(),a}function Yv(t,e){const n=e.split(".");return()=>{let r=t;for(let i=0;i<n.length&&r;i++)r=r[n[i]];return r}}function Fi(t,e){if(!He(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Nt(t))Fi(t.value,e);else if(de(t))for(let n=0;n<t.length;n++)Fi(t[n],e);else if(bu(t)||Ws(t))t.forEach(n=>{Fi(n,e)});else if(Iv(t))for(const n in t)Fi(t[n],e);return t}function Lk(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Iu(()=>{t.isMounted=!0}),ol(()=>{t.isUnmounting=!0}),t}const En=[Function,Array],Bk={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:En,onEnter:En,onAfterEnter:En,onEnterCancelled:En,onBeforeLeave:En,onLeave:En,onAfterLeave:En,onLeaveCancelled:En,onBeforeAppear:En,onAppear:En,onAfterAppear:En,onAppearCancelled:En},setup(t,{slots:e}){const n=f0(),r=Lk();let i;return()=>{const s=e.default&&Zv(e.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const g of s)if(g.type!==Un){o=g;break}}const a=Be(t),{mode:l}=a;if(r.isLeaving)return Ph(o);const c=_m(o);if(!c)return Ph(o);const u=Bd(c,a,r,n);Fd(c,u);const h=n.subTree,d=h&&_m(h);let f=!1;const{getTransitionKey:p}=c.type;if(p){const g=p();i===void 0?i=g:g!==i&&(i=g,f=!0)}if(d&&d.type!==Un&&(!Mi(c,d)||f)){const g=Bd(d,a,r,n);if(Fd(d,g),l==="out-in")return r.isLeaving=!0,g.afterLeave=()=>{r.isLeaving=!1,n.update()},Ph(o);l==="in-out"&&c.type!==Un&&(g.delayLeave=(m,w,_)=>{const M=Qv(r,d);M[String(d.key)]=d,m._leaveCb=()=>{w(),m._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=_})}return o}}},Fk=Bk;function Qv(t,e){const{leavingVNodes:n}=t;let r=n.get(e.type);return r||(r=Object.create(null),n.set(e.type,r)),r}function Bd(t,e,n,r){const{appear:i,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:g,onAppear:m,onAfterAppear:w,onAppearCancelled:_}=e,M=String(t.key),y=Qv(n,t),L=(N,G)=>{N&&An(N,r,9,G)},R=(N,G)=>{const ie=G[1];L(N,G),de(N)?N.every(he=>he.length<=1)&&ie():N.length<=1&&ie()},j={mode:s,persisted:o,beforeEnter(N){let G=a;if(!n.isMounted)if(i)G=g||a;else return;N._leaveCb&&N._leaveCb(!0);const ie=y[M];ie&&Mi(t,ie)&&ie.el._leaveCb&&ie.el._leaveCb(),L(G,[N])},enter(N){let G=l,ie=c,he=u;if(!n.isMounted)if(i)G=m||l,ie=w||c,he=_||u;else return;let ve=!1;const Ee=N._enterCb=Oe=>{ve||(ve=!0,Oe?L(he,[N]):L(ie,[N]),j.delayedLeave&&j.delayedLeave(),N._enterCb=void 0)};G?R(G,[N,Ee]):Ee()},leave(N,G){const ie=String(t.key);if(N._enterCb&&N._enterCb(!0),n.isUnmounting)return G();L(h,[N]);let he=!1;const ve=N._leaveCb=Ee=>{he||(he=!0,G(),Ee?L(p,[N]):L(f,[N]),N._leaveCb=void 0,y[ie]===t&&delete y[ie])};y[ie]=t,d?R(d,[N,ve]):ve()},clone(N){return Bd(N,e,n,r)}};return j}function Ph(t){if(Cu(t))return t=ni(t),t.children=null,t}function _m(t){return Cu(t)?t.children?t.children[0]:void 0:t}function Fd(t,e){t.shapeFlag&6&&t.component?Fd(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Zv(t,e=!1,n){let r=[],i=0;for(let s=0;s<t.length;s++){let o=t[s];const a=n==null?o.key:String(n)+String(o.key!=null?o.key:s);o.type===Sn?(o.patchFlag&128&&i++,r=r.concat(Zv(o.children,e,a))):(e||o.type!==Un)&&r.push(a!=null?ni(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}function sl(t){return Ce(t)?{setup:t,name:t.name}:t}const ac=t=>!!t.type.__asyncLoader,Cu=t=>t.type.__isKeepAlive;function Vk(t,e){e0(t,"a",e)}function $k(t,e){e0(t,"da",e)}function e0(t,e,n=ct){const r=t.__wdc||(t.__wdc=()=>{let i=n;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(ku(e,r,n),n){let i=n.parent;for(;i&&i.parent;)Cu(i.parent.vnode)&&Uk(r,e,n,i),i=i.parent}}function Uk(t,e,n,r){const i=ku(e,t,r,!0);t0(()=>{sp(r[e],i)},n)}function ku(t,e,n=ct,r=!1){if(n){const i=n[t]||(n[t]=[]),s=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;Io(),ro(n);const a=An(e,n,t,o);return Hi(),Ao(),a});return r?i.unshift(s):i.push(s),s}}const kr=t=>(e,n=ct)=>(!Ia||t==="sp")&&ku(t,(...r)=>e(...r),n),zk=kr("bm"),Iu=kr("m"),Hk=kr("bu"),jk=kr("u"),ol=kr("bum"),t0=kr("um"),Kk=kr("sp"),qk=kr("rtg"),Wk=kr("rtc");function Gk(t,e=ct){ku("ec",t,e)}function Mm(t,e){const n=kn;if(n===null)return t;const r=_u(n)||n.proxy,i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[o,a,l,c=Ue]=e[s];Ce(o)&&(o={mounted:o,updated:o}),o.deep&&Fi(a),i.push({dir:o,instance:r,value:a,oldValue:void 0,arg:l,modifiers:c})}return t}function bi(t,e,n,r){const i=t.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(Io(),An(l,n,8,[t.el,a,t,e]),Ao())}}const n0="components";function Vd(t,e){return Xk(n0,t,!0,e)||t}const Jk=Symbol();function Xk(t,e,n=!0,r=!1){const i=kn||ct;if(i){const s=i.type;if(t===n0){const a=MI(s,!1);if(a&&(a===e||a===ur(e)||a===vu(ur(e))))return s}const o=Om(i[t]||s[t],e)||Om(i.appContext[t],e);return!o&&r?s:o}}function Om(t,e){return t&&(t[e]||t[ur(e)]||t[vu(ur(e))])}function Yk(t,e,n,r){let i;const s=n&&n[r];if(de(t)||ot(t)){i=new Array(t.length);for(let o=0,a=t.length;o<a;o++)i[o]=e(t[o],o,void 0,s&&s[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,s&&s[o])}else if(He(t))if(t[Symbol.iterator])i=Array.from(t,(o,a)=>e(o,a,void 0,s&&s[a]));else{const o=Object.keys(t);i=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];i[a]=e(t[c],c,a,s&&s[a])}}else i=[];return n&&(n[r]=i),i}const $d=t=>t?p0(t)?_u(t)||t.proxy:$d(t.parent):null,Ic=Bt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>$d(t.parent),$root:t=>$d(t.root),$emit:t=>t.emit,$options:t=>Ep(t),$forceUpdate:t=>t.f||(t.f=()=>wp(t.update)),$nextTick:t=>t.n||(t.n=jv.bind(t.proxy)),$watch:t=>Pk.bind(t)}),Qk={get({_:t},e){const{ctx:n,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return r[e];case 2:return i[e];case 4:return n[e];case 3:return s[e]}else{if(r!==Ue&&Me(r,e))return o[e]=1,r[e];if(i!==Ue&&Me(i,e))return o[e]=2,i[e];if((c=t.propsOptions[0])&&Me(c,e))return o[e]=3,s[e];if(n!==Ue&&Me(n,e))return o[e]=4,n[e];Ud&&(o[e]=0)}}const u=Ic[e];let h,d;if(u)return e==="$attrs"&&mn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==Ue&&Me(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,Me(d,e))return d[e]},set({_:t},e,n){const{data:r,setupState:i,ctx:s}=t;return i!==Ue&&Me(i,e)?(i[e]=n,!0):r!==Ue&&Me(r,e)?(r[e]=n,!0):Me(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(s[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!n[o]||t!==Ue&&Me(t,o)||e!==Ue&&Me(e,o)||(a=s[0])&&Me(a,o)||Me(r,o)||Me(Ic,o)||Me(i.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:Me(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Ud=!0;function Zk(t){const e=Ep(t),n=t.proxy,r=t.ctx;Ud=!1,e.beforeCreate&&Nm(e.beforeCreate,t,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:g,deactivated:m,beforeDestroy:w,beforeUnmount:_,destroyed:M,unmounted:y,render:L,renderTracked:R,renderTriggered:j,errorCaptured:N,serverPrefetch:G,expose:ie,inheritAttrs:he,components:ve,directives:Ee,filters:Oe}=e;if(c&&eI(c,r,null,t.appContext.config.unwrapInjectedRef),o)for(const T in o){const O=o[T];Ce(O)&&(r[T]=O.bind(n))}if(i){const T=i.call(n,n);He(T)&&(t.data=xu(T))}if(Ud=!0,s)for(const T in s){const O=s[T],q=Ce(O)?O.bind(n,n):Ce(O.get)?O.get.bind(n,n):$n,ne=!Ce(O)&&Ce(O.set)?O.set.bind(n):$n,me=NI({get:q,set:ne});Object.defineProperty(r,T,{enumerable:!0,configurable:!0,get:()=>me.value,set:xe=>me.value=xe})}if(a)for(const T in a)r0(a[T],r,n,T);if(l){const T=Ce(l)?l.call(n):l;Reflect.ownKeys(T).forEach(O=>{Dk(O,T[O])})}u&&Nm(u,t,"c");function v(T,O){de(O)?O.forEach(q=>T(q.bind(n))):O&&T(O.bind(n))}if(v(zk,h),v(Iu,d),v(Hk,f),v(jk,p),v(Vk,g),v($k,m),v(Gk,N),v(Wk,R),v(qk,j),v(ol,_),v(t0,y),v(Kk,G),de(ie))if(ie.length){const T=t.exposed||(t.exposed={});ie.forEach(O=>{Object.defineProperty(T,O,{get:()=>n[O],set:q=>n[O]=q})})}else t.exposed||(t.exposed={});L&&t.render===$n&&(t.render=L),he!=null&&(t.inheritAttrs=he),ve&&(t.components=ve),Ee&&(t.directives=Ee)}function eI(t,e,n=$n,r=!1){de(t)&&(t=zd(t));for(const i in t){const s=t[i];let o;He(s)?"default"in s?o=Dh(s.from||i,s.default,!0):o=Dh(s.from||i):o=Dh(s),Nt(o)&&r?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[i]=o}}function Nm(t,e,n){An(de(t)?t.map(r=>r.bind(e.proxy)):t.bind(e.proxy),e,n)}function r0(t,e,n,r){const i=r.includes(".")?Yv(n,r):()=>n[r];if(ot(t)){const s=e[t];Ce(s)&&Rh(i,s)}else if(Ce(t))Rh(i,t.bind(n));else if(He(t))if(de(t))t.forEach(s=>r0(s,e,n,r));else{const s=Ce(t.handler)?t.handler.bind(n):e[t.handler];Ce(s)&&Rh(i,s,t)}}function Ep(t){const e=t.type,{mixins:n,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=t.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!n&&!r?l=e:(l={},i.length&&i.forEach(c=>Ac(l,c,o,!0)),Ac(l,e,o)),He(e)&&s.set(e,l),l}function Ac(t,e,n,r=!1){const{mixins:i,extends:s}=e;s&&Ac(t,s,n,!0),i&&i.forEach(o=>Ac(t,o,n,!0));for(const o in e)if(!(r&&o==="expose")){const a=tI[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const tI={data:Dm,props:Si,emits:Si,methods:Si,computed:Si,beforeCreate:Ut,created:Ut,beforeMount:Ut,mounted:Ut,beforeUpdate:Ut,updated:Ut,beforeDestroy:Ut,beforeUnmount:Ut,destroyed:Ut,unmounted:Ut,activated:Ut,deactivated:Ut,errorCaptured:Ut,serverPrefetch:Ut,components:Si,directives:Si,watch:rI,provide:Dm,inject:nI};function Dm(t,e){return e?t?function(){return Bt(Ce(t)?t.call(this,this):t,Ce(e)?e.call(this,this):e)}:e:t}function nI(t,e){return Si(zd(t),zd(e))}function zd(t){if(de(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Ut(t,e){return t?[...new Set([].concat(t,e))]:e}function Si(t,e){return t?Bt(Bt(Object.create(null),t),e):e}function rI(t,e){if(!t)return e;if(!e)return t;const n=Bt(Object.create(null),t);for(const r in e)n[r]=Ut(t[r],e[r]);return n}function iI(t,e,n,r=!1){const i={},s={};Tc(s,Au,1),t.propsDefaults=Object.create(null),i0(t,e,i,s);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);n?t.props=r?i:fk(i):t.type.props?t.props=i:t.props=s,t.attrs=s}function sI(t,e,n,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=t,a=Be(i),[l]=t.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(Tu(t.emitsOptions,d))continue;const f=e[d];if(l)if(Me(s,d))f!==s[d]&&(s[d]=f,c=!0);else{const p=ur(d);i[p]=Hd(l,a,p,f,t,!1)}else f!==s[d]&&(s[d]=f,c=!0)}}}else{i0(t,e,i,s)&&(c=!0);let u;for(const h in a)(!e||!Me(e,h)&&((u=ko(h))===h||!Me(e,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(i[h]=Hd(l,a,h,void 0,t,!0)):delete i[h]);if(s!==a)for(const h in s)(!e||!Me(e,h)&&!0)&&(delete s[h],c=!0)}c&&Sr(t,"set","$attrs")}function i0(t,e,n,r){const[i,s]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(sc(l))continue;const c=e[l];let u;i&&Me(i,u=ur(l))?!s||!s.includes(u)?n[u]=c:(a||(a={}))[u]=c:Tu(t.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(s){const l=Be(n),c=a||Ue;for(let u=0;u<s.length;u++){const h=s[u];n[h]=Hd(i,l,h,c[h],t,!Me(c,h))}}return o}function Hd(t,e,n,r,i,s){const o=t[n];if(o!=null){const a=Me(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&Ce(l)){const{propsDefaults:c}=i;n in c?r=c[n]:(ro(i),r=c[n]=l.call(null,e),Hi())}else r=l}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===ko(n))&&(r=!0))}return r}function s0(t,e,n=!1){const r=e.propsCache,i=r.get(t);if(i)return i;const s=t.props,o={},a=[];let l=!1;if(!Ce(t)){const u=h=>{l=!0;const[d,f]=s0(h,e,!0);Bt(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!s&&!l)return He(t)&&r.set(t,qs),qs;if(de(s))for(let u=0;u<s.length;u++){const h=ur(s[u]);Rm(h)&&(o[h]=Ue)}else if(s)for(const u in s){const h=ur(u);if(Rm(h)){const d=s[u],f=o[h]=de(d)||Ce(d)?{type:d}:d;if(f){const p=Bm(Boolean,f.type),g=Bm(String,f.type);f[0]=p>-1,f[1]=g<0||p<g,(p>-1||Me(f,"default"))&&a.push(h)}}}const c=[o,a];return He(t)&&r.set(t,c),c}function Rm(t){return t[0]!=="$"}function Pm(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Lm(t,e){return Pm(t)===Pm(e)}function Bm(t,e){return de(e)?e.findIndex(n=>Lm(n,t)):Ce(e)&&Lm(e,t)?0:-1}const o0=t=>t[0]==="_"||t==="$stable",xp=t=>de(t)?t.map(Yn):[Yn(t)],oI=(t,e,n)=>{if(e._n)return e;const r=Xv((...i)=>xp(e(...i)),n);return r._c=!1,r},a0=(t,e,n)=>{const r=t._ctx;for(const i in t){if(o0(i))continue;const s=t[i];if(Ce(s))e[i]=oI(i,s,r);else if(s!=null){const o=xp(s);e[i]=()=>o}}},l0=(t,e)=>{const n=xp(e);t.slots.default=()=>n},aI=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Be(e),Tc(e,"_",n)):a0(e,t.slots={})}else t.slots={},e&&l0(t,e);Tc(t.slots,Au,1)},lI=(t,e,n)=>{const{vnode:r,slots:i}=t;let s=!0,o=Ue;if(r.shapeFlag&32){const a=e._;a?n&&a===1?s=!1:(Bt(i,e),!n&&a===1&&delete i._):(s=!e.$stable,a0(e,i)),o=e}else e&&(l0(t,e),o={default:1});if(s)for(const a in i)!o0(a)&&!(a in o)&&delete i[a]};function c0(){return{app:null,config:{isNativeTag:DC,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let cI=0;function uI(t,e){return function(r,i=null){Ce(r)||(r=Object.assign({},r)),i!=null&&!He(i)&&(i=null);const s=c0(),o=new Set;let a=!1;const l=s.app={_uid:cI++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:DI,get config(){return s.config},set config(c){},use(c,...u){return o.has(c)||(c&&Ce(c.install)?(o.add(c),c.install(l,...u)):Ce(c)&&(o.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!a){const d=Dt(r,i);return d.appContext=s,u&&e?e(d,c):t(d,c,h),a=!0,l._container=c,c.__vue_app__=l,_u(d.component)||d.component.proxy}},unmount(){a&&(t(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l}};return l}}function jd(t,e,n,r,i=!1){if(de(t)){t.forEach((d,f)=>jd(d,e&&(de(e)?e[f]:e),n,r,i));return}if(ac(r)&&!i)return;const s=r.shapeFlag&4?_u(r.component)||r.component.proxy:r.el,o=i?null:s,{i:a,r:l}=t,c=e&&e.r,u=a.refs===Ue?a.refs={}:a.refs,h=a.setupState;if(c!=null&&c!==l&&(ot(c)?(u[c]=null,Me(h,c)&&(h[c]=null)):Nt(c)&&(c.value=null)),Ce(l))qr(l,a,12,[o,u]);else{const d=ot(l),f=Nt(l);if(d||f){const p=()=>{if(t.f){const g=d?u[l]:l.value;i?de(g)&&sp(g,s):de(g)?g.includes(s)||g.push(s):d?(u[l]=[s],Me(h,l)&&(h[l]=u[l])):(l.value=[s],t.k&&(u[t.k]=l.value))}else d?(u[l]=o,Me(h,l)&&(h[l]=o)):f&&(l.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,Zt(p,n)):p()}}}const Zt=Nk;function hI(t){return dI(t)}function dI(t,e){const n=VC();n.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=$n,insertStaticContent:p}=t,g=(b,E,I,$=null,B=null,S=null,W=!1,D=null,A=!!E.dynamicChildren)=>{if(b===E)return;b&&!Mi(b,E)&&($=mt(b),xe(b,B,S,!0),b=null),E.patchFlag===-2&&(A=!1,E.dynamicChildren=null);const{type:F,ref:Q,shapeFlag:X}=E;switch(F){case Tp:m(b,E,I,$);break;case Un:w(b,E,I,$);break;case lc:b==null&&_(E,I,$,W);break;case Sn:ve(b,E,I,$,B,S,W,D,A);break;default:X&1?L(b,E,I,$,B,S,W,D,A):X&6?Ee(b,E,I,$,B,S,W,D,A):(X&64||X&128)&&F.process(b,E,I,$,B,S,W,D,A,yt)}Q!=null&&B&&jd(Q,b&&b.ref,S,E||b,!E)},m=(b,E,I,$)=>{if(b==null)r(E.el=a(E.children),I,$);else{const B=E.el=b.el;E.children!==b.children&&c(B,E.children)}},w=(b,E,I,$)=>{b==null?r(E.el=l(E.children||""),I,$):E.el=b.el},_=(b,E,I,$)=>{[b.el,b.anchor]=p(b.children,E,I,$,b.el,b.anchor)},M=({el:b,anchor:E},I,$)=>{let B;for(;b&&b!==E;)B=d(b),r(b,I,$),b=B;r(E,I,$)},y=({el:b,anchor:E})=>{let I;for(;b&&b!==E;)I=d(b),i(b),b=I;i(E)},L=(b,E,I,$,B,S,W,D,A)=>{W=W||E.type==="svg",b==null?R(E,I,$,B,S,W,D,A):G(b,E,B,S,W,D,A)},R=(b,E,I,$,B,S,W,D)=>{let A,F;const{type:Q,props:X,shapeFlag:te,transition:x,dirs:C}=b;if(A=b.el=o(b.type,S,X&&X.is,X),te&8?u(A,b.children):te&16&&N(b.children,A,null,$,B,S&&Q!=="foreignObject",W,D),C&&bi(b,null,$,"created"),X){for(const H in X)H!=="value"&&!sc(H)&&s(A,H,null,X[H],S,b.children,$,B,je);"value"in X&&s(A,"value",null,X.value),(F=X.onVnodeBeforeMount)&&Gn(F,$,b)}j(A,b,b.scopeId,W,$),C&&bi(b,null,$,"beforeMount");const V=(!B||B&&!B.pendingBranch)&&x&&!x.persisted;V&&x.beforeEnter(A),r(A,E,I),((F=X&&X.onVnodeMounted)||V||C)&&Zt(()=>{F&&Gn(F,$,b),V&&x.enter(A),C&&bi(b,null,$,"mounted")},B)},j=(b,E,I,$,B)=>{if(I&&f(b,I),$)for(let S=0;S<$.length;S++)f(b,$[S]);if(B){let S=B.subTree;if(E===S){const W=B.vnode;j(b,W,W.scopeId,W.slotScopeIds,B.parent)}}},N=(b,E,I,$,B,S,W,D,A=0)=>{for(let F=A;F<b.length;F++){const Q=b[F]=D?Dr(b[F]):Yn(b[F]);g(null,Q,E,I,$,B,S,W,D)}},G=(b,E,I,$,B,S,W)=>{const D=E.el=b.el;let{patchFlag:A,dynamicChildren:F,dirs:Q}=E;A|=b.patchFlag&16;const X=b.props||Ue,te=E.props||Ue;let x;I&&wi(I,!1),(x=te.onVnodeBeforeUpdate)&&Gn(x,I,E,b),Q&&bi(E,b,I,"beforeUpdate"),I&&wi(I,!0);const C=B&&E.type!=="foreignObject";if(F?ie(b.dynamicChildren,F,D,I,$,C,S):W||O(b,E,D,null,I,$,C,S,!1),A>0){if(A&16)he(D,E,X,te,I,$,B);else if(A&2&&X.class!==te.class&&s(D,"class",null,te.class,B),A&4&&s(D,"style",X.style,te.style,B),A&8){const V=E.dynamicProps;for(let H=0;H<V.length;H++){const ce=V[H],Ne=X[ce],wn=te[ce];(wn!==Ne||ce==="value")&&s(D,ce,Ne,wn,B,b.children,I,$,je)}}A&1&&b.children!==E.children&&u(D,E.children)}else!W&&F==null&&he(D,E,X,te,I,$,B);((x=te.onVnodeUpdated)||Q)&&Zt(()=>{x&&Gn(x,I,E,b),Q&&bi(E,b,I,"updated")},$)},ie=(b,E,I,$,B,S,W)=>{for(let D=0;D<E.length;D++){const A=b[D],F=E[D],Q=A.el&&(A.type===Sn||!Mi(A,F)||A.shapeFlag&70)?h(A.el):I;g(A,F,Q,null,$,B,S,W,!0)}},he=(b,E,I,$,B,S,W)=>{if(I!==$){if(I!==Ue)for(const D in I)!sc(D)&&!(D in $)&&s(b,D,I[D],null,W,E.children,B,S,je);for(const D in $){if(sc(D))continue;const A=$[D],F=I[D];A!==F&&D!=="value"&&s(b,D,F,A,W,E.children,B,S,je)}"value"in $&&s(b,"value",I.value,$.value)}},ve=(b,E,I,$,B,S,W,D,A)=>{const F=E.el=b?b.el:a(""),Q=E.anchor=b?b.anchor:a("");let{patchFlag:X,dynamicChildren:te,slotScopeIds:x}=E;x&&(D=D?D.concat(x):x),b==null?(r(F,I,$),r(Q,I,$),N(E.children,I,Q,B,S,W,D,A)):X>0&&X&64&&te&&b.dynamicChildren?(ie(b.dynamicChildren,te,I,B,S,W,D),(E.key!=null||B&&E===B.subTree)&&Sp(b,E,!0)):O(b,E,I,Q,B,S,W,D,A)},Ee=(b,E,I,$,B,S,W,D,A)=>{E.slotScopeIds=D,b==null?E.shapeFlag&512?B.ctx.activate(E,I,$,W,A):Oe(E,I,$,B,S,W,A):ze(b,E,A)},Oe=(b,E,I,$,B,S,W)=>{const D=b.component=CI(b,$,B);if(Cu(b)&&(D.ctx.renderer=yt),kI(D),D.asyncDep){if(B&&B.registerDep(D,v),!b.el){const A=D.subTree=Dt(Un);w(null,A,E,I)}return}v(D,b,E,I,B,S,W)},ze=(b,E,I)=>{const $=E.component=b.component;if(_k(b,E,I))if($.asyncDep&&!$.asyncResolved){T($,E,I);return}else $.next=E,Sk($.update),$.update();else E.el=b.el,$.vnode=E},v=(b,E,I,$,B,S,W)=>{const D=()=>{if(b.isMounted){let{next:Q,bu:X,u:te,parent:x,vnode:C}=b,V=Q,H;wi(b,!1),Q?(Q.el=C.el,T(b,Q,W)):Q=C,X&&oc(X),(H=Q.props&&Q.props.onVnodeBeforeUpdate)&&Gn(H,x,Q,C),wi(b,!0);const ce=Nh(b),Ne=b.subTree;b.subTree=ce,g(Ne,ce,h(Ne.el),mt(Ne),b,B,S),Q.el=ce.el,V===null&&Mk(b,ce.el),te&&Zt(te,B),(H=Q.props&&Q.props.onVnodeUpdated)&&Zt(()=>Gn(H,x,Q,C),B)}else{let Q;const{el:X,props:te}=E,{bm:x,m:C,parent:V}=b,H=ac(E);if(wi(b,!1),x&&oc(x),!H&&(Q=te&&te.onVnodeBeforeMount)&&Gn(Q,V,E),wi(b,!0),X&&Yt){const ce=()=>{b.subTree=Nh(b),Yt(X,b.subTree,b,B,null)};H?E.type.__asyncLoader().then(()=>!b.isUnmounted&&ce()):ce()}else{const ce=b.subTree=Nh(b);g(null,ce,I,$,b,B,S),E.el=ce.el}if(C&&Zt(C,B),!H&&(Q=te&&te.onVnodeMounted)){const ce=E;Zt(()=>Gn(Q,V,ce),B)}(E.shapeFlag&256||V&&ac(V.vnode)&&V.vnode.shapeFlag&256)&&b.a&&Zt(b.a,B),b.isMounted=!0,E=I=$=null}},A=b.effect=new lp(D,()=>wp(F),b.scope),F=b.update=()=>A.run();F.id=b.uid,wi(b,!0),F()},T=(b,E,I)=>{E.component=b;const $=b.vnode.props;b.vnode=E,b.next=null,sI(b,E.props,$,I),lI(b,E.children,I),Io(),km(),Ao()},O=(b,E,I,$,B,S,W,D,A=!1)=>{const F=b&&b.children,Q=b?b.shapeFlag:0,X=E.children,{patchFlag:te,shapeFlag:x}=E;if(te>0){if(te&128){ne(F,X,I,$,B,S,W,D,A);return}else if(te&256){q(F,X,I,$,B,S,W,D,A);return}}x&8?(Q&16&&je(F,B,S),X!==F&&u(I,X)):Q&16?x&16?ne(F,X,I,$,B,S,W,D,A):je(F,B,S,!0):(Q&8&&u(I,""),x&16&&N(X,I,$,B,S,W,D,A))},q=(b,E,I,$,B,S,W,D,A)=>{b=b||qs,E=E||qs;const F=b.length,Q=E.length,X=Math.min(F,Q);let te;for(te=0;te<X;te++){const x=E[te]=A?Dr(E[te]):Yn(E[te]);g(b[te],x,I,null,B,S,W,D,A)}F>Q?je(b,B,S,!0,!1,X):N(E,I,$,B,S,W,D,A,X)},ne=(b,E,I,$,B,S,W,D,A)=>{let F=0;const Q=E.length;let X=b.length-1,te=Q-1;for(;F<=X&&F<=te;){const x=b[F],C=E[F]=A?Dr(E[F]):Yn(E[F]);if(Mi(x,C))g(x,C,I,null,B,S,W,D,A);else break;F++}for(;F<=X&&F<=te;){const x=b[X],C=E[te]=A?Dr(E[te]):Yn(E[te]);if(Mi(x,C))g(x,C,I,null,B,S,W,D,A);else break;X--,te--}if(F>X){if(F<=te){const x=te+1,C=x<Q?E[x].el:$;for(;F<=te;)g(null,E[F]=A?Dr(E[F]):Yn(E[F]),I,C,B,S,W,D,A),F++}}else if(F>te)for(;F<=X;)xe(b[F],B,S,!0),F++;else{const x=F,C=F,V=new Map;for(F=C;F<=te;F++){const Z=E[F]=A?Dr(E[F]):Yn(E[F]);Z.key!=null&&V.set(Z.key,F)}let H,ce=0;const Ne=te-C+1;let wn=!1,Ar=0;const mi=new Array(Ne);for(F=0;F<Ne;F++)mi[F]=0;for(F=x;F<=X;F++){const Z=b[F];if(ce>=Ne){xe(Z,B,S,!0);continue}let le;if(Z.key!=null)le=V.get(Z.key);else for(H=C;H<=te;H++)if(mi[H-C]===0&&Mi(Z,E[H])){le=H;break}le===void 0?xe(Z,B,S,!0):(mi[le-C]=F+1,le>=Ar?Ar=le:wn=!0,g(Z,E[le],I,null,B,S,W,D,A),ce++)}const P=wn?fI(mi):qs;for(H=P.length-1,F=Ne-1;F>=0;F--){const Z=C+F,le=E[Z],Re=Z+1<Q?E[Z+1].el:$;mi[F]===0?g(null,le,I,Re,B,S,W,D,A):wn&&(H<0||F!==P[H]?me(le,I,Re,2):H--)}}},me=(b,E,I,$,B=null)=>{const{el:S,type:W,transition:D,children:A,shapeFlag:F}=b;if(F&6){me(b.component.subTree,E,I,$);return}if(F&128){b.suspense.move(E,I,$);return}if(F&64){W.move(b,E,I,yt);return}if(W===Sn){r(S,E,I);for(let X=0;X<A.length;X++)me(A[X],E,I,$);r(b.anchor,E,I);return}if(W===lc){M(b,E,I);return}if($!==2&&F&1&&D)if($===0)D.beforeEnter(S),r(S,E,I),Zt(()=>D.enter(S),B);else{const{leave:X,delayLeave:te,afterLeave:x}=D,C=()=>r(S,E,I),V=()=>{X(S,()=>{C(),x&&x()})};te?te(S,C,V):V()}else r(S,E,I)},xe=(b,E,I,$=!1,B=!1)=>{const{type:S,props:W,ref:D,children:A,dynamicChildren:F,shapeFlag:Q,patchFlag:X,dirs:te}=b;if(D!=null&&jd(D,null,I,b,!0),Q&256){E.ctx.deactivate(b);return}const x=Q&1&&te,C=!ac(b);let V;if(C&&(V=W&&W.onVnodeBeforeUnmount)&&Gn(V,E,b),Q&6)Pe(b.component,I,$);else{if(Q&128){b.suspense.unmount(I,$);return}x&&bi(b,null,E,"beforeUnmount"),Q&64?b.type.remove(b,E,I,B,yt,$):F&&(S!==Sn||X>0&&X&64)?je(F,E,I,!1,!0):(S===Sn&&X&384||!B&&Q&16)&&je(A,E,I),$&&Qe(b)}(C&&(V=W&&W.onVnodeUnmounted)||x)&&Zt(()=>{V&&Gn(V,E,b),x&&bi(b,null,E,"unmounted")},I)},Qe=b=>{const{type:E,el:I,anchor:$,transition:B}=b;if(E===Sn){ke(I,$);return}if(E===lc){y(b);return}const S=()=>{i(I),B&&!B.persisted&&B.afterLeave&&B.afterLeave()};if(b.shapeFlag&1&&B&&!B.persisted){const{leave:W,delayLeave:D}=B,A=()=>W(I,S);D?D(b.el,S,A):A()}else S()},ke=(b,E)=>{let I;for(;b!==E;)I=d(b),i(b),b=I;i(E)},Pe=(b,E,I)=>{const{bum:$,scope:B,update:S,subTree:W,um:D}=b;$&&oc($),B.stop(),S&&(S.active=!1,xe(W,b,E,I)),D&&Zt(D,E),Zt(()=>{b.isUnmounted=!0},E),E&&E.pendingBranch&&!E.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===E.pendingId&&(E.deps--,E.deps===0&&E.resolve())},je=(b,E,I,$=!1,B=!1,S=0)=>{for(let W=S;W<b.length;W++)xe(b[W],E,I,$,B)},mt=b=>b.shapeFlag&6?mt(b.component.subTree):b.shapeFlag&128?b.suspense.next():d(b.anchor||b.el),kt=(b,E,I)=>{b==null?E._vnode&&xe(E._vnode,null,null,!0):g(E._vnode||null,b,E,null,null,null,I),km(),qv(),E._vnode=b},yt={p:g,um:xe,m:me,r:Qe,mt:Oe,mc:N,pc:O,pbc:ie,n:mt,o:t};let It,Yt;return e&&([It,Yt]=e(yt)),{render:kt,hydrate:It,createApp:uI(kt,It)}}function wi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function Sp(t,e,n=!1){const r=t.children,i=e.children;if(de(r)&&de(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=Dr(i[s]),a.el=o.el),n||Sp(o,a))}}function fI(t){const e=t.slice(),n=[0];let r,i,s,o,a;const l=t.length;for(r=0;r<l;r++){const c=t[r];if(c!==0){if(i=n[n.length-1],t[i]<c){e[r]=i,n.push(r);continue}for(s=0,o=n.length-1;s<o;)a=s+o>>1,t[n[a]]<c?s=a+1:o=a;c<t[n[s]]&&(s>0&&(e[r]=n[s-1]),n[s]=r)}}for(s=n.length,o=n[s-1];s-- >0;)n[s]=o,o=e[o];return n}const pI=t=>t.__isTeleport,ia=t=>t&&(t.disabled||t.disabled===""),Fm=t=>typeof SVGElement<"u"&&t instanceof SVGElement,Kd=(t,e)=>{const n=t&&t.to;return ot(n)?e?e(n):null:n},gI={__isTeleport:!0,process(t,e,n,r,i,s,o,a,l,c){const{mc:u,pc:h,pbc:d,o:{insert:f,querySelector:p,createText:g,createComment:m}}=c,w=ia(e.props);let{shapeFlag:_,children:M,dynamicChildren:y}=e;if(t==null){const L=e.el=g(""),R=e.anchor=g("");f(L,n,r),f(R,n,r);const j=e.target=Kd(e.props,p),N=e.targetAnchor=g("");j&&(f(N,j),o=o||Fm(j));const G=(ie,he)=>{_&16&&u(M,ie,he,i,s,o,a,l)};w?G(n,R):j&&G(j,N)}else{e.el=t.el;const L=e.anchor=t.anchor,R=e.target=t.target,j=e.targetAnchor=t.targetAnchor,N=ia(t.props),G=N?n:R,ie=N?L:j;if(o=o||Fm(R),y?(d(t.dynamicChildren,y,G,i,s,o,a),Sp(t,e,!0)):l||h(t,e,G,ie,i,s,o,a,!1),w)N||Rl(e,n,L,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const he=e.target=Kd(e.props,p);he&&Rl(e,he,null,c,0)}else N&&Rl(e,R,j,c,1)}},remove(t,e,n,r,{um:i,o:{remove:s}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:h,props:d}=t;if(h&&s(u),(o||!ia(d))&&(s(c),a&16))for(let f=0;f<l.length;f++){const p=l[f];i(p,e,n,!0,!!p.dynamicChildren)}},move:Rl,hydrate:mI};function Rl(t,e,n,{o:{insert:r},m:i},s=2){s===0&&r(t.targetAnchor,e,n);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=t,h=s===2;if(h&&r(o,e,n),(!h||ia(u))&&l&16)for(let d=0;d<c.length;d++)i(c[d],e,n,2);h&&r(a,e,n)}function mI(t,e,n,r,i,s,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=Kd(e.props,l);if(u){const h=u._lpa||u.firstChild;if(e.shapeFlag&16)if(ia(e.props))e.anchor=c(o(t),e,a(t),n,r,i,s),e.targetAnchor=h;else{e.anchor=o(t);let d=h;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(h,e,u,n,r,i,s)}}return e.anchor&&o(e.anchor)}const yI=gI,Sn=Symbol(void 0),Tp=Symbol(void 0),Un=Symbol(void 0),lc=Symbol(void 0),sa=[];let Bn=null;function cn(t=!1){sa.push(Bn=t?null:[])}function bI(){sa.pop(),Bn=sa[sa.length-1]||null}let ka=1;function Vm(t){ka+=t}function u0(t){return t.dynamicChildren=ka>0?Bn||qs:null,bI(),ka>0&&Bn&&Bn.push(t),t}function Rn(t,e,n,r,i,s){return u0(Y(t,e,n,r,i,s,!0))}function h0(t,e,n,r,i){return u0(Dt(t,e,n,r,i,!0))}function qd(t){return t?t.__v_isVNode===!0:!1}function Mi(t,e){return t.type===e.type&&t.key===e.key}const Au="__vInternal",d0=({key:t})=>t!=null?t:null,cc=({ref:t,ref_key:e,ref_for:n})=>t!=null?ot(t)||Nt(t)||Ce(t)?{i:kn,r:t,k:e,f:!!n}:t:null;function Y(t,e=null,n=null,r=0,i=null,s=t===Sn?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&d0(e),ref:e&&cc(e),scopeId:Jv,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null};return a?(Cp(l,n),s&128&&t.normalize(l)):n&&(l.shapeFlag|=ot(n)?8:16),ka>0&&!o&&Bn&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Bn.push(l),l}const Dt=wI;function wI(t,e=null,n=null,r=0,i=null,s=!1){if((!t||t===Jk)&&(t=Un),qd(t)){const a=ni(t,e,!0);return n&&Cp(a,n),ka>0&&!s&&Bn&&(a.shapeFlag&6?Bn[Bn.indexOf(t)]=a:Bn.push(a)),a.patchFlag|=-2,a}if(OI(t)&&(t=t.__vccOpts),e){e=vI(e);let{class:a,style:l}=e;a&&!ot(a)&&(e.class=Qt(a)),He(l)&&(Vv(l)&&!de(l)&&(l=Bt({},l)),e.style=rp(l))}const o=ot(t)?1:Ok(t)?128:pI(t)?64:He(t)?4:Ce(t)?2:0;return Y(t,e,n,r,i,o,s,!0)}function vI(t){return t?Vv(t)||Au in t?Bt({},t):t:null}function ni(t,e,n=!1){const{props:r,ref:i,patchFlag:s,children:o}=t,a=e?xI(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&d0(a),ref:e&&e.ref?n&&i?de(i)?i.concat(cc(e)):[i,cc(e)]:cc(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Sn?s===-1?16:s|16:s,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&ni(t.ssContent),ssFallback:t.ssFallback&&ni(t.ssFallback),el:t.el,anchor:t.anchor}}function Ti(t=" ",e=0){return Dt(Tp,null,t,e)}function EI(t,e){const n=Dt(lc,null,t);return n.staticCount=e,n}function Pl(t="",e=!1){return e?(cn(),h0(Un,null,t)):Dt(Un,null,t)}function Yn(t){return t==null||typeof t=="boolean"?Dt(Un):de(t)?Dt(Sn,null,t.slice()):typeof t=="object"?Dr(t):Dt(Tp,null,String(t))}function Dr(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:ni(t)}function Cp(t,e){let n=0;const{shapeFlag:r}=t;if(e==null)e=null;else if(de(e))n=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),Cp(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!(Au in e)?e._ctx=kn:i===3&&kn&&(kn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Ce(e)?(e={default:e,_ctx:kn},n=32):(e=String(e),r&64?(n=16,e=[Ti(e)]):n=8);t.children=e,t.shapeFlag|=n}function xI(...t){const e={};for(let n=0;n<t.length;n++){const r=t[n];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=Qt([e.class,r.class]));else if(i==="style")e.style=rp([e.style,r.style]);else if(yu(i)){const s=e[i],o=r[i];o&&s!==o&&!(de(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function Gn(t,e,n,r=null){An(t,e,7,[n,r])}const SI=c0();let TI=0;function CI(t,e,n){const r=t.type,i=(e?e.appContext:t.appContext)||SI,s={uid:TI++,vnode:t,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new $C(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:s0(r,i),emitsOptions:Gv(r,i),emit:null,emitted:null,propsDefaults:Ue,inheritAttrs:r.inheritAttrs,ctx:Ue,data:Ue,props:Ue,attrs:Ue,slots:Ue,refs:Ue,setupState:Ue,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=kk.bind(null,s),t.ce&&t.ce(s),s}let ct=null;const f0=()=>ct||kn,ro=t=>{ct=t,t.scope.on()},Hi=()=>{ct&&ct.scope.off(),ct=null};function p0(t){return t.vnode.shapeFlag&4}let Ia=!1;function kI(t,e=!1){Ia=e;const{props:n,children:r}=t.vnode,i=p0(t);iI(t,n,i,e),aI(t,r);const s=i?II(t,e):void 0;return Ia=!1,s}function II(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=fp(new Proxy(t.ctx,Qk));const{setup:r}=n;if(r){const i=t.setupContext=r.length>1?_I(t):null;ro(t),Io();const s=qr(r,t,0,[t.props,i]);if(Ao(),Hi(),Cv(s)){if(s.then(Hi,Hi),e)return s.then(o=>{$m(t,o,e)}).catch(o=>{Su(o,t,0)});t.asyncDep=s}else $m(t,s,e)}else g0(t,e)}function $m(t,e,n){Ce(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:He(e)&&(t.setupState=Uv(e)),g0(t,n)}let Um;function g0(t,e,n){const r=t.type;if(!t.render){if(!e&&Um&&!r.render){const i=r.template||Ep(t).template;if(i){const{isCustomElement:s,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:l}=r,c=Bt(Bt({isCustomElement:s,delimiters:a},o),l);r.render=Um(i,c)}}t.render=r.render||$n}ro(t),Io(),Zk(t),Ao(),Hi()}function AI(t){return new Proxy(t.attrs,{get(e,n){return mn(t,"get","$attrs"),e[n]}})}function _I(t){const e=r=>{t.exposed=r||{}};let n;return{get attrs(){return n||(n=AI(t))},slots:t.slots,emit:t.emit,expose:e}}function _u(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Uv(fp(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ic)return Ic[n](t)}}))}function MI(t,e=!0){return Ce(t)?t.displayName||t.name:t.name||e&&t.__name}function OI(t){return Ce(t)&&"__vccOpts"in t}const NI=(t,e)=>vk(t,e,Ia);function ji(t,e,n){const r=arguments.length;return r===2?He(e)&&!de(e)?qd(e)?Dt(t,null,[e]):Dt(t,e):Dt(t,null,e):(r>3?n=Array.prototype.slice.call(arguments,2):r===3&&qd(n)&&(n=[n]),Dt(t,e,n))}const DI="3.2.40",RI="http://www.w3.org/2000/svg",Oi=typeof document<"u"?document:null,zm=Oi&&Oi.createElement("template"),PI={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,r)=>{const i=e?Oi.createElementNS(RI,t):Oi.createElement(t,n?{is:n}:void 0);return t==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:t=>Oi.createTextNode(t),createComment:t=>Oi.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Oi.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,r,i,s){const o=n?n.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),n),!(i===s||!(i=i.nextSibling)););else{zm.innerHTML=r?`<svg>${t}</svg>`:t;const a=zm.content;if(r){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function LI(t,e,n){const r=t._vtc;r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function BI(t,e,n){const r=t.style,i=ot(n);if(n&&!i){for(const s in n)Wd(r,s,n[s]);if(e&&!ot(e))for(const s in e)n[s]==null&&Wd(r,s,"")}else{const s=r.display;i?e!==n&&(r.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(r.display=s)}}const Hm=/\s*!important$/;function Wd(t,e,n){if(de(n))n.forEach(r=>Wd(t,e,r));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const r=FI(t,e);Hm.test(n)?t.setProperty(ko(r),n.replace(Hm,""),"important"):t[r]=n}}const jm=["Webkit","Moz","ms"],Lh={};function FI(t,e){const n=Lh[e];if(n)return n;let r=ur(e);if(r!=="filter"&&r in t)return Lh[e]=r;r=vu(r);for(let i=0;i<jm.length;i++){const s=jm[i]+r;if(s in t)return Lh[e]=s}return e}const Km="http://www.w3.org/1999/xlink";function VI(t,e,n,r,i){if(r&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Km,e.slice(6,e.length)):t.setAttributeNS(Km,e,n);else{const s=AC(e);n==null||s&&!xv(n)?t.removeAttribute(e):t.setAttribute(e,s?"":n)}}function $I(t,e,n,r,i,s,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,i,s),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const l=n==null?"":n;(t.value!==l||t.tagName==="OPTION")&&(t.value=l),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const l=typeof t[e];l==="boolean"?n=xv(n):n==null&&l==="string"?(n="",a=!0):l==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[m0,UI]=(()=>{let t=Date.now,e=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let Gd=0;const zI=Promise.resolve(),HI=()=>{Gd=0},jI=()=>Gd||(zI.then(HI),Gd=m0());function Ni(t,e,n,r){t.addEventListener(e,n,r)}function KI(t,e,n,r){t.removeEventListener(e,n,r)}function qI(t,e,n,r,i=null){const s=t._vei||(t._vei={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=WI(e);if(r){const c=s[e]=GI(r,i);Ni(t,a,c,l)}else o&&(KI(t,a,o,l),s[e]=void 0)}}const qm=/(?:Once|Passive|Capture)$/;function WI(t){let e;if(qm.test(t)){e={};let r;for(;r=t.match(qm);)t=t.slice(0,t.length-r[0].length),e[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ko(t.slice(2)),e]}function GI(t,e){const n=r=>{const i=r.timeStamp||m0();(UI||i>=n.attached-1)&&An(JI(r,n.value),e,5,[r])};return n.value=t,n.attached=jI(),n}function JI(t,e){if(de(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const Wm=/^on[a-z]/,XI=(t,e,n,r,i=!1,s,o,a,l)=>{e==="class"?LI(t,r,i):e==="style"?BI(t,n,r):yu(e)?ip(e)||qI(t,e,n,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):YI(t,e,r,i))?$I(t,e,r,s,o,a,l):(e==="true-value"?t._trueValue=r:e==="false-value"&&(t._falseValue=r),VI(t,e,r,i))};function YI(t,e,n,r){return r?!!(e==="innerHTML"||e==="textContent"||e in t&&Wm.test(e)&&Ce(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||Wm.test(e)&&ot(n)?!1:e in t}const QI={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Fk.props;const _c=t=>{const e=t.props["onUpdate:modelValue"]||!1;return de(e)?n=>oc(e,n):e};function ZI(t){t.target.composing=!0}function Gm(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const eA={created(t,{modifiers:{lazy:e,trim:n,number:r}},i){t._assign=_c(i);const s=r||i.props&&i.props.type==="number";Ni(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),s&&(a=Od(a)),t._assign(a)}),n&&Ni(t,"change",()=>{t.value=t.value.trim()}),e||(Ni(t,"compositionstart",ZI),Ni(t,"compositionend",Gm),Ni(t,"change",Gm))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:r,number:i}},s){if(t._assign=_c(s),t.composing||document.activeElement===t&&t.type!=="range"&&(n||r&&t.value.trim()===e||(i||t.type==="number")&&Od(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},tA={deep:!0,created(t,e,n){t._assign=_c(n),Ni(t,"change",()=>{const r=t._modelValue,i=nA(t),s=t.checked,o=t._assign;if(de(r)){const a=Sv(r,i),l=a!==-1;if(s&&!l)o(r.concat(i));else if(!s&&l){const c=[...r];c.splice(a,1),o(c)}}else if(bu(r)){const a=new Set(r);s?a.add(i):a.delete(i),o(a)}else o(y0(t,s))})},mounted:Jm,beforeUpdate(t,e,n){t._assign=_c(n),Jm(t,e,n)}};function Jm(t,{value:e,oldValue:n},r){t._modelValue=e,de(e)?t.checked=Sv(e,r.props.value)>-1:bu(e)?t.checked=e.has(r.props.value):e!==n&&(t.checked=mu(e,y0(t,!0)))}function nA(t){return"_value"in t?t._value:t.value}function y0(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const rA=["ctrl","shift","alt","meta"],iA={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>rA.some(n=>t[`${n}Key`]&&!e.includes(n))},sA=(t,e)=>(n,...r)=>{for(let i=0;i<e.length;i++){const s=iA[e[i]];if(s&&s(n,e))return}return t(n,...r)},oA=Bt({patchProp:XI},PI);let Xm;function aA(){return Xm||(Xm=hI(oA))}const lA=(...t)=>{const e=aA().createApp(...t),{mount:n}=e;return e.mount=r=>{const i=cA(r);if(!i)return;const s=e._component;!Ce(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.innerHTML="";const o=n(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function cA(t){return ot(t)?document.querySelector(t):t}function bt(t){this.content=t}bt.prototype={constructor:bt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return i==-1?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new bt(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new bt(n)},addToStart:function(t,e){return new bt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new bt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(s==-1?i.length:s,0,e,n),new bt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=bt.from(t),t.size?new bt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=bt.from(t),t.size?new bt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=bt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};bt.from=function(t){if(t instanceof bt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new bt(e)};function b0(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i==s){n+=i.nodeSize;continue}if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)n++;return n}if(i.content.size||s.content.size){let o=b0(i.content,s.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function w0(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:n,b:r};let o=t.child(--i),a=e.child(--s),l=o.nodeSize;if(o==a){n-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:n,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,n--,r--;return{a:n,b:r}}if(o.content.size||a.content.size){let c=w0(o.content,a.content,n-1,r-1);if(c)return c}n-=l,r-=l}}class z{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let o=0,a=0;a<n;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,i+a,s||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,n-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",o=!0;return this.nodesBetween(e,n,(a,l)=>{a.isText?(s+=a.text.slice(Math.max(e,l)-l,n-l),o=!r):a.isLeaf?(i?s+=typeof i=="function"?i(a):i:a.type.spec.leafText&&(s+=a.type.spec.leafText(a)),o=!r):!o&&a.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new z(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,o=0;o<n;s++){let a=this.content[s],l=o+a.nodeSize;l>e&&((o<e||l>n)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,n-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,n-o-1))),r.push(a),i+=a.nodeSize),o=l}return new z(r,i)}cutByIndex(e,n){return e==n?z.empty:e==0&&n==this.content.length?this:new z(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new z(i,s)}addToStart(e){return new z([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new z(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return b0(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return w0(this,e,n,r)}findIndex(e,n=-1){if(e==0)return Ll(0,e);if(e==this.size)return Ll(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||n>0?Ll(r+1,o):Ll(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return z.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new z(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return z.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new z(n||e,r)}static from(e){if(!e)return z.empty;if(e instanceof z)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new z([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}z.empty=new z([],0);const Bh={index:0,offset:0};function Ll(t,e){return Bh.index=t,Bh.offset=e,Bh}function Mc(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Mc(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Mc(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}class Fe{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Mc(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);return r.create(n.attrs)}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Fe.none;if(e instanceof Fe)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}}Fe.none=[];class Aa extends Error{}class J{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=E0(this.content,e+this.openStart,n);return r&&new J(r,this.openStart,this.openEnd)}removeBetween(e,n){return new J(v0(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return J.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new J(z.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new J(e,r,i)}}J.empty=new J(z.empty,0,0);function v0(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:o,offset:a}=t.findIndex(n);if(i==e||s.isText){if(a!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(v0(s.content,e-i-1,n-i-1)))}function E0(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let a=E0(o.content,e-s-1,n);return a&&t.replaceChild(i,o.copy(a))}function uA(t,e,n){if(n.openStart>t.depth)throw new Aa("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Aa("Inconsistent open depths");return x0(t,e,n,0)}function x0(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=x0(t,e,n,r+1);return s.copy(s.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,a=o.content;return qi(o,a.cut(0,t.parentOffset).append(n.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=hA(n,t);return qi(s,T0(t,o,a,e,r))}else return qi(s,Oc(t,e,r))}function S0(t,e){if(!e.type.compatibleContent(t.type))throw new Aa("Cannot join "+e.type.name+" onto "+t.type.name)}function Jd(t,e,n){let r=t.node(n);return S0(r,e.node(n)),r}function Ki(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function oa(t,e,n,r){let i=(e||t).node(n),s=0,o=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(Ki(t.nodeAfter,r),s++));for(let a=s;a<o;a++)Ki(i.child(a),r);e&&e.depth==n&&e.textOffset&&Ki(e.nodeBefore,r)}function qi(t,e){if(!t.type.validContent(e))throw new Aa("Invalid content for node "+t.type.name);return t.copy(e)}function T0(t,e,n,r,i){let s=t.depth>i&&Jd(t,e,i+1),o=r.depth>i&&Jd(n,r,i+1),a=[];return oa(null,t,i,a),s&&o&&e.index(i)==n.index(i)?(S0(s,o),Ki(qi(s,T0(t,e,n,r,i+1)),a)):(s&&Ki(qi(s,Oc(t,e,i+1)),a),oa(e,n,i,a),o&&Ki(qi(o,Oc(n,r,i+1)),a)),oa(r,null,i,a),new z(a)}function Oc(t,e,n){let r=[];if(oa(null,t,n,r),t.depth>n){let i=Jd(t,e,n+1);Ki(qi(i,Oc(t,e,n+1)),r)}return oa(e,null,n,r),new z(r)}function hA(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(z.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class _a{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Fe.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let a=r;r=i,i=a}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new Nc(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(s),c=s-l;if(r.push(o,a,i+l),!c||(o=o.child(a),o.isText))break;s=c-1,i+=l+1}return new _a(n,r,s)}static resolveCached(e,n){for(let i=0;i<Fh.length;i++){let s=Fh[i];if(s.pos==n&&s.doc==e)return s}let r=Fh[Vh]=_a.resolve(e,n);return Vh=(Vh+1)%dA,r}}let Fh=[],Vh=0,dA=12;class Nc{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const fA=Object.create(null);class lr{constructor(e,n,r,i=Fe.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||z.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Mc(this.attrs,n||e.defaultAttrs||fA)&&Fe.sameSet(this.marks,r||Fe.none)}copy(e=null){return e==this.content?this:new lr(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new lr(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return J.empty;let i=this.resolve(e),s=this.resolve(n),o=r?0:i.sharedDepth(n),a=i.start(o),c=i.node(o).content.cut(i.pos-a,s.pos-a);return new J(c,i.depth-o,s.depth-o)}replace(e,n,r){return uA(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return _a.resolveCached(this,e)}resolveNoCache(e){return _a.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),C0(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=z.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),a=o&&o.matchFragment(this.content,n);if(!a||!a.validEnd)return!1;for(let l=i;l<s;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let e=Fe.none;for(let n=0;n<this.marks.length;n++)e=this.marks[n].addToSet(e);if(!Fe.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=z.fromJSON(e,n.content);return e.nodeType(n.type).create(n.attrs,i,r)}}lr.prototype.text=void 0;class Dc extends lr{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):C0(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Dc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Dc(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function C0(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class ts{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new pA(e,n);if(r.next==null)return ts.empty;let i=k0(r);r.next&&r.err("Unexpected trailing text");let s=EA(vA(i));return xA(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function s(o,a){let l=o.matchFragment(e,r);if(l&&(!n||l.validEnd))return z.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:h}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(h)==-1){i.push(h);let d=s(h,a.concat(u));if(d)return d}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let a=i;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:a,next:l}=s.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in n)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),n[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}ts.empty=new ts(!0);class pA{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function k0(t){let e=[];do e.push(gA(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function gA(t){let e=[];do e.push(mA(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function mA(t){let e=wA(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=yA(t,e);else break;return e}function Ym(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function yA(t,e){let n=Ym(t),r=n;return t.eat(",")&&(t.next!="}"?r=Ym(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function bA(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let o=n[s];o.groups.indexOf(e)>-1&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function wA(t){if(t.eat("(")){let e=k0(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=bA(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function vA(t){let e=[[]];return i(s(t,0),n()),e;function n(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function i(o,a){o.forEach(l=>l.to=a)}function s(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(s(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=s(o.exprs[l],a);if(l==o.exprs.length-1)return c;i(c,a=n())}else if(o.type=="star"){let l=n();return r(a,l),i(s(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=n();return i(s(o.expr,a),l),i(s(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(s(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=n();i(s(o.expr,l),u),l=u}if(o.max==-1)i(s(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=n();r(l,u),i(s(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function I0(t,e){return e-t}function Qm(t,e){let n=[];return r(e),n.sort(I0);function r(i){let s=t[i];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(i);for(let o=0;o<s.length;o++){let{term:a,to:l}=s[o];!a&&n.indexOf(l)==-1&&r(l)}}}function EA(t){let e=Object.create(null);return n(Qm(t,0));function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Qm(t,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new ts(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let a=i[o][1].sort(I0);s.next.push({type:i[o][0],next:e[a.join(",")]||n(a)})}return s}}function xA(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,o=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];o.push(l.name),s&&!(l.isText||l.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function A0(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function _0(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let s=t[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function M0(t){let e=Object.create(null);if(t)for(let n in t)e[n]=new SA(t[n]);return e}class Rc{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=M0(r.attrs),this.defaultAttrs=A0(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==ts.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:_0(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new lr(this,this.computeAttrs(e),z.from(n),Fe.setFrom(r))}createChecked(e=null,n,r){if(n=z.from(n),!this.validContent(n))throw new RangeError("Invalid content for node "+this.name);return new lr(this,this.computeAttrs(e),n,Fe.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=z.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(z.empty,!0);return s?new lr(this,e,n.append(s),Fe.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Fe.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,o)=>r[s]=new Rc(s,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}}class SA{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Mu{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=M0(i.attrs),this.excluded=null;let s=A0(this.attrs);this.instance=s?new Fe(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Fe(this,_0(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new Mu(s,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}excludes(e){return this.excluded.indexOf(e)>-1}}class TA{constructor(e){this.cached=Object.create(null),this.spec={nodes:bt.from(e.nodes),marks:bt.from(e.marks||{}),topNode:e.topNode},this.nodes=Rc.compile(this.spec.nodes,this),this.marks=Mu.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let i=this.nodes[r],s=i.spec.content||"",o=i.spec.marks;i.contentMatch=n[s]||(n[s]=ts.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet=o=="_"?null:o?Zm(this,o.split(" ")):o==""||!i.inlineContent?[]:null}for(let r in this.marks){let i=this.marks[r],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:Zm(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Rc){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new Dc(r,r.defaultAttrs,e,Fe.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeFromJSON(e){return lr.fromJSON(this,e)}markFromJSON(e){return Fe.fromJSON(this,e)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function Zm(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],o=s;if(s)n.push(s);else for(let a in t.marks){let l=t.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}class io{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[],n.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,n={}){let r=new ty(this,n,!1);return r.addAll(e,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new ty(this,n,!0);return r.addAll(e,n.from,n.to),J.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(IA(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=n))){if(o.getAttrs){let l=o.getAttrs(n);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let a=n[o];if((a.priority==null?50:a.priority)<s)break}n.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=ny(o)),o.mark=i})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=ny(o)),o.node=i})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new io(e,io.schemaRules(e)))}}const O0={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},CA={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},N0={ol:!0,ul:!0},Pc=1,Lc=2,aa=4;function ey(t,e,n){return e!=null?(e?Pc:0)|(e==="full"?Lc:0):t&&t.whitespace=="pre"?Pc|Lc:n&~aa}class Bl{constructor(e,n,r,i,s,o,a){this.type=e,this.attrs=n,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=a,this.content=[],this.activeMarks=Fe.none,this.stashMarks=[],this.match=o||(a&aa?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(z.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Pc)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=z.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(z.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}popFromStashMark(e){for(let n=this.stashMarks.length-1;n>=0;n--)if(e.eq(this.stashMarks[n]))return this.stashMarks.splice(n,1)[0]}applyPending(e){for(let n=0,r=this.pendingMarks;n<r.length;n++){let i=r[n];(this.type?this.type.allowsMarkType(i.type):_A(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!O0.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class ty{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0;let i=n.topNode,s,o=ey(null,n.preserveWhitespace,0)|(r?aa:0);i?s=new Bl(i.type,i.attrs,Fe.none,Fe.none,!0,n.topMatch||i.type.contentMatch,o):r?s=new Bl(null,null,Fe.none,Fe.none,!0,null,o):s=new Bl(e.schema.topNodeType,null,Fe.none,Fe.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){if(e.nodeType==3)this.addTextNode(e);else if(e.nodeType==1){let n=e.getAttribute("style"),r=n?this.readStyles(AA(n)):null,i=this.top;if(r!=null)for(let s=0;s<r.length;s++)this.addPendingMark(r[s]);if(this.addElement(e),r!=null)for(let s=0;s<r.length;s++)this.removePendingMark(r[s],i)}}addTextNode(e){let n=e.nodeValue,r=this.top;if(r.options&Lc||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(r.options&Pc)r.options&Lc?n=n.replace(/\r\n?/g,`
`):n=n.replace(/\r?\n|\r/g," ");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n)),this.findInText(e)}else this.findInside(e)}addElement(e,n){let r=e.nodeName.toLowerCase(),i;N0.hasOwnProperty(r)&&this.parser.normalizeLists&&kA(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,n));if(s?s.ignore:CA.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,a=this.top,l=this.needsBlock;if(O0.hasOwnProperty(r))o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}this.addAll(e),o&&this.sync(a),this.needsBlock=l}else this.addElementByRule(e,s,s.consuming===!1?i:void 0)}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let n=Fe.none;e:for(let r=0;r<e.length;r+=2)for(let i=void 0;;){let s=this.parser.matchStyle(e[r],e[r+1],this,i);if(!s)continue e;if(s.ignore)return null;if(n=this.parser.schema.marks[s.mark].create(s.attrs).addToSet(n),s.consuming===!1)i=s;else break}return n}addElementByRule(e,n,r){let i,s,o;n.node?(s=this.parser.schema.nodes[n.node],s.isLeaf?this.insertNode(s.create(n.attrs))||this.leafFallback(e):i=this.enter(s,n.attrs||null,n.preserveWhitespace)):(o=this.parser.schema.marks[n.mark].create(n.attrs),this.addPendingMark(o));let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof n.contentElement=="string"?l=e.querySelector(n.contentElement):typeof n.contentElement=="function"?l=n.contentElement(e):n.contentElement&&(l=n.contentElement),this.findAround(e,l,!0),this.addAll(l)}i&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,n,r){let i=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let n,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!n||n.length>o.length)&&(n=o,r=s,!o.length)||s.solid)break}if(!n)return!1;this.sync(r);for(let i=0;i<n.length;i++)this.enterInner(n[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let n=this.textblockFromContext();n&&this.enterInner(n)}if(this.findPlace(e)){this.closeExtra();let n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));let r=n.activeMarks;for(let i=0;i<e.marks.length;i++)(!n.type||n.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return n.content.push(e.mark(r)),!0}return!1}enter(e,n,r){let i=this.findPlace(e.create(n));return i&&this.enterInner(e,n,!0,r),i}enterInner(e,n=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=ey(e,i,s.options);s.options&aa&&s.content.length==0&&(o|=aa),this.nodes.push(new Bl(e,n,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let n=this.open;n>=0;n--)if(this.nodes[n]==e)return this.open=n,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(a,l)=>{for(;a>=0;a--){let c=n[a];if(c==""){if(a==n.length-1||a==0)continue;for(;l>=s;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=s?r.node(l-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let n=MA(e,this.top.pendingMarks);n&&this.top.stashMarks.push(n),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,n){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==n)break}}}function kA(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&N0.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function IA(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function AA(t){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,n,r=[];for(;n=e.exec(t);)r.push(n[1],n[2].trim());return r}function ny(t){let e={};for(let n in t)e[n]=t[n];return e}function _A(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],o=a=>{s.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function MA(t,e){for(let n=0;n<e.length;n++)if(t.eq(e[n]))return e[n]}class rr{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=$h(n).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let a=0,l=0;for(;a<s.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(s[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<s.length;)i=s.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,n);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=rr.renderSpec($h(n),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&rr.renderSpec($h(r),i(e,n))}static renderSpec(e,n,r=null){if(typeof n=="string")return{dom:e.createTextNode(n)};if(n.nodeType!=null)return{dom:n};if(n.dom&&n.dom.nodeType!=null)return n;let i=n[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,a=r?e.createElementNS(r,i):e.createElement(i),l=n[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let h=u.indexOf(" ");h>0?a.setAttributeNS(u.slice(0,h),u.slice(h+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<n.length;u++){let h=n[u];if(h===0){if(u<n.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:d,contentDOM:f}=rr.renderSpec(e,h,r);if(a.appendChild(d),f){if(o)throw new RangeError("Multiple content holes");o=f}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new rr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=ry(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return ry(e.marks)}}function ry(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function $h(t){return t.document||window.document}const D0=65535,R0=Math.pow(2,16);function OA(t,e){return t+e*R0}function iy(t){return t&D0}function NA(t){return(t-(t&D0))/R0}const P0=1,L0=2,uc=4,B0=8;class Xd{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&B0)>0}get deletedBefore(){return(this.delInfo&(P0|uc))>0}get deletedAfter(){return(this.delInfo&(L0|uc))>0}get deletedAcross(){return(this.delInfo&uc)>0}}class Tn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Tn.empty)return Tn.empty}recover(e){let n=0,r=iy(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+NA(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+s],u=this.ranges[a+o],h=l+c;if(e<=h){let d=c?e==l?-1:e==h?1:n:n,f=l+i+(d<0?0:u);if(r)return f;let p=e==(n<0?l:h)?null:OA(a/3,e-l),g=e==l?L0:e==h?P0:uc;return(n<0?e!=l:e!=h)&&(g|=B0),new Xd(f,g,p)}i+=u-c}return r?e+i:new Xd(e+i,0,null)}touches(e,n){let r=0,i=iy(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+s],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],a=o-(this.inverted?s:0),l=o+(this.inverted?0:s),c=this.ranges[i+n],u=this.ranges[i+r];e(a,a+c,l,l+u),s+=u-c}}invert(){return new Tn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Tn.empty:new Tn(e<0?[0,-e,0]:[0,0,e])}}Tn.empty=new Tn([]);class Xs{constructor(e=[],n,r=0,i=e.length){this.maps=e,this.mirror=n,this.from=r,this.to=i}slice(e=0,n=this.maps.length){return new Xs(this.maps,this.mirror,e,n)}copy(){return new Xs(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,n){this.to=this.maps.push(e),n!=null&&this.setMirror(this.maps.length-1,n)}appendMapping(e){for(let n=0,r=this.maps.length;n<e.maps.length;n++){let i=e.getMirror(n);this.appendMap(e.maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this.maps.length+e.maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e.maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Xs;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],a=o.mapResult(e,n);if(a.recover!=null){let l=this.getMirror(s);if(l!=null&&l>s&&l<this.to){s=l,e=this.maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Xd(e,i,null)}}const Uh=Object.create(null);class an{getMap(){return Tn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Uh[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in Uh)throw new RangeError("Duplicate use of step JSON ID "+e);return Uh[e]=n,n.prototype.jsonID=e,n}}class st{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new st(e,null)}static fail(e){return new st(null,e)}static fromReplace(e,n,r,i){try{return st.ok(e.replace(n,r,i))}catch(s){if(s instanceof Aa)return st.fail(s.message);throw s}}}function kp(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(kp(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return z.fromArray(r)}class Vr extends an{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new J(kp(n.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return st.fromReplace(e,this.from,this.to,s)}invert(){return new ir(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Vr(n.pos,r.pos,this.mark)}merge(e){return e instanceof Vr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Vr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Vr(n.from,n.to,e.markFromJSON(n.mark))}}an.jsonID("addMark",Vr);class ir extends an{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new J(kp(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return st.fromReplace(e,this.from,this.to,r)}invert(){return new Vr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ir(n.pos,r.pos,this.mark)}merge(e){return e instanceof ir&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ir(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ir(n.from,n.to,e.markFromJSON(n.mark))}}an.jsonID("removeMark",ir);class $r extends an{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return st.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return st.fromReplace(e,this.pos,this.pos+1,new J(z.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new $r(this.pos,n.marks[i]);return new $r(this.pos,this.mark)}}return new so(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new $r(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new $r(n.pos,e.markFromJSON(n.mark))}}an.jsonID("addNodeMark",$r);class so extends an{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return st.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return st.fromReplace(e,this.pos,this.pos+1,new J(z.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new $r(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new so(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new so(n.pos,e.markFromJSON(n.mark))}}an.jsonID("removeNodeMark",so);class _t extends an{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&Yd(e,this.from,this.to)?st.fail("Structure replace would overwrite content"):st.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Tn([this.from,this.to-this.from,this.slice.size])}invert(e){return new _t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new _t(n.pos,Math.max(n.pos,r.pos),this.slice)}merge(e){if(!(e instanceof _t)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?J.empty:new J(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new _t(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?J.empty:new J(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new _t(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new _t(n.from,n.to,J.fromJSON(e,n.slice),!!n.structure)}}an.jsonID("replace",_t);class ut extends an{constructor(e,n,r,i,s,o,a=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Yd(e,this.from,this.gapFrom)||Yd(e,this.gapTo,this.to)))return st.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return st.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?st.fromReplace(e,this.from,this.to,r):st.fail("Content does not fit in gap")}getMap(){return new Tn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new ut(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new ut(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ut(n.from,n.to,n.gapFrom,n.gapTo,J.fromJSON(e,n.slice),n.insert,!!n.structure)}}an.jsonID("replaceAround",ut);function Yd(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function DA(t,e,n,r){let i=[],s=[],o,a;t.doc.nodesBetween(e,n,(l,c,u)=>{if(!l.isInline)return;let h=l.marks;if(!r.isInSet(h)&&u.type.allowsMarkType(r.type)){let d=Math.max(c,e),f=Math.min(c+l.nodeSize,n),p=r.addToSet(h);for(let g=0;g<h.length;g++)h[g].isInSet(p)||(o&&o.to==d&&o.mark.eq(h[g])?o.to=f:i.push(o=new ir(d,f,h[g])));a&&a.to==d?a.to=f:s.push(a=new Vr(d,f,r))}}),i.forEach(l=>t.step(l)),s.forEach(l=>t.step(l))}function RA(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(o,a)=>{if(!o.isInline)return;s++;let l=null;if(r instanceof Mu){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,n);for(let u=0;u<l.length;u++){let h=l[u],d;for(let f=0;f<i.length;f++){let p=i[f];p.step==s-1&&h.eq(i[f].style)&&(d=p)}d?(d.to=c,d.step=s):i.push({style:h,from:Math.max(a,e),to:c,step:s})}}}),i.forEach(o=>t.step(new ir(o.from,o.to,o.style)))}function PA(t,e,n,r=n.contentMatch){let i=t.doc.nodeAt(e),s=[],o=e+1;for(let a=0;a<i.childCount;a++){let l=i.child(a),c=o+l.nodeSize,u=r.matchType(l.type);if(!u)s.push(new _t(o,c,J.empty));else{r=u;for(let h=0;h<l.marks.length;h++)n.allowsMarkType(l.marks[h].type)||t.step(new ir(o,c,l.marks[h]))}o=c}if(!r.validEnd){let a=r.fillBefore(z.empty,!0);t.replace(o,o,new J(a,0,0))}for(let a=s.length-1;a>=0;a--)t.step(s[a])}function LA(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function _o(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),s=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(s,o,n))return r;if(r==0||i.type.spec.isolating||!LA(i,s,o))break}return null}function BA(t,e,n){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=z.empty,h=0;for(let p=s,g=!1;p>n;p--)g||r.index(p)>0?(g=!0,u=z.from(r.node(p).copy(u)),h++):l--;let d=z.empty,f=0;for(let p=s,g=!1;p>n;p--)g||i.after(p+1)<i.end(p)?(g=!0,d=z.from(i.node(p).copy(d)),f++):c++;t.step(new ut(l,c,o,a,new J(u.append(d),h,f),u.size-h,!0))}function Ip(t,e,n=null,r=t){let i=FA(t,e),s=i&&VA(r,e);return s?i.map(sy).concat({type:e,attrs:n}).concat(s.map(sy)):null}function sy(t){return{type:t,attrs:null}}function FA(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(r,i,o)?s:null}function VA(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(n.child(c).type);return!l||!l.validEnd?null:o}function $A(t,e,n){let r=z.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let a=n[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=z.from(n[o].type.create(n[o].attrs,r))}let i=e.start,s=e.end;t.step(new ut(i,s,i,s,new J(r,0,0),n.length,!0))}function UA(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&zA(t.doc,t.mapping.slice(s).map(a),r)){t.clearIncompatible(t.mapping.slice(s).map(a,1),r);let l=t.mapping.slice(s),c=l.map(a,1),u=l.map(a+o.nodeSize,1);return t.step(new ut(c,u,c+1,u-1,new J(z.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function zA(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function HA(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new ut(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new J(z.from(o),0,0),1,!0))}function Ys(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>s;c--,u--){let h=i.node(c),d=i.index(c);if(h.type.spec.isolating)return!1;let f=h.content.cutByIndex(d,h.childCount),p=r&&r[u]||h;if(p!=h&&(f=f.replaceChild(0,p.type.create(p.attrs))),!h.canReplace(d+1,h.childCount)||!p.type.validContent(f))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function jA(t,e,n=1,r){let i=t.doc.resolve(e),s=z.empty,o=z.empty;for(let a=i.depth,l=i.depth-n,c=n-1;a>l;a--,c--){s=z.from(i.node(a).copy(s));let u=r&&r[c];o=z.from(u?u.type.create(u.attrs,o):i.node(a).copy(o))}t.step(new _t(e,e,new J(s.append(o),n,n),!0))}function Mo(t,e){let n=t.resolve(e),r=n.index();return KA(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function KA(t,e){return!!(t&&e&&!t.isLeaf&&t.canAppend(e))}function qA(t,e,n){let r=new _t(e-n,e+n,J.empty,!0);t.step(r)}function WA(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function F0(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(l,l,i);else{let h=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=h&&c.canReplaceWith(l,l,h[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Ap(t,e,n=e,r=J.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return V0(i,s,r)?new _t(e,n,r):new GA(i,s,r).fit()}function V0(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class GA{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=z.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=z.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,a=i.depth;for(;o&&a&&s.childCount==1;)s=s.firstChild.content,o--,a--;let l=new J(s,o,a);return e>-1?new ut(r.pos,e,this.$to.pos,this.$to.end(),l,n):l.size||r.pos!=this.$to.pos?new _t(r.pos,i.pos,l):null}findFittable(){for(let e=1;e<=2;e++)for(let n=this.unplaced.openStart;n>=0;n--){let r,i=null;n?(i=zh(this.unplaced.content,n-1).firstChild,r=i.content):r=this.unplaced.content;let s=r.firstChild;for(let o=this.depth;o>=0;o--){let{type:a,match:l}=this.frontier[o],c,u=null;if(e==1&&(s?l.matchType(s.type)||(u=l.fillBefore(z.from(s),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:n,frontierDepth:o,parent:i,inject:u};if(e==2&&s&&(c=l.findWrapping(s.type)))return{sliceDepth:n,frontierDepth:o,parent:i,wrap:c};if(i&&l.matchType(i.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=zh(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new J(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=zh(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new J(Xo(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new J(Xo(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let g=0;g<s.length;g++)this.openFrontierNode(s[g]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:h,type:d}=this.frontier[n];if(i){for(let g=0;g<i.childCount;g++)u.push(i.child(g));h=h.matchFragment(i)}let f=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let g=a.child(c),m=h.matchType(g.type);if(!m)break;c++,(c>1||l==0||g.content.size)&&(h=m,u.push($0(g.mark(d.allowedMarks(g.marks)),c==1?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=Yo(this.placed,n,z.from(u)),this.frontier[n].match=h,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,m=a;g<f;g++){let w=m.lastChild;this.frontier.push({type:w.type,match:w.contentMatchAt(w.childCount)}),m=w.content}this.unplaced=p?e==0?J.empty:new J(Xo(o.content,e-1,1),e-1,f<0?o.openEnd:e-1):new J(Xo(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!Hh(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=Hh(e,n,i,r,s);if(!!o){for(let a=n-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=Hh(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Yo(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Yo(this.placed,this.depth,z.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(z.empty,!0);n.childCount&&(this.placed=Yo(this.placed,this.frontier.length,n))}}function Xo(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Xo(t.firstChild.content,e-1,n)))}function Yo(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Yo(t.lastChild.content,e-1,n)))}function zh(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function $0(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,$0(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(z.empty,!0)))),t.copy(r)}function Hh(t,e,n,r,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!JA(n,s.content,o)?a:null}function JA(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function XA(t){return t.spec.defining||t.spec.definingForContent}function YA(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(V0(i,s,r))return t.step(new _t(e,n,r));let o=z0(i,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let d=i.depth,f=i.pos-1;d>0;d--,f--){let p=i.node(d).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(d)>-1?a=d:i.before(d)==f&&o.splice(1,0,-d)}let l=o.indexOf(a),c=[],u=r.openStart;for(let d=r.content,f=0;;f++){let p=d.firstChild;if(c.push(p),f==r.openStart)break;d=p.content}for(let d=u-1;d>=0;d--){let f=c[d].type,p=XA(f);if(p&&i.node(l).type!=f)u=d;else if(p||!f.isTextblock)break}for(let d=r.openStart;d>=0;d--){let f=(d+u+1)%(r.openStart+1),p=c[f];if(!!p)for(let g=0;g<o.length;g++){let m=o[(g+l)%o.length],w=!0;m<0&&(w=!1,m=-m);let _=i.node(m-1),M=i.index(m-1);if(_.canReplaceWith(M,M,p.type,p.marks))return t.replace(i.before(m),w?s.after(m):n,new J(U0(r.content,0,r.openStart,f),f,r.openEnd))}}let h=t.steps.length;for(let d=o.length-1;d>=0&&(t.replace(e,n,r),!(t.steps.length>h));d--){let f=o[d];f<0||(e=i.before(f),n=s.after(f))}}function U0(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(U0(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(z.empty,!0))}return t}function QA(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=WA(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new J(z.from(r),0,0))}function ZA(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=z0(r,i);for(let o=0;o<s.length;o++){let a=s[o],l=o==s.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return t.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return t.delete(r.before(a),i.after(a))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o)return t.delete(r.before(o),n);t.delete(e,n)}function z0(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class Qs extends an{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return st.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return st.fromReplace(e,this.pos,this.pos+1,new J(z.from(i),0,n.isLeaf?0:1))}getMap(){return Tn.empty}invert(e){return new Qs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Qs(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Qs(n.pos,n.attr,n.value)}}an.jsonID("attr",Qs);let oo=class extends Error{};oo=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};oo.prototype=Object.create(Error.prototype);oo.prototype.constructor=oo;oo.prototype.name="TransformError";class H0{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Xs}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new oo(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=J.empty){let i=Ap(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new J(z.from(r),0,0))}delete(e,n){return this.replace(e,n,J.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return YA(this,e,n,r),this}replaceRangeWith(e,n,r){return QA(this,e,n,r),this}deleteRange(e,n){return ZA(this,e,n),this}lift(e,n){return BA(this,e,n),this}join(e,n=1){return qA(this,e,n),this}wrap(e,n){return $A(this,e,n),this}setBlockType(e,n=e,r,i=null){return UA(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i=[]){return HA(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new Qs(e,n,r)),this}addNodeMark(e,n){return this.step(new $r(e,n)),this}removeNodeMark(e,n){if(!(n instanceof Fe)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n=n.isInSet(r.marks),!n)return this}return this.step(new so(e,n)),this}split(e,n=1,r){return jA(this,e,n,r),this}addMark(e,n,r){return DA(this,e,n,r),this}removeMark(e,n,r){return RA(this,e,n,r),this}clearIncompatible(e,n,r){return PA(this,e,n,r),this}}const jh=Object.create(null);class ue{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new j0(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=J.empty){let r=n.content.lastChild,i=null;for(let a=0;a<n.openEnd;a++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(c.pos),a?J.empty:n),a==0&&ly(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:a}=i[s],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,n),ly(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new pe(e):Ps(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=n<0?Ps(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):Ps(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new zn(e.node(0))}static atStart(e){return Ps(e,e,0,0,1)||new zn(e)}static atEnd(e){return Ps(e,e,e.content.size,e.childCount,-1)||new zn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=jh[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in jh)throw new RangeError("Duplicate use of selection JSON ID "+e);return jh[e]=n,n.prototype.jsonID=e,n}getBookmark(){return pe.between(this.$anchor,this.$head).getBookmark()}}ue.prototype.visible=!0;class j0{constructor(e,n){this.$from=e,this.$to=n}}let oy=!1;function ay(t){!oy&&!t.parent.inlineContent&&(oy=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class pe extends ue{constructor(e,n=e){ay(e),ay(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return ue.near(r);let i=e.resolve(n.map(this.anchor));return new pe(i.parent.inlineContent?i:r,r)}replace(e,n=J.empty){if(super.replace(e,n),n==J.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof pe&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Ou(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new pe(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=ue.findFrom(n,r,!0)||ue.findFrom(n,-r,!0);if(s)n=s.$head;else return ue.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(ue.findFrom(e,-r,!0)||ue.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new pe(e,n)}}ue.jsonID("text",pe);class Ou{constructor(e,n){this.anchor=e,this.head=n}map(e){return new Ou(e.map(this.anchor),e.map(this.head))}resolve(e){return pe.between(e.resolve(this.anchor),e.resolve(this.head))}}class fe extends ue{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?ue.near(s):new fe(s)}content(){return new J(z.from(this.node),0,0)}eq(e){return e instanceof fe&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new _p(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new fe(e.resolve(n.anchor))}static create(e,n){return new fe(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}fe.prototype.visible=!1;ue.jsonID("node",fe);class _p{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new Ou(r,r):new _p(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&fe.isSelectable(r)?new fe(n):ue.near(n)}}class zn extends ue{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=J.empty){if(n==J.empty){e.delete(0,e.doc.content.size);let r=ue.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new zn(e)}map(e){return new zn(e)}eq(e){return e instanceof zn}getBookmark(){return e_}}ue.jsonID("all",zn);const e_={map(){return this},resolve(t){return new zn(t)}};function Ps(t,e,n,r,i,s=!1){if(e.inlineContent)return pe.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let a=e.child(o);if(a.isAtom){if(!s&&fe.isSelectable(a))return fe.create(t,n-(i<0?a.nodeSize:0))}else{let l=Ps(t,a,n+i,i<0?a.childCount:0,i,s);if(l)return l}n+=a.nodeSize*i}return null}function ly(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof _t||i instanceof ut))return;let s=t.mapping.maps[r],o;s.forEach((a,l,c,u)=>{o==null&&(o=u)}),t.setSelection(ue.near(t.doc.resolve(o),n))}const cy=1,Fl=2,uy=4;class t_ extends H0{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|cy)&~Fl,this.storedMarks=null,this}get selectionSet(){return(this.updated&cy)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Fl,this}ensureMarks(e){return Fe.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Fl)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Fl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Fe.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r==null?n:r,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,s)),this.selection.empty||this.setSelection(ue.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=uy,this}get scrolledIntoView(){return(this.updated&uy)>0}}function hy(t,e){return!e||!t?t:t.bind(e)}class Qo{constructor(e,n,r){this.name=e,this.init=hy(n.init,r),this.apply=hy(n.apply,r)}}const n_=[new Qo("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Qo("selection",{init(t,e){return t.selection||ue.atStart(e.doc)},apply(t){return t.selection}}),new Qo("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Qo("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class Kh{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=n_.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Qo(r.key,r.spec.state,r))})}}class $s{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=i?i[o].n:0,c=i?i[o].state:this,u=l<n.length&&a.spec.appendTransaction.call(a,l?n.slice(l):n,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let h=0;h<this.config.plugins.length;h++)i.push(h<o?{state:r,n:n.length}:{state:this,n:0})}n.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new $s(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new t_(this)}static create(e){let n=new Kh(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new $s(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new Kh(this.schema,e.plugins),r=n.fields,i=new $s(n);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Kh(e.schema,e.plugins),s=new $s(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=lr.fromJSON(e.schema,n.doc);else if(o.name=="selection")s.selection=ue.fromJSON(s.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(n,a)){s[o.name]=c.fromJSON.call(l,e,n[a],s);return}}s[o.name]=o.init(e,s)}}),s}}function K0(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=K0(i,e,{})),n[r]=i}return n}class Tt{constructor(e){this.spec=e,this.props={},e.props&&K0(e.props,this,this.props),this.key=e.key?e.key.key:q0("plugin")}getState(e){return e[this.key]}}const qh=Object.create(null);function q0(t){return t in qh?t+"$"+ ++qh[t]:(qh[t]=0,t+"$")}class ln{constructor(e="key"){this.key=q0(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const un=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},Ma=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let dy=null;const yr=function(t,e,n){let r=dy||(dy=document.createRange());return r.setEnd(t,n==null?t.nodeValue.length:n),r.setStart(t,e||0),r},ns=function(t,e,n,r){return n&&(fy(t,e,n,r,-1)||fy(t,e,n,r,1))},r_=/^(img|br|input|textarea|hr)$/i;function fy(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:er(t))){let s=t.parentNode;if(!s||s.nodeType!=1||s_(t)||r_.test(t.nodeName)||t.contentEditable=="false")return!1;e=un(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.contentEditable=="false")return!1;e=i<0?er(t):0}else return!1}}function er(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function i_(t,e,n){for(let r=e==0,i=e==er(t);r||i;){if(t==n)return!0;let s=un(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,i=i&&s==er(t)}}function s_(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Nu=function(t){return t.focusNode&&ns(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function Us(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function o_(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}const ri=typeof navigator<"u"?navigator:null,py=typeof document<"u"?document:null,ci=ri&&ri.userAgent||"",Qd=/Edge\/(\d+)/.exec(ci),W0=/MSIE \d/.exec(ci),Zd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ci),rn=!!(W0||Zd||Qd),Wr=W0?document.documentMode:Zd?+Zd[1]:Qd?+Qd[1]:0,Kn=!rn&&/gecko\/(\d+)/i.test(ci);Kn&&+(/Firefox\/(\d+)/.exec(ci)||[0,0])[1];const ef=!rn&&/Chrome\/(\d+)/.exec(ci),nn=!!ef,a_=ef?+ef[1]:0,Wt=!rn&&!!ri&&/Apple Computer/.test(ri.vendor),ao=Wt&&(/Mobile\/\w+/.test(ci)||!!ri&&ri.maxTouchPoints>2),xn=ao||(ri?/Mac/.test(ri.platform):!1),tr=/Android \d/.test(ci),Du=!!py&&"webkitFontSmoothing"in py.documentElement.style,l_=Du?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function c_(t){return{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function Mr(t,e){return typeof t=="number"?t:t[e]}function u_(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function gy(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;o=Ma(o)){if(o.nodeType!=1)continue;let a=o,l=a==s.body,c=l?c_(s):u_(a),u=0,h=0;if(e.top<c.top+Mr(r,"top")?h=-(c.top-e.top+Mr(i,"top")):e.bottom>c.bottom-Mr(r,"bottom")&&(h=e.bottom-c.bottom+Mr(i,"bottom")),e.left<c.left+Mr(r,"left")?u=-(c.left-e.left+Mr(i,"left")):e.right>c.right-Mr(r,"right")&&(u=e.right-c.right+Mr(i,"right")),u||h)if(l)s.defaultView.scrollBy(u,h);else{let d=a.scrollLeft,f=a.scrollTop;h&&(a.scrollTop+=h),u&&(a.scrollLeft+=u);let p=a.scrollLeft-d,g=a.scrollTop-f;e={left:e.left-p,top:e.top-g,right:e.right-p,bottom:e.bottom-g}}if(l)break}}function h_(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=t.root.elementFromPoint(s,o);if(!a||a==t.dom||!t.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=n-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:G0(t.dom)}}function G0(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=Ma(r));return e}function d_({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;J0(n,r==0?0:r-e)}function J0(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:s}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let As=null;function f_(t){if(t.setActive)return t.setActive();if(As)return t.focus(As);let e=G0(t);t.focus(As==null?{get preventScroll(){return As={preventScroll:!0},!0}}:void 0),As||(As=!1,J0(e,0))}function X0(t,e){let n,r=2e8,i,s=0,o=e.top,a=e.top;for(let l=t.firstChild,c=0;l;l=l.nextSibling,c++){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=yr(l).getClientRects();else continue;for(let h=0;h<u.length;h++){let d=u[h];if(d.top<=o&&d.bottom>=a){o=Math.max(d.bottom,o),a=Math.min(d.top,a);let f=d.left>e.left?d.left-e.left:d.right<e.left?e.left-d.right:0;if(f<r){n=l,r=f,i=f&&n.nodeType==3?{left:d.right<e.left?d.right:d.left,top:e.top}:e,l.nodeType==1&&f&&(s=c+(e.left>=(d.left+d.right)/2?1:0));continue}}!n&&(e.left>=d.right&&e.top>=d.top||e.left>=d.left&&e.top>=d.bottom)&&(s=c+1)}}return n&&n.nodeType==3?p_(n,i):!n||r&&n.nodeType==1?{node:t,offset:s}:X0(n,i)}function p_(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let s=Nr(r,1);if(s.top!=s.bottom&&Mp(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function Mp(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function g_(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function m_(t,e,n){let{node:r,offset:i}=X0(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,s)}function y_(t,e,n,r){let i=-1;for(let s=e;s!=t.dom;){let o=t.docView.nearestDesc(s,!0);if(!o)return null;if(o.node.isBlock&&o.parent){let a=o.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)i=o.posBefore;else if(a.right<r.left||a.bottom<r.top)i=o.posAfter;else break}s=o.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,1)}function Y0(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let o=t.childNodes[s];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Mp(e,c))return Y0(o,e,c)}}if((s=(s+1)%r)==i)break}return t}function b_(t,e){let n=t.dom.ownerDocument,r,i=0;if(n.caretPositionFromPoint)try{let l=n.caretPositionFromPoint(e.left,e.top);l&&({offsetNode:r,offset:i}=l)}catch{}if(!r&&n.caretRangeFromPoint){let l=n.caretRangeFromPoint(e.left,e.top);l&&({startContainer:r,startOffset:i}=l)}let s=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),o;if(!s||!t.dom.contains(s.nodeType!=1?s.parentNode:s)){let l=t.dom.getBoundingClientRect();if(!Mp(e,l)||(s=Y0(t.dom,e,l),!s))return null}if(Wt)for(let l=s;r&&l;l=Ma(l))l.draggable&&(r=void 0);if(s=g_(s,e),r){if(Kn&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let l=r.childNodes[i],c;l.nodeName=="IMG"&&(c=l.getBoundingClientRect()).right<=e.left&&c.bottom>e.top&&i++}r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?o=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(o=y_(t,r,i,e))}o==null&&(o=m_(t,s,e));let a=t.docView.nearestDesc(s,!0);return{pos:o,inside:a?a.posAtStart-a.border:-1}}function Nr(t,e){let n=t.getClientRects();return n.length?n[e<0?0:n.length-1]:t.getBoundingClientRect()}const w_=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Q0(t,e,n){let{node:r,offset:i,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=Du||Kn;if(r.nodeType==3)if(o&&(w_.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let l=Nr(yr(r,i,i),n);if(Kn&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Nr(yr(r,i-1,i-1),-1);if(c.top==l.top){let u=Nr(yr(r,i,i+1),-1);if(u.top!=l.top)return Vo(u,u.left<c.left)}}return l}else{let l=i,c=i,u=n<0?1:-1;return n<0&&!i?(c++,u=-1):n>=0&&i==r.nodeValue.length?(l--,u=1):n<0?l--:c++,Vo(Nr(yr(r,l,c),1),u<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(n<0||i==er(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return Wh(l.getBoundingClientRect(),!1)}if(s==null&&i<er(r)){let l=r.childNodes[i];if(l.nodeType==1)return Wh(l.getBoundingClientRect(),!0)}return Wh(r.getBoundingClientRect(),n>=0)}if(s==null&&i&&(n<0||i==er(r))){let l=r.childNodes[i-1],c=l.nodeType==3?yr(l,er(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Vo(Nr(c,1),!1)}if(s==null&&i<er(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?yr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Vo(Nr(c,-1),!0)}return Vo(Nr(r.nodeType==3?yr(r):r,-n),n>=0)}function Vo(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function Wh(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function Z0(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function v_(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return Z0(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let a=t.docView.nearestDesc(s,!0);if(!a)break;if(a.node.isBlock){s=a.dom;break}s=a.dom.parentNode}let o=Q0(t,i.pos,1);for(let a=s.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=yr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(n=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const E_=/[\u0590-\u08ac]/;function x_(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=t.domSelection();return!E_.test(r.parent.textContent)||!a.modify?n=="left"||n=="backward"?s:o:Z0(t,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:h}=t.domSelectionRange(),d=a.caretBidiLevel;a.modify("move",n,"character");let f=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:p,focusOffset:g}=t.domSelectionRange(),m=p&&!f.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==g;try{a.collapse(u,h),l&&(l!=u||c!=h)&&a.extend&&a.extend(l,c)}catch{}return d!=null&&(a.caretBidiLevel=d),m})}let my=null,yy=null,by=!1;function S_(t,e,n){return my==e&&yy==n?by:(my=e,yy=n,by=n=="up"||n=="down"?v_(t,e,n):x_(t,e,n))}const Hn=0,wy=1,zs=2,hr=3;class al{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=Hn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>un(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return(i==null?r>0:i)?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!n||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],a=s+o.size;if(a>e||o instanceof tE){i=e-s;break}s=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof eE&&s.side>=0;r--);if(n<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?un(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?un(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(i==-1&&e<=c){let u=o+l.border;if(e>=u&&n<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,n,u);e=o;for(let h=a;h>0;h--){let d=this.children[h-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=un(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(c>n||a==this.children.length-1)){n=c;for(let u=a+1;u<this.children.length;u++){let h=this.children[u];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(-1)){s=un(h.dom);break}n+=h.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let d=0,f=0;d<this.children.length;d++){let p=this.children[d],g=f+p.size;if(s>f&&o<g)return p.setSelection(e-f-p.border,n-f-p.border,r,i);f=g}let a=this.domFromPos(e,e?-1:1),l=n==e?a:this.domFromPos(n,n?-1:1),c=r.getSelection(),u=!1;if((Kn||Wt)&&e==n){let{node:d,offset:f}=a;if(d.nodeType==3){if(u=!!(f&&d.nodeValue[f-1]==`
`),u&&f==d.nodeValue.length)for(let p=d,g;p;p=p.parentNode){if(g=p.nextSibling){g.nodeName=="BR"&&(a=l={node:g.parentNode,offset:un(g)+1});break}let m=p.pmViewDesc;if(m&&m.node&&m.node.isBlock)break}}else{let p=d.childNodes[f-1];u=p&&(p.nodeName=="BR"||p.contentEditable=="false")}}if(Kn&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let d=c.focusNode.childNodes[c.focusOffset];d&&d.contentEditable=="false"&&(i=!0)}if(!(i||u&&Wt)&&ns(a.node,a.offset,c.anchorNode,c.anchorOffset)&&ns(l.node,l.offset,c.focusNode,c.focusOffset))return;let h=!1;if((c.extend||e==n)&&!u){c.collapse(a.node,a.offset);try{e!=n&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>n){let f=a;a=l,l=f}let d=document.createRange();d.setEnd(l.node,l.offset),d.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(d)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let a=r+s.border,l=o-s.border;if(e>=a&&n<=l){this.dirty=e==r||n==o?zs:wy,e==a&&n==l&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=hr:s.markDirty(e-a,n-a);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?zs:hr}r=o}this.dirty=zs}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?zs:wy;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class eE extends al{constructor(e,n,r,i){let s,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==Hn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class T_ extends al{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class rs extends al{constructor(e,n,r,i){super(e,[],r,i),this.mark=n}static create(e,n,r,i){let s=i.nodeViews[n.type.name],o=s&&s(n,i,r);return(!o||!o.dom)&&(o=rr.renderSpec(document,n.type.spec.toDOM(n,r))),new rs(e,n,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&hr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(e){return this.dirty!=hr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=Hn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Hn}}slice(e,n,r){let i=rs.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;n<o&&(s=rf(s,n,o,r)),e>0&&(s=rf(s,0,e,r));for(let a=0;a<s.length;a++)s[a].parent=i;return i.children=s,i}}class is extends al{constructor(e,n,r,i,s,o,a,l,c){super(e,[],s,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a,o&&this.updateChildren(l,c)}static create(e,n,r,i,s,o){let a=s.nodeViews[n.type.name],l,c=a&&a(n,s,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,h=c&&c.contentDOM;if(n.isText){if(!u)u=document.createTextNode(n.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:h}=rr.renderSpec(document,n.type.spec.toDOM(n)));!h&&!n.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),n.type.spec.draggable&&(u.draggable=!0));let d=u;return u=iE(u,r,n),c?l=new C_(e,n,r,i,u,h||null,d,c,s,o+1):n.isText?new Ru(e,n,r,i,u,d,s):new is(e,n,r,i,u,h||null,d,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>z.empty)}return e}matchesNode(e,n,r){return this.dirty==Hn&&e.eq(this.node)&&nf(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,a=s&&s.pos<0,l=new I_(this,o&&o.node,e);M_(this.node,this.innerDeco,(c,u,h)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!h&&l.syncToMarks(u==this.node.childCount?Fe.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,h,d)=>{l.syncToMarks(c.marks,r,e);let f;l.findNodeMatch(c,u,h,d)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(f=l.findIndexWithChild(s.node))>-1&&l.updateNodeAt(c,u,h,f,e)||l.updateNextNode(c,u,h,e,d)||l.addNode(c,u,h,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==zs)&&(o&&this.protectLocalComposition(e,o),nE(this.contentDOM,this.children,e),ao&&O_(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof pe)||r<n||i>n+this.node.content.size)return null;let s=e.domSelectionRange(),o=N_(s.focusNode,s.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let a=o.nodeValue,l=D_(this.node.content,a,r-n,i-n);return l<0?null:{node:o,pos:l,text:a}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new T_(this,s,n,i);e.input.compositionNodes.push(o),this.children=rf(this.children,r,r+i.length,e,o)}update(e,n,r,i){return this.dirty==hr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Hn}updateOuterDeco(e){if(nf(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=rE(this.dom,this.nodeDOM,tf(this.outerDeco,this.node,n),tf(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function vy(t,e,n,r,i){return iE(r,e,t),new is(void 0,t,e,n,r,r,r,i,0)}class Ru extends is{constructor(e,n,r,i,s,o,a){super(e,n,r,i,s,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==hr||this.dirty!=Hn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=Hn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Hn,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),s=document.createTextNode(i.text);return new Ru(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=hr)}get domAtom(){return!1}}class tE extends al{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Hn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class C_ extends is{constructor(e,n,r,i,s,o,a,l,c,u){super(e,n,r,i,s,o,a,c,u),this.spec=l}update(e,n,r,i){if(this.dirty==hr)return!1;if(this.spec.update){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function nE(t,e,n){let r=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],a=o.dom;if(a.parentNode==t){for(;a!=r;)r=Ey(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(a,r);if(o instanceof rs){let l=r?r.previousSibling:t.lastChild;nE(o.contentDOM,o.children,n),r=l?l.nextSibling:t.firstChild}}for(;r;)r=Ey(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const la=function(t){t&&(this.nodeName=t)};la.prototype=Object.create(null);const Vi=[new la];function tf(t,e,n){if(t.length==0)return Vi;let r=n?Vi[0]:new la,i=[r];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(!!o){o.nodeName&&i.push(r=new la(o.nodeName));for(let a in o){let l=o[a];l!=null&&(n&&i.length==1&&i.push(r=new la(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function rE(t,e,n,r){if(n==Vi&&r==Vi)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(s){let l;a&&a.nodeName==o.nodeName&&i!=t&&(l=i.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Vi[0]),i=l}k_(i,a||Vi[0],o)}return i}function k_(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function iE(t,e,n){return rE(t,t,Vi,tf(e,n,t.nodeType!=1))}function nf(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function Ey(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class I_{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=A_(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=Hn,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++)if(this.top.children[l].matchesMark(e[s])){a=l;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=rs.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))s=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,n,r)&&!this.preMatch.matched.has(c)){s=a;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,i,s){let o=this.top.children[i];return o.dirty==hr&&o.dom==o.contentDOM&&(o.dirty=zs),o.update(e,n,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof is){let l=this.preMatch.matched.get(a);if(l!=null&&l!=s)return!1;let c=a.dom;if(!(this.lock&&(c==this.lock||c.nodeType==1&&c.contains(this.lock.parentNode))&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=hr&&nf(n,a.outerDeco)))&&a.update(e,n,r,i))return this.destroyBetween(this.index,o),a.dom!=c&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(e,n,r,i,s){this.top.children.splice(this.index++,0,is.create(this.top,e,n,r,i,s)),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new eE(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof rs;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Ru)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Wt||nn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new tE(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}}function A_(t,e){let n=e,r=n.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(r){let c=n.children[r-1];if(c instanceof rs)n=c,r=c.children.length;else{a=c,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(!!l){if(l!=t.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}function __(t,e){return t.type.side-e.type.side}function M_(t,e,n,r){let i=e.locals(t),s=0;if(i.length==0){for(let c=0;c<t.childCount;c++){let u=t.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){if(o<i.length&&i[o].to==s){let p=i[o++],g;for(;o<i.length&&i[o].to==s;)(g||(g=[p])).push(i[o++]);if(g){g.sort(__);for(let m=0;m<g.length;m++)n(g[m],c,!!l)}else n(p,c,!!l)}let u,h;if(l)h=-1,u=l,l=null;else if(c<t.childCount)h=c,u=t.child(c++);else break;for(let p=0;p<a.length;p++)a[p].to<=s&&a.splice(p--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let d=s+u.nodeSize;if(u.isText){let p=d;o<i.length&&i[o].from<p&&(p=i[o].from);for(let g=0;g<a.length;g++)a[g].to<p&&(p=a[g].to);p<d&&(l=u.cut(p-s),u=u.cut(0,p-s),d=p,h=-1)}let f=u.isInline&&!u.isLeaf?a.filter(p=>!p.inline):a.slice();r(u,f,e.forChild(s,u),h),s=d}}function O_(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function N_(t,e){for(;;){if(t.nodeType==3)return t;if(t.nodeType==1&&e>0){if(t.childNodes.length>e&&t.childNodes[e].nodeType==3)return t.childNodes[e];t=t.childNodes[e-1],e=er(t)}else if(t.nodeType==1&&e<t.childNodes.length)t=t.childNodes[e],e=0;else return null}}function D_(t,e,n,r){for(let i=0,s=0;i<t.childCount&&s<=r;){let o=t.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<t.childCount;){let c=t.child(i++);if(s+=c.nodeSize,!c.isText)break;l+=c.text}if(s>=n){let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=n)return a+c;if(n==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function rf(t,e,n,r,i){let s=[];for(let o=0,a=0;o<t.length;o++){let l=t[o],c=a,u=a+=l.size;c>=n||u<=e?s.push(l):(c<e&&s.push(l.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>n&&s.push(l.slice(n-c,l.size,r)))}return s}function Op(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Nu(n)){for(l=a;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&fe.isSelectable(u)&&i.parent&&!(u.isInline&&i_(n.focusNode,n.focusOffset,i.dom))){let h=i.posBefore;c=new fe(o==h?a:r.resolve(h))}}else{let u=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||t.state.selection.head<a.pos&&!s?1:-1;c=Np(t,l,a,u)}return c}function sE(t){return t.editable?t.hasFocus():aE(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Er(t,e=!1){let n=t.state.selection;if(oE(t,n),!!sE(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&nn){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&ns(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)P_(t);else{let{anchor:r,head:i}=n,s,o;xy&&!(n instanceof pe)&&(n.$from.parent.inlineContent||(s=Sy(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=Sy(t,n.to))),t.docView.setSelection(r,i,t.root,e),xy&&(s&&Ty(s),o&&Ty(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&R_(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const xy=Wt||nn&&a_<63;function Sy(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(Wt&&i&&i.contentEditable=="false")return Gh(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Gh(i);if(s)return Gh(s)}}function Gh(t){return t.contentEditable="true",Wt&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function Ty(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function R_(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!sE(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function P_(t){let e=t.domSelection(),n=document.createRange(),r=t.cursorWrapper.dom,i=r.nodeName=="IMG";i?n.setEnd(r.parentNode,un(r)+1):n.setEnd(r,0),n.collapse(!1),e.removeAllRanges(),e.addRange(n),!i&&!t.state.selection.visible&&rn&&Wr<=11&&(r.disabled=!0,r.disabled=!1)}function oE(t,e){if(e instanceof fe){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(Cy(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else Cy(t)}function Cy(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function Np(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||pe.between(e,n,r)}function ky(t){return t.editable&&!t.hasFocus()?!1:aE(t)}function aE(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function L_(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return ns(e.node,e.offset,n.anchorNode,n.anchorOffset)}function sf(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&ue.findFrom(s,e)}function Di(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function Iy(t,e,n){let r=t.state.selection;if(r instanceof pe){if(!r.empty||n.indexOf("s")>-1)return!1;if(t.endOfTextblock(e>0?"right":"left")){let i=sf(t.state,e);return i&&i instanceof fe?Di(t,i):!1}else if(!(xn&&n.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let a=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=t.docView.descAt(a))&&!o.contentDOM?fe.isSelectable(s)?Di(t,new fe(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):Du?Di(t,new pe(t.state.doc.resolve(e<0?a:a+s.nodeSize))):!1:!1}}else{if(r instanceof fe&&r.node.isInline)return Di(t,new pe(e>0?r.$to:r.$from));{let i=sf(t.state,e);return i?Di(t,i):!1}}}function Bc(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function ca(t){let e=t.pmViewDesc;return e&&e.size==0&&(t.nextSibling||t.nodeName!="BR")}function Jh(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,o=!1;for(Kn&&n.nodeType==1&&r<Bc(n)&&ca(n.childNodes[r])&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let a=n.childNodes[r-1];if(ca(a))i=n,s=--r;else if(a.nodeType==3)n=a,r=n.nodeValue.length;else break}}else{if(lE(n))break;{let a=n.previousSibling;for(;a&&ca(a);)i=n.parentNode,s=un(a),a=a.previousSibling;if(a)n=a,r=Bc(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?of(t,n,r):i&&of(t,i,s)}function Xh(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=Bc(n),s,o;for(;;)if(r<i){if(n.nodeType!=1)break;let a=n.childNodes[r];if(ca(a))s=n,o=++r;else break}else{if(lE(n))break;{let a=n.nextSibling;for(;a&&ca(a);)s=a.parentNode,o=un(a)+1,a=a.nextSibling;if(a)n=a,r=0,i=Bc(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&of(t,s,o)}function lE(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function of(t,e,n){let r=t.domSelection();if(Nu(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Er(t)},50)}function Ay(t,e,n){let r=t.state.selection;if(r instanceof pe&&!r.empty||n.indexOf("s")>-1||xn&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=sf(t.state,e);if(o&&o instanceof fe)return Di(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,a=r instanceof zn?ue.near(o,e):ue.findFrom(o,e);return a?Di(t,a):!1}return!1}function _y(t,e){if(!(t.state.selection instanceof pe))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),t.dispatch(o),!0}return!1}function My(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function B_(t){if(!Wt||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;My(t,r,"true"),setTimeout(()=>My(t,r,"false"),20)}return!1}function F_(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function V_(t,e){let n=e.keyCode,r=F_(e);return n==8||xn&&n==72&&r=="c"?_y(t,-1)||Jh(t):n==46||xn&&n==68&&r=="c"?_y(t,1)||Xh(t):n==13||n==27?!0:n==37||xn&&n==66&&r=="c"?Iy(t,-1,r)||Jh(t):n==39||xn&&n==70&&r=="c"?Iy(t,1,r)||Xh(t):n==38||xn&&n==80&&r=="c"?Ay(t,-1,r)||Jh(t):n==40||xn&&n==78&&r=="c"?B_(t)||Ay(t,1,r)||Xh(t):r==(xn?"m":"c")&&(n==66||n==73||n==89||n==90)}function cE(t,e){t.someProp("transformCopied",f=>{e=f(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let f=r.firstChild;n.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let o=t.someProp("clipboardSerializer")||rr.fromSchema(t.state.schema),a=gE(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,h=0;for(;c&&c.nodeType==1&&(u=pE[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=a.createElement(u[f]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),h++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${h?` -${h}`:""} ${JSON.stringify(n)}`);let d=t.someProp("clipboardTextSerializer",f=>f(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:d}}function uE(t,e,n,r,i){let s=i.parent.type.spec.code,o,a;if(!n&&!e)return null;let l=e&&(r||s||!n);if(l){if(t.someProp("transformPastedText",d=>{e=d(e,s||r,t)}),s)return e?new J(z.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):J.empty;let h=t.someProp("clipboardTextParser",d=>d(e,i,r,t));if(h)a=h;else{let d=i.marks(),{schema:f}=t.state,p=rr.fromSchema(f);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(g=>{let m=o.appendChild(document.createElement("p"));g&&m.appendChild(p.serializeNode(f.text(g,d)))})}}else t.someProp("transformPastedHTML",h=>{n=h(n,t)}),o=z_(n),Du&&H_(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let d=o.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;o=d}if(a||(a=(t.someProp("clipboardParser")||t.someProp("domParser")||io.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!$_.test(d.parentNode.nodeName)?{ignore:!0}:null}})),u)a=j_(Oy(a,+u[1],+u[2]),u[4]);else if(a=J.maxOpen(U_(a.content,i),!0),a.openStart||a.openEnd){let h=0,d=0;for(let f=a.content.firstChild;h<a.openStart&&!f.type.spec.isolating;h++,f=f.firstChild);for(let f=a.content.lastChild;d<a.openEnd&&!f.type.spec.isolating;d++,f=f.lastChild);a=Oy(a,h,d)}return t.someProp("transformPasted",h=>{a=h(a,t)}),a}const $_=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function U_(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),s,o=[];if(t.forEach(a=>{if(!o)return;let l=i.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&s.length&&dE(l,s,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=fE(o[o.length-1],s.length));let u=hE(a,l);o.push(u),i=i.matchType(u.type),s=l}}),o)return z.from(o)}return t}function hE(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,z.from(t));return t}function dE(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=dE(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(z.from(hE(n,t,i+1))))}}function fE(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,fE(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(z.empty,!0);return t.copy(n.append(r))}function af(t,e,n,r,i,s){let o=e<0?t.firstChild:t.lastChild,a=o.content;return i<r-1&&(a=af(a,e,n,r,i+1,s)),i>=n&&(a=e<0?o.contentMatchAt(0).fillBefore(a,t.childCount>1||s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(z.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(a))}function Oy(t,e,n){return e<t.openStart&&(t=new J(af(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new J(af(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const pE={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Ny=null;function gE(){return Ny||(Ny=document.implementation.createHTMLDocument("title"))}function z_(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=gE().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&pE[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=t,i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}function H_(t){let e=t.querySelectorAll(nn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent=="\xA0"&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function j_(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let a=r.length-2;a>=0;a-=2){let l=n.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=z.from(l.create(r[a+1],i)),s++,o++}return new J(i,s,o)}const Gt={},Jt={},K_={touchstart:!0,touchmove:!0};class q_{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function W_(t){for(let e in Gt){let n=Gt[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{J_(t,r)&&!Dp(t,r)&&(t.editable||!(r.type in Jt))&&n(t,r)},K_[e]?{passive:!0}:void 0)}Wt&&t.dom.addEventListener("input",()=>null),lf(t)}function Ur(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function G_(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function lf(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>Dp(t,r))})}function Dp(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function J_(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function X_(t,e){!Dp(t,e)&&Gt[e.type]&&(t.editable||!(e.type in Jt))&&Gt[e.type](t,e)}Jt.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!yE(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(tr&&nn&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),ao&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,Us(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||V_(t,n)?n.preventDefault():Ur(t,"key")};Jt.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};Jt.keypress=(t,e)=>{let n=e;if(yE(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||xn&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof pe)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode);t.someProp("handleTextInput",s=>s(t,r.$from.pos,r.$to.pos,i))||t.dispatch(t.state.tr.insertText(i).scrollIntoView()),n.preventDefault()}};function Pu(t){return{left:t.clientX,top:t.clientY}}function Y_(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function Rp(t,e,n,r,i){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,a=>o>s.depth?a(t,n,s.nodeAfter,s.before(o),i,!0):a(t,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function Zs(t,e,n){t.focused||t.focus();let r=t.state.tr.setSelection(e);n=="pointer"&&r.setMeta("pointer",!0),t.dispatch(r)}function Q_(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&fe.isSelectable(r)?(Zs(t,new fe(n),"pointer"),!0):!1}function Z_(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof fe&&(r=n.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let a=o>s.depth?s.nodeAfter:s.node(o);if(fe.isSelectable(a)){r&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?i=s.before(n.$from.depth):i=s.before(o);break}}return i!=null?(Zs(t,fe.create(t.state.doc,i),"pointer"),!0):!1}function eM(t,e,n,r,i){return Rp(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?Z_(t,n):Q_(t,n))}function tM(t,e,n,r){return Rp(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function nM(t,e,n,r){return Rp(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||rM(t,n,r)}function rM(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Zs(t,pe.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),a=i.before(s);if(o.inlineContent)Zs(t,pe.create(r,a+1,a+1+o.content.size),"pointer");else if(fe.isSelectable(o))Zs(t,fe.create(r,a),"pointer");else continue;return!0}}function Pp(t){return Fc(t)}const mE=xn?"metaKey":"ctrlKey";Gt.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=Pp(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&Y_(n,t.input.lastClick)&&!n[mE]&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s};let o=t.posAtCoords(Pu(n));!o||(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new iM(t,o,n,!!r)):(s=="doubleClick"?tM:nM)(t,o.pos,o.inside,n)?n.preventDefault():Ur(t,"pointer"))};class iM{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[mE],this.allowDefault=r.shiftKey;let s,o;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let u=e.state.doc.resolve(n.pos);s=u.parent,o=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof fe&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Kn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Ur(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Er(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Pu(e))),this.updateAllowDefault(e),this.allowDefault||!n?Ur(this.view,"pointer"):eM(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Wt&&this.mightDrag&&!this.mightDrag.node.isAtom||nn&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Zs(this.view,ue.near(this.view.state.doc.resolve(n.pos)),"pointer"),e.preventDefault()):Ur(this.view,"pointer")}move(e){this.updateAllowDefault(e),Ur(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Gt.touchstart=t=>{t.input.lastTouch=Date.now(),Pp(t),Ur(t,"pointer")};Gt.touchmove=t=>{t.input.lastTouch=Date.now(),Ur(t,"pointer")};Gt.contextmenu=t=>Pp(t);function yE(t,e){return t.composing?!0:Wt&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const sM=tr?5e3:-1;Jt.compositionstart=Jt.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),Fc(t,!0),t.markCursor=null;else if(Fc(t),Kn&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){t.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}bE(t,sM)};Jt.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,bE(t,20))};function bE(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>Fc(t),e))}function wE(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=oM());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function oM(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function Fc(t,e=!1){if(!(tr&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),wE(t),e||t.docView&&t.docView.dirty){let n=Op(t);return n&&!n.eq(t.state.selection)?t.dispatch(t.state.tr.setSelection(n)):t.updateState(t.state),!0}return!1}}function aM(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const lo=rn&&Wr<15||ao&&l_<604;Gt.copy=Jt.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let s=lo?null:n.clipboardData,o=r.content(),{dom:a,text:l}=cE(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):aM(t,a),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function lM(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function cM(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?cf(t,r.value,null,e):cf(t,r.textContent,r.innerHTML,e)},50)}function cf(t,e,n,r){let i=uE(t,e,n,t.input.shiftKey,t.state.selection.$from);if(t.someProp("handlePaste",a=>a(t,r,i||J.empty)))return!0;if(!i)return!1;let s=lM(i),o=s?t.state.tr.replaceSelectionWith(s,t.input.shiftKey):t.state.tr.replaceSelection(i);return t.dispatch(o.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Jt.paste=(t,e)=>{let n=e;if(t.composing&&!tr)return;let r=lo?null:n.clipboardData;r&&cf(t,r.getData("text/plain"),r.getData("text/html"),n)?n.preventDefault():cM(t,n)};class uM{constructor(e,n){this.slice=e,this.move=n}}const vE=xn?"altKey":"ctrlKey";Gt.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(Pu(n));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof fe?i.to-1:i.to))){if(r&&r.mightDrag)t.dispatch(t.state.tr.setSelection(fe.create(t.state.doc,r.mightDrag.pos)));else if(n.target&&n.target.nodeType==1){let c=t.docView.nearestDesc(n.target,!0);c&&c.node.type.spec.draggable&&c!=t.docView&&t.dispatch(t.state.tr.setSelection(fe.create(t.state.doc,c.posBefore)))}}let o=t.state.selection.content(),{dom:a,text:l}=cE(t,o);n.dataTransfer.clearData(),n.dataTransfer.setData(lo?"Text":"text/html",a.innerHTML),n.dataTransfer.effectAllowed="copyMove",lo||n.dataTransfer.setData("text/plain",l),t.dragging=new uM(o,!n[vE])};Gt.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};Jt.dragover=Jt.dragenter=(t,e)=>e.preventDefault();Jt.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(Pu(n));if(!i)return;let s=t.state.doc.resolve(i.pos),o=r&&r.slice;o?t.someProp("transformPasted",p=>{o=p(o,t)}):o=uE(t,n.dataTransfer.getData(lo?"Text":"text/plain"),lo?null:n.dataTransfer.getData("text/html"),!1,s);let a=!!(r&&!n[vE]);if(t.someProp("handleDrop",p=>p(t,n,o||J.empty,a))){n.preventDefault();return}if(!o)return;n.preventDefault();let l=o?F0(t.state.doc,s.pos,o):s.pos;l==null&&(l=s.pos);let c=t.state.tr;a&&c.deleteSelection();let u=c.mapping.map(l),h=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,d=c.doc;if(h?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(d))return;let f=c.doc.resolve(u);if(h&&fe.isSelectable(o.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new fe(f));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((g,m,w,_)=>p=_),c.setSelection(Np(t,f,c.doc.resolve(p)))}t.focus(),t.dispatch(c.setMeta("uiEvent","drop"))};Gt.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Er(t)},20))};Gt.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};Gt.beforeinput=(t,e)=>{if(nn&&tr&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,Us(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in Jt)Gt[t]=Jt[t];function Oa(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class Lp{constructor(e,n){this.toDOM=e,this.spec=n||Wi,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new Ht(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Lp&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Oa(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Gr{constructor(e,n){this.attrs=e,this.spec=n||Wi}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new Ht(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof Gr&&Oa(this.attrs,e.attrs)&&Oa(this.spec,e.spec)}static is(e){return e.type instanceof Gr}destroy(){}}class Bp{constructor(e,n){this.attrs=e,this.spec=n||Wi}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=s.pos?null:new Ht(s.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),s;return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof Bp&&Oa(this.attrs,e.attrs)&&Oa(this.spec,e.spec)}destroy(){}}class Ht{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new Ht(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new Ht(e,e,new Lp(n,r))}static inline(e,n,r,i){return new Ht(e,n,new Gr(r,i))}static node(e,n,r,i){return new Ht(e,n,new Bp(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Gr}}const Ls=[],Wi={};class et{constructor(e,n){this.local=e.length?e:Ls,this.children=n.length?n:Ls}static create(e,n){return n.length?Vc(n,e,0,Wi):At}find(e,n,r){let i=[];return this.findInner(e==null?0:e,n==null?1e9:n,i,0,r),i}findInner(e,n,r,i,s){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=n&&a.to>=e&&(!s||s(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,n-a,r,i+a,s)}}map(e,n,r){return this==At||e.maps.length==0?this:this.mapInner(e,n,0,0,r||Wi)}mapInner(e,n,r,i,s){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(n,l)?(o||(o=[])).push(l):s.onRemove&&s.onRemove(this.local[a].spec)}return this.children.length?hM(this.children,o||[],e,n,r,i,s):o?new et(o.sort(Gi),Ls):At}add(e,n){return n.length?this==At?et.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((a,l)=>{let c=l+r,u;if(!!(u=xE(n,a,c))){for(i||(i=this.children.slice());s<i.length&&i[s]<l;)s+=3;i[s]==l?i[s+2]=i[s+2].addInner(a,u,c+1):i.splice(s,0,l,l+a.nodeSize,Vc(u,a,c+1,Wi)),s+=3}});let o=EE(s?SE(n):n,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new et(o.length?this.local.concat(o).sort(Gi):this.local,i||this.children)}remove(e){return e.length==0||this==At?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,a=r[s]+n,l=r[s+1]+n;for(let u=0,h;u<e.length;u++)(h=e[u])&&h.from>a&&h.to<l&&(e[u]=null,(o||(o=[])).push(h));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,a+1);c!=At?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let a=0;a<i.length;a++)i[a].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new et(i,r):At}forChild(e,n){if(this==At)return this;if(n.isLeaf)return et.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let s=e+1,o=s+n.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>s&&l.type instanceof Gr){let c=Math.max(s,l.from)-s,u=Math.min(o,l.to)-s;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new et(i.sort(Gi),Ls);return r?new Pr([a,r]):a}return r||At}eq(e){if(this==e)return!0;if(!(e instanceof et)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return Fp(this.localsInner(e))}localsInner(e){if(this==At)return Ls;if(e.inlineContent||!this.local.some(Gr.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Gr||n.push(this.local[r]);return n}}et.empty=new et([],[]);et.removeOverlap=Fp;const At=et.empty;class Pr{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,Wi));return Pr.from(r)}forChild(e,n){if(n.isLeaf)return et.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=At&&(s instanceof Pr?r=r.concat(s.members):r.push(s))}return Pr.from(r)}eq(e){if(!(e instanceof Pr)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(!!s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let o=0;o<s.length;o++)n.push(s[o])}}return n?Fp(r?n:n.sort(Gi)):Ls}static from(e){switch(e.length){case 0:return At;case 1:return e[0];default:return new Pr(e)}}}function hM(t,e,n,r,i,s,o){let a=t.slice();for(let c=0,u=s;c<n.maps.length;c++){let h=0;n.maps[c].forEach((d,f,p,g)=>{let m=g-p-(f-d);for(let w=0;w<a.length;w+=3){let _=a[w+1];if(_<0||d>_+u-h)continue;let M=a[w]+u-h;f>=M?a[w+1]=d<=M?-2:-1:p>=i&&m&&(a[w]+=m,a[w+1]+=m)}h+=m}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=n.map(t[c]+s),h=u-i;if(h<0||h>=r.content.size){l=!0;continue}let d=n.map(t[c+1]+s,-1),f=d-i,{index:p,offset:g}=r.content.findIndex(h),m=r.maybeChild(p);if(m&&g==h&&g+m.nodeSize==f){let w=a[c+2].mapInner(n,m,u+1,t[c]+s+1,o);w!=At?(a[c]=h,a[c+1]=f,a[c+2]=w):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=dM(a,t,e,n,i,s,o),u=Vc(c,r,0,o);e=u.local;for(let h=0;h<a.length;h+=3)a[h+1]<0&&(a.splice(h,3),h-=3);for(let h=0,d=0;h<u.children.length;h+=3){let f=u.children[h];for(;d<a.length&&a[d]<f;)d+=3;a.splice(d,0,u.children[h],u.children[h+1],u.children[h+2])}}return new et(e.sort(Gi),a)}function EE(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new Ht(i.from+e,i.to+e,i.type))}return n}function dM(t,e,n,r,i,s,o){function a(l,c){for(let u=0;u<l.local.length;u++){let h=l.local[u].map(r,i,c);h?n.push(h):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<t.length;l+=3)t[l+1]==-1&&a(t[l+2],e[l]+s+1);return n}function xE(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[s]=null);return i}function SE(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function Vc(t,e,n,r){let i=[],s=!1;e.forEach((a,l)=>{let c=xE(t,a,l+n);if(c){s=!0;let u=Vc(c,a,n+l+1,r);u!=At&&i.push(l,l+a.nodeSize,u)}});let o=EE(s?SE(t):t,-n).sort(Gi);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new et(o,i):At}function Gi(t,e){return t.from-e.from||t.to-e.to}function Fp(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),Dy(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),Dy(e,i,r.copy(s.from,r.to)));break}}}return e}function Dy(t,e,n){for(;e<t.length&&Gi(n,t[e])>0;)e++;t.splice(e,0,n)}function Yh(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=At&&e.push(r)}),t.cursorWrapper&&e.push(et.create(t.state.doc,[t.cursorWrapper.deco])),Pr.from(e)}const fM={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},pM=rn&&Wr<=11;class gM{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class mM{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new gM,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);rn&&Wr<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),pM&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,fM)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(!!ky(this.view)){if(this.suppressingSelectionUpdates)return Er(this.view);if(rn&&Wr<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ns(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=Ma(s))n.add(s);for(let s=e.anchorNode;s;s=Ma(s))if(n.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.observer?this.observer.takeRecords():[];this.queue.length&&(n=this.queue.concat(n),this.queue.length=0);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&ky(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<n.length;u++){let h=this.registerMutation(n[u],l);h&&(s=s<0?h.from:Math.min(h.from,s),o=o<0?h.to:Math.max(h.to,o),h.typeOver&&(a=!0))}if(Kn&&l.length>1){let u=l.filter(h=>h.nodeName=="BR");if(u.length==2){let h=u[0],d=u[1];h.parentNode&&h.parentNode.parentNode==d.parentNode?d.remove():h.remove()}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&e.input.lastTouch<Date.now()-300&&Nu(r)&&(c=Op(e))&&c.eq(ue.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Er(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),yM(e)),this.handleDOMChange(s,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Er(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++)n.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(rn&&Wr<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:h,nextSibling:d}=e.addedNodes[u];(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(s=d)}let o=i&&i.parentNode==e.target?un(i)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=s&&s.parentNode==e.target?un(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let Ry=new WeakMap,Py=!1;function yM(t){if(!Ry.has(t)&&(Ry.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=Kn,Py)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Py=!0}}function bM(t){let e;function n(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}t.dom.addEventListener("beforeinput",n,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",n,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=t.domAtPos(t.state.selection.anchor);return ns(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function wM(t,e,n){let{node:r,fromOffset:i,toOffset:s,from:o,to:a}=t.docView.parseRange(e,n),l=t.domSelectionRange(),c,u=l.anchorNode;if(u&&t.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],Nu(l)||c.push({node:l.focusNode,offset:l.focusOffset})),nn&&t.input.lastKeyCode===8)for(let m=s;m>i;m--){let w=r.childNodes[m-1],_=w.pmViewDesc;if(w.nodeName=="BR"&&!_){s=m;break}if(!_||_.size)break}let h=t.state.doc,d=t.someProp("domParser")||io.fromSchema(t.state.schema),f=h.resolve(o),p=null,g=d.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:s,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:vM,context:f});if(c&&c[0].pos!=null){let m=c[0].pos,w=c[1]&&c[1].pos;w==null&&(w=m),p={anchor:m+o,head:w+o}}return{doc:g,sel:p,from:o,to:a}}function vM(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(Wt&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||Wt&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}function EM(t,e,n,r,i){if(e<0){let N=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,G=Op(t,N);if(G&&!t.state.selection.eq(G)){let ie=t.state.tr.setSelection(G);N=="pointer"?ie.setMeta("pointer",!0):N=="key"&&ie.scrollIntoView(),t.dispatch(ie)}return}let s=t.state.doc.resolve(e),o=s.sharedDepth(n);e=s.before(o+1),n=t.state.doc.resolve(n).after(o+1);let a=t.state.selection,l=wM(t,e,n),c=t.state.doc,u=c.slice(l.from,l.to),h,d;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(h=t.state.selection.to,d="end"):(h=t.state.selection.from,d="start"),t.input.lastKeyCode=null;let f=TM(u.content,l.doc.content,l.from,h,d);if((ao&&t.input.lastIOSEnter>Date.now()-225||tr)&&i.some(N=>N.nodeName=="DIV"||N.nodeName=="P"||N.nodeName=="LI")&&(!f||f.endA>=f.endB)&&t.someProp("handleKeyDown",N=>N(t,Us(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!f)if(r&&a instanceof pe&&!a.empty&&a.$head.sameParent(a.$anchor)&&!t.composing&&!(l.sel&&l.sel.anchor!=l.sel.head))f={start:a.from,endA:a.to,endB:a.to};else{if(l.sel){let N=Ly(t,t.state.doc,l.sel);N&&!N.eq(t.state.selection)&&t.dispatch(t.state.tr.setSelection(N))}return}if(nn&&t.cursorWrapper&&l.sel&&l.sel.anchor==t.cursorWrapper.deco.from&&l.sel.head==l.sel.anchor){let N=f.endB-f.start;l.sel={anchor:l.sel.anchor+N,head:l.sel.anchor+N}}t.input.domChangeCount++,t.state.selection.from<t.state.selection.to&&f.start==f.endB&&t.state.selection instanceof pe&&(f.start>t.state.selection.from&&f.start<=t.state.selection.from+2&&t.state.selection.from>=l.from?f.start=t.state.selection.from:f.endA<t.state.selection.to&&f.endA>=t.state.selection.to-2&&t.state.selection.to<=l.to&&(f.endB+=t.state.selection.to-f.endA,f.endA=t.state.selection.to)),rn&&Wr<=11&&f.endB==f.start+1&&f.endA==f.start&&f.start>l.from&&l.doc.textBetween(f.start-l.from-1,f.start-l.from+1)==" \xA0"&&(f.start--,f.endA--,f.endB--);let p=l.doc.resolveNoCache(f.start-l.from),g=l.doc.resolveNoCache(f.endB-l.from),m=c.resolve(f.start),w=p.sameParent(g)&&p.parent.inlineContent&&m.end()>=f.endA,_;if((ao&&t.input.lastIOSEnter>Date.now()-225&&(!w||i.some(N=>N.nodeName=="DIV"||N.nodeName=="P"))||!w&&p.pos<l.doc.content.size&&(_=ue.findFrom(l.doc.resolve(p.pos+1),1,!0))&&_.head==g.pos)&&t.someProp("handleKeyDown",N=>N(t,Us(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>f.start&&SM(c,f.start,f.endA,p,g)&&t.someProp("handleKeyDown",N=>N(t,Us(8,"Backspace")))){tr&&nn&&t.domObserver.suppressSelectionUpdates();return}nn&&tr&&f.endB==f.start&&(t.input.lastAndroidDelete=Date.now()),tr&&!w&&p.start()!=g.start()&&g.parentOffset==0&&p.depth==g.depth&&l.sel&&l.sel.anchor==l.sel.head&&l.sel.head==f.endA&&(f.endB-=2,g=l.doc.resolveNoCache(f.endB-l.from),setTimeout(()=>{t.someProp("handleKeyDown",function(N){return N(t,Us(13,"Enter"))})},20));let M=f.start,y=f.endA,L,R,j;if(w){if(p.pos==g.pos)rn&&Wr<=11&&p.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Er(t),20)),L=t.state.tr.delete(M,y),R=c.resolve(f.start).marksAcross(c.resolve(f.endA));else if(f.endA==f.endB&&(j=xM(p.parent.content.cut(p.parentOffset,g.parentOffset),m.parent.content.cut(m.parentOffset,f.endA-m.start()))))L=t.state.tr,j.type=="add"?L.addMark(M,y,j.mark):L.removeMark(M,y,j.mark);else if(p.parent.child(p.index()).isText&&p.index()==g.index()-(g.textOffset?0:1)){let N=p.parent.textBetween(p.parentOffset,g.parentOffset);if(t.someProp("handleTextInput",G=>G(t,M,y,N)))return;L=t.state.tr.insertText(N,M,y)}}if(L||(L=t.state.tr.replace(M,y,l.doc.slice(f.start-l.from,f.endB-l.from))),l.sel){let N=Ly(t,L.doc,l.sel);N&&!(nn&&tr&&t.composing&&N.empty&&(f.start!=f.endB||t.input.lastAndroidDelete<Date.now()-100)&&(N.head==M||N.head==L.mapping.map(y)-1)||rn&&N.empty&&N.head==M)&&L.setSelection(N)}R&&L.ensureMarks(R),t.dispatch(L.scrollIntoView())}function Ly(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:Np(t,e.resolve(n.anchor),e.resolve(n.head))}function xM(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,s=r,o,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<n.length;u++)s=n[u].removeFromSet(s);if(i.length==1&&s.length==0)a=i[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&s.length==1)a=s[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(z.from(c).eq(t))return{mark:a,type:o}}function SM(t,e,n,r,i){if(!r.parent.isTextblock||n-e<=i.pos-r.pos||Qh(r,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(Qh(s,!0,!0));return!o.parent.isTextblock||o.pos>n||Qh(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Qh(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function TM(t,e,n,r,i){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:o,b:a}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let l=Math.max(0,s-Math.min(o,a));r-=o+l-s}return o<s&&t.size<e.size?(s-=r<=s&&r>=o?s-r:0,a=s+(a-o),o=s):a<s&&(s-=r<=s&&r>=a?s-r:0,o=s+(o-a),a=s),{start:s,endA:o,endB:a}}class CM{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new q_,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Uy),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Vy(this),Fy(this),this.nodeViews=$y(this),this.docView=vy(this.state.doc,By(this),Yh(this),this.dom,this),this.domObserver=new mM(this,(r,i,s,o)=>EM(this,r,i,s,o)),this.domObserver.start(),W_(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&lf(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Uy),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){let r=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(wE(this),s=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=n.plugins;if(o||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let d=$y(this);IM(d,this.nodeViews)&&(this.nodeViews=d,i=!0)}(o||n.handleDOMEvents!=this._props.handleDOMEvents)&&lf(this),this.editable=Vy(this),Fy(this);let a=Yh(this),l=By(this),c=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=i||!this.docView.matchesNode(e.doc,l,a);(u||!e.selection.eq(r.selection))&&(s=!0);let h=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&h_(this);if(s){this.domObserver.stop();let d=u&&(rn||nn)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&kM(r.selection,e.selection);if(u){let f=nn?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(e.doc,l,a,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=vy(e.doc,l,a,this.dom,this)),f&&!this.trackWrites&&(d=!0)}d||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&L_(this))?Er(this,d):(oE(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():h&&d_(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof fe){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&gy(this,n.getBoundingClientRect(),e)}else gy(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(i=n?n(a):a))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let a=s[o].props[e];if(a!=null&&(i=n?n(a):a))return i}}hasFocus(){if(rn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&f_(this.dom),Er(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}posAtCoords(e){return b_(this,e)}coordsAtPos(e,n=1){return Q0(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return S_(this,n||this.state,e)}destroy(){!this.docView||(G_(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Yh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return X_(this,e)}dispatch(e){let n=this._props.dispatchTransaction;n?n.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Wt&&this.root.nodeType===11&&o_(this.dom.ownerDocument)==this.dom?bM(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function By(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),e.translate="no",t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"&&(e.class+=" "+n[r]),r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),[Ht.node(0,t.state.doc.content.size,e)]}function Fy(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:Ht.widget(t.state.selection.head,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Vy(t){return!t.someProp("editable",e=>e(t.state)===!1)}function kM(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function $y(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function IM(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function Uy(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var ii={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},$c={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},zy=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);var AM=typeof navigator<"u"&&/Mac/.test(navigator.platform),_M=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),MM=AM||zy&&+zy[1]<57;for(var Et=0;Et<10;Et++)ii[48+Et]=ii[96+Et]=String(Et);for(var Et=1;Et<=24;Et++)ii[Et+111]="F"+Et;for(var Et=65;Et<=90;Et++)ii[Et]=String.fromCharCode(Et+32),$c[Et]=String.fromCharCode(Et);for(var Zh in ii)$c.hasOwnProperty(Zh)||($c[Zh]=ii[Zh]);function OM(t){var e=MM&&(t.ctrlKey||t.altKey||t.metaKey)||_M&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?$c:ii)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const NM=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function DM(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,s,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))NM?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function RM(t){let e=Object.create(null);for(let n in t)e[DM(n)]=t[n];return e}function ed(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}function PM(t){return new Tt({props:{handleKeyDown:Vp(t)}})}function Vp(t){let e=RM(t);return function(n,r){let i=OM(r),s=i.length==1&&i!=" ",o,a=e[ed(i,r,!s)];if(a&&a(n.state,n.dispatch,n))return!0;if(s&&(r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=ii[r.keyCode])&&o!=i){let l=e[ed(o,r,!0)];if(l&&l(n.state,n.dispatch,n))return!0}else if(s&&r.shiftKey){let l=e[ed(i,r,!0)];if(l&&l(n.state,n.dispatch,n))return!0}return!1}}const LM=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0),BM=(t,e,n)=>{let{$cursor:r}=t.selection;if(!r||(n?!n.endOfTextblock("backward",t):r.parentOffset>0))return!1;let i=TE(r);if(!i){let o=r.blockRange(),a=o&&_o(o);return a==null?!1:(e&&e(t.tr.lift(o,a).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&IE(t,i,e))return!0;if(r.parent.content.size==0&&(co(s,"end")||fe.isSelectable(s))){let o=Ap(t.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=t.tr.step(o);a.setSelection(co(s,"end")?ue.findFrom(a.doc.resolve(a.mapping.map(i.pos,-1)),-1):fe.create(a.doc,i.pos-s.nodeSize)),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function co(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const FM=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=TE(r)}let o=s&&s.nodeBefore;return!o||!fe.isSelectable(o)?!1:(e&&e(t.tr.setSelection(fe.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function TE(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}const VM=(t,e,n)=>{let{$cursor:r}=t.selection;if(!r||(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size))return!1;let i=CE(r);if(!i)return!1;let s=i.nodeAfter;if(IE(t,i,e))return!0;if(r.parent.content.size==0&&(co(s,"start")||fe.isSelectable(s))){let o=Ap(t.doc,r.before(),r.after(),J.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=t.tr.step(o);a.setSelection(co(s,"start")?ue.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):fe.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},$M=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=CE(r)}let o=s&&s.nodeAfter;return!o||!fe.isSelectable(o)?!1:(e&&e(t.tr.setSelection(fe.create(t.doc,s.pos)).scrollIntoView()),!0)};function CE(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const UM=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&_o(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},zM=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function kE(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const HM=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=kE(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let a=n.after(),l=t.tr.replaceWith(a,a,o.createAndFill());l.setSelection(ue.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},jM=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof zn||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=kE(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=t.tr.insert(o,s.createAndFill());a.setSelection(pe.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},KM=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(Ys(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&_o(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)},qM=(t,e)=>{let{$from:n,to:r}=t.selection,i,s=n.sharedDepth(r);return s==0?!1:(i=n.before(s),e&&e(t.tr.setSelection(fe.create(t.doc,i))),!0)};function WM(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Mo(t.doc,e.pos))?!1:(n&&n(t.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function IE(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s,o;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(WM(t,e,n))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(n){let h=e.pos+i.nodeSize,d=z.empty;for(let g=s.length-1;g>=0;g--)d=z.from(s[g].create(null,d));d=z.from(r.copy(d));let f=t.tr.step(new ut(e.pos-1,h,e.pos,h,new J(d,1,0),s.length,!0)),p=h+2*s.length;Mo(f.doc,p)&&f.join(p),n(f.scrollIntoView())}return!0}let l=ue.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&_o(c);if(u!=null&&u>=e.depth)return n&&n(t.tr.lift(c,u).scrollIntoView()),!0;if(a&&co(i,"start",!0)&&co(r,"end")){let h=r,d=[];for(;d.push(h),!h.isTextblock;)h=h.lastChild;let f=i,p=1;for(;!f.isTextblock;f=f.firstChild)p++;if(h.canReplace(h.childCount,h.childCount,f.content)){if(n){let g=z.empty;for(let w=d.length-1;w>=0;w--)g=z.from(d[w].copy(g));let m=t.tr.step(new ut(e.pos-d.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new J(g,d.length,0),0,!0));n(m.scrollIntoView())}return!0}}return!1}function AE(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(n&&n(e.tr.setSelection(pe.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const GM=AE(-1),JM=AE(1);function XM(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),a=o&&Ip(o,t,e);return a?(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0):!1}}function Hy(t,e=null){return function(n,r){let{from:i,to:s}=n.selection,o=!1;return n.doc.nodesBetween(i,s,(a,l)=>{if(o)return!1;if(!(!a.isTextblock||a.hasMarkup(t,e)))if(a.type==t)o=!0;else{let c=n.doc.resolve(l),u=c.index();o=c.parent.canReplaceWith(u,u+1,t)}}),o?(r&&r(n.tr.setBlockType(i,s,t,e).scrollIntoView()),!0):!1}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function YM(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(t)&&o.startIndex==0){if(i.index(o.depth-1)==0)return!1;let u=n.doc.resolve(o.start-2);l=new Nc(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new Nc(i,n.doc.resolve(s.end(o.depth)),o.depth)),a=!0}let c=Ip(l,t,e,o);return c?(r&&r(QM(n.tr,o,c,a,t).scrollIntoView()),!0):!1}}function QM(t,e,n,r,i){let s=z.empty;for(let u=n.length-1;u>=0;u--)s=z.from(n[u].type.create(n[u].attrs,s));t.step(new ut(e.start-(r?2:0),e.end,e.start,e.end,new J(s,0,0),n.length,!0));let o=0;for(let u=0;u<n.length;u++)n[u].type==i&&(o=u+1);let a=n.length-o,l=e.start+n.length-(r?2:0),c=e.parent;for(let u=e.startIndex,h=e.endIndex,d=!0;u<h;u++,d=!1)!d&&Ys(t.doc,l,a)&&(t.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return t}function ZM(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?eO(e,n,t,s):tO(e,n,s):!0:!1}}function eO(t,e,n,r){let i=t.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new ut(s-1,o,s,o,new J(z.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new Nc(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=_o(r);if(a==null)return!1;i.lift(r,a);let l=i.mapping.map(s,-1)-1;return Mo(i.doc,l)&&i.join(l),e(i.scrollIntoView()),!0}function tO(t,e,n){let r=t.tr,i=n.parent;for(let f=n.end,p=n.endIndex-1,g=n.startIndex;p>g;p--)f-=i.child(p).nodeSize,r.delete(f-1,f+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=n.startIndex==0,l=n.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?z.empty:z.from(i))))return!1;let h=s.pos,d=h+o.nodeSize;return r.step(new ut(h-(a?1:0),d+(l?1:0),h+1,d-1,new J((a?z.empty:z.from(i.copy(z.empty))).append(l?z.empty:z.from(i.copy(z.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function nO(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let a=s.parent,l=a.child(o-1);if(l.type!=t)return!1;if(n){let c=l.lastChild&&l.lastChild.type==a.type,u=z.from(c?t.create():null),h=new J(z.from(t.create(null,z.from(a.type.create(null,u)))),c?3:1,0),d=s.start,f=s.end;n(e.tr.step(new ut(d-(c?3:1),f,d,f,h,1,!0)).scrollIntoView())}return!0}}function Lu(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}class Bu{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const h=l(...u)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),h}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,a=[],l=!!e,c=e||s.tr,u=()=>(!l&&n&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(d=>d===!0)),h={...Object.fromEntries(Object.entries(r).map(([d,f])=>[d,(...g)=>{const m=this.buildProps(c,n),w=f(...g)(m);return a.push(w),h}])),run:u};return h}createCan(e){const{rawCommands:n,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(n).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i;s.storedMarks&&e.setStoredMarks(s.storedMarks);const a={tr:e,editor:i,view:o,state:Lu({state:s,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class rO{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function re(t,e,n){return t.config[e]===void 0&&t.parent?re(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?re(t.parent,e,n):null}):t.config[e]}function Fu(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function _E(t){const e=[],{nodeExtensions:n,markExtensions:r}=Fu(t),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=re(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(h=>{Object.entries(u.attributes).forEach(([d,f])=>{e.push({type:h,name:d,attribute:{...s,...f}})})})})}),i.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=re(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,h])=>{const d={...s,...h};(h==null?void 0:h.isRequired)&&(h==null?void 0:h.default)===void 0&&delete d.default,e.push({type:o.name,name:u,attribute:d})})}),e}function dt(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function nt(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}i==="class"?r[i]=[r[i],s].join(" "):i==="style"?r[i]=[r[i],s].join("; "):r[i]=s}),r},{})}function uf(t,e){return e.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>nt(n,r),{})}function ME(t){return typeof t=="function"}function Se(t,e=void 0,...n){return ME(t)?e?t.bind(e)(...n):t(...n):t}function iO(t={}){return Object.keys(t).length===0&&t.constructor===Object}function sO(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function jy(t,e){return t.style?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):sO(n.getAttribute(o.name));return a==null?s:{...s,[o.name]:a}},{});return{...r,...i}}}}function Ky(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&iO(n)?!1:n!=null))}function oO(t){var e;const n=_E(t),{nodeExtensions:r,markExtensions:i}=Fu(t),s=(e=r.find(l=>re(l,"topNode")))===null||e===void 0?void 0:e.name,o=Object.fromEntries(r.map(l=>{const c=n.filter(m=>m.type===l.name),u={name:l.name,options:l.options,storage:l.storage},h=t.reduce((m,w)=>{const _=re(w,"extendNodeSchema",u);return{...m,..._?_(l):{}}},{}),d=Ky({...h,content:Se(re(l,"content",u)),marks:Se(re(l,"marks",u)),group:Se(re(l,"group",u)),inline:Se(re(l,"inline",u)),atom:Se(re(l,"atom",u)),selectable:Se(re(l,"selectable",u)),draggable:Se(re(l,"draggable",u)),code:Se(re(l,"code",u)),defining:Se(re(l,"defining",u)),isolating:Se(re(l,"isolating",u)),attrs:Object.fromEntries(c.map(m=>{var w;return[m.name,{default:(w=m==null?void 0:m.attribute)===null||w===void 0?void 0:w.default}]}))}),f=Se(re(l,"parseHTML",u));f&&(d.parseDOM=f.map(m=>jy(m,c)));const p=re(l,"renderHTML",u);p&&(d.toDOM=m=>p({node:m,HTMLAttributes:uf(m,c)}));const g=re(l,"renderText",u);return g&&(d.toText=g),[l.name,d]})),a=Object.fromEntries(i.map(l=>{const c=n.filter(g=>g.type===l.name),u={name:l.name,options:l.options,storage:l.storage},h=t.reduce((g,m)=>{const w=re(m,"extendMarkSchema",u);return{...g,...w?w(l):{}}},{}),d=Ky({...h,inclusive:Se(re(l,"inclusive",u)),excludes:Se(re(l,"excludes",u)),group:Se(re(l,"group",u)),spanning:Se(re(l,"spanning",u)),code:Se(re(l,"code",u)),attrs:Object.fromEntries(c.map(g=>{var m;return[g.name,{default:(m=g==null?void 0:g.attribute)===null||m===void 0?void 0:m.default}]}))}),f=Se(re(l,"parseHTML",u));f&&(d.parseDOM=f.map(g=>jy(g,c)));const p=re(l,"renderHTML",u);return p&&(d.toDOM=g=>p({mark:g,HTMLAttributes:uf(g,c)})),[l.name,d]}));return new TA({topNode:s,nodes:o,marks:a})}function td(t,e){return e.nodes[t]||e.marks[t]||null}function qy(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}const aO=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,a)=>{var l,c;n+=(((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:s,parent:o,index:a}))||i.textContent||"%leaf%").slice(0,Math.max(0,r-s))}),n};function $p(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Vu{constructor(e){this.find=e.find,this.handler=e.handler}}const lO=(t,e)=>{if($p(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[];return r.push(n.text),r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function nd(t){var e;const{editor:n,from:r,to:i,text:s,rules:o,plugin:a}=t,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!!(!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(d=>d.type.spec.code)))return!1;let u=!1;const h=aO(c)+s;return o.forEach(d=>{if(u)return;const f=lO(h,d.find);if(!f)return;const p=l.state.tr,g=Lu({state:l.state,transaction:p}),m={from:r-(f[0].length-s.length),to:i},{commands:w,chain:_,can:M}=new Bu({editor:n,state:g});d.handler({state:g,range:m,match:f,commands:w,chain:_,can:M})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:i,text:s}),l.dispatch(p),u=!0)}),u}function cO(t){const{editor:e,rules:n}=t,r=new Tt({state:{init(){return null},apply(i,s){const o=i.getMeta(r);return o||(i.selectionSet||i.docChanged?null:s)}},props:{handleTextInput(i,s,o,a){return nd({editor:e,from:s,to:o,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&nd({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?nd({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function uO(t){return typeof t=="number"}class hO{constructor(e){this.find=e.find,this.handler=e.handler}}const dO=(t,e)=>{if($p(e))return[...t.matchAll(e)];const n=e(t);return n?n.map(r=>{const i=[];return i.push(r.text),i.index=r.index,i.input=t,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function fO(t){const{editor:e,state:n,from:r,to:i,rule:s}=t,{commands:o,chain:a,can:l}=new Bu({editor:e,state:n}),c=[];return n.doc.nodesBetween(r,i,(h,d)=>{if(!h.isTextblock||h.type.spec.code)return;const f=Math.max(r,d),p=Math.min(i,d+h.content.size),g=h.textBetween(f-d,p-d,void 0,"\uFFFC");dO(g,s.find).forEach(w=>{if(w.index===void 0)return;const _=f+w.index+1,M=_+w[0].length,y={from:n.tr.mapping.map(_),to:n.tr.mapping.map(M)},L=s.handler({state:n,range:y,match:w,commands:o,chain:a,can:l});c.push(L)})}),c.every(h=>h!==null)}function pO(t){const{editor:e,rules:n}=t;let r=null,i=!1,s=!1;return n.map(a=>new Tt({view(l){const c=u=>{var h;r=!((h=l.dom.parentElement)===null||h===void 0)&&h.contains(u.target)?l.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:l=>(s=r===l.dom.parentElement,!1),paste:(l,c)=>{var u;const h=(u=c.clipboardData)===null||u===void 0?void 0:u.getData("text/html");return i=!!(h!=null&&h.includes("data-pm-slice")),!1}}},appendTransaction:(l,c,u)=>{const h=l[0],d=h.getMeta("uiEvent")==="paste"&&!i,f=h.getMeta("uiEvent")==="drop"&&!s;if(!d&&!f)return;const p=c.doc.content.findDiffStart(u.doc.content),g=c.doc.content.findDiffEnd(u.doc.content);if(!uO(p)||!g||p===g.b)return;const m=u.tr,w=Lu({state:u,transaction:m});if(!(!fO({editor:e,state:w,from:Math.max(p-1,0),to:g.b-1,rule:a})||!m.steps.length))return m}}))}function gO(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return[...new Set(e)]}class Hs{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=Hs.resolve(e),this.schema=oO(this.extensions),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const s={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:td(r.name,this.schema)};r.type==="mark"&&((i=Se(re(r,"keepOnSplit",s)))!==null&&i!==void 0?i:!0)&&this.splittableMarks.push(r.name);const o=re(r,"onBeforeCreate",s);o&&this.editor.on("beforeCreate",o);const a=re(r,"onCreate",s);a&&this.editor.on("create",a);const l=re(r,"onUpdate",s);l&&this.editor.on("update",l);const c=re(r,"onSelectionUpdate",s);c&&this.editor.on("selectionUpdate",c);const u=re(r,"onTransaction",s);u&&this.editor.on("transaction",u);const h=re(r,"onFocus",s);h&&this.editor.on("focus",h);const d=re(r,"onBlur",s);d&&this.editor.on("blur",d);const f=re(r,"onDestroy",s);f&&this.editor.on("destroy",f)})}static resolve(e){const n=Hs.sort(Hs.flatten(e)),r=gO(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=re(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=re(r,"priority")||100,o=re(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:td(n.name,this.schema)},i=re(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=Hs.sort([...this.extensions].reverse()),r=[],i=[],s=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:td(o.name,this.schema)},l=[],c=re(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&o.config.exitable&&(u.ArrowRight=()=>si.handleExit({editor:e,mark:o})),c){const g=Object.fromEntries(Object.entries(c()).map(([m,w])=>[m,()=>w({editor:e})]));u={...u,...g}}const h=PM(u);l.push(h);const d=re(o,"addInputRules",a);qy(o,e.options.enableInputRules)&&d&&r.push(...d());const f=re(o,"addPasteRules",a);qy(o,e.options.enablePasteRules)&&f&&i.push(...f());const p=re(o,"addProseMirrorPlugins",a);if(p){const g=p();l.push(...g)}return l}).flat();return[cO({editor:e,rules:r}),...pO({editor:e,rules:i}),...s]}get attributes(){return _E(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Fu(this.extensions);return Object.fromEntries(n.filter(r=>!!re(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:dt(r.name,this.schema)},o=re(r,"addNodeView",s);if(!o)return[];const a=(l,c,u,h)=>{const d=uf(l,i);return o()({editor:e,node:l,getPos:u,decorations:h,HTMLAttributes:d,extension:r})};return[r.name,a]}))}}function mO(t){return Object.prototype.toString.call(t).slice(8,-1)}function rd(t){return mO(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function $u(t,e){const n={...t};return rd(t)&&rd(e)&&Object.keys(e).forEach(r=>{rd(e[r])?r in t?n[r]=$u(t[r],e[r]):Object.assign(n,{[r]:e[r]}):Object.assign(n,{[r]:e[r]})}),n}class Xt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Se(re(this,"addOptions",{name:this.name}))),this.storage=Se(re(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Xt(e)}configure(e={}){const n=this.extend();return n.options=$u(this.options,e),n.storage=Se(re(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new Xt(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Se(re(n,"addOptions",{name:n.name})),n.storage=Se(re(n,"addStorage",{name:n.name,options:n.options})),n}}function OE(t,e,n){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=n||{};let a="",l=!0;return t.nodesBetween(r,i,(c,u,h,d)=>{var f;const p=o==null?void 0:o[c.type.name];p?(c.isBlock&&!l&&(a+=s,l=!0),h&&(a+=p({node:c,pos:u,parent:h,index:d,range:e}))):c.isText?(a+=(f=c==null?void 0:c.text)===null||f===void 0?void 0:f.slice(Math.max(r,u)-u,i-u),l=!1):c.isBlock&&!l&&(a+=s,l=!0)}),a}function NE(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const yO=Xt.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new Tt({key:new ln("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(u=>u.$from.pos)),a=Math.max(...s.map(u=>u.$to.pos)),l=NE(n);return OE(r,{from:o,to:a},{textSerializers:l})}}})]}}),bO=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),wO=(t=!1)=>({commands:e})=>e.setContent("",t),vO=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:s,$to:o})=>{t.doc.nodesBetween(s.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,h=c.resolve(u.map(l)),d=c.resolve(u.map(l+a.nodeSize)),f=h.blockRange(d);if(!f)return;const p=_o(f);if(a.type.isTextblock){const{defaultType:g}=h.parent.contentMatchAt(h.index());e.setNodeMarkup(f.start,g)}(p||p===0)&&e.lift(f,p)})}),!0},EO=t=>e=>t(e),xO=()=>({state:t,dispatch:e})=>jM(t,e),SO=t=>({tr:e,state:n,dispatch:r})=>{const i=dt(t,n.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const l=s.before(o),c=s.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},TO=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},CO=()=>({state:t,dispatch:e})=>LM(t,e),kO=()=>({commands:t})=>t.keyboardShortcut("Enter"),IO=()=>({state:t,dispatch:e})=>HM(t,e);function Uc(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:$p(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function hf(t,e,n={}){return t.find(r=>r.type===e&&Uc(r.attrs,n))}function AO(t,e,n={}){return!!hf(t,e,n)}function Up(t,e,n={}){if(!t||!e)return;let r=t.parent.childAfter(t.parentOffset);if(t.parentOffset===r.offset&&r.offset!==0&&(r=t.parent.childBefore(t.parentOffset)),!r.node)return;const i=hf([...r.node.marks],e,n);if(!i)return;let s=r.index,o=t.start()+r.offset,a=s+1,l=o+r.node.nodeSize;for(hf([...r.node.marks],e,n);s>0&&i.isInSet(t.parent.child(s-1).marks);)s-=1,o-=t.parent.child(s).nodeSize;for(;a<t.parent.childCount&&AO([...t.parent.child(a).marks],e,n);)l+=t.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function ui(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const _O=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const s=ui(t,r.schema),{doc:o,selection:a}=n,{$from:l,from:c,to:u}=a;if(i){const h=Up(l,s,e);if(h&&h.from<=c&&h.to>=u){const d=pe.create(o,h.from,h.to);n.setSelection(d)}}return!0},MO=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function zp(t){return t instanceof pe}function br(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function DE(t,e=null){if(!e)return null;const n=ue.atStart(t),r=ue.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,s=r.to;return e==="all"?pe.create(t,br(0,i,s),br(t.content.size,i,s)):pe.create(t,br(e,i,s),br(e,i,s))}function Hp(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const OO=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{Hp()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!zp(n.state.selection))return o(),!0;const a=DE(i.doc,t)||n.state.selection,l=n.state.selection.eq(a);return s&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},NO=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),DO=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e);function Wy(t){const e=`<body>${t}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function zc(t,e,n){if(n={slice:!0,parseOptions:{},...n},typeof t=="object"&&t!==null)try{return Array.isArray(t)?z.fromArray(t.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(t)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",r),zc("",e,n)}if(typeof t=="string"){const r=io.fromSchema(e);return n.slice?r.parseSlice(Wy(t),n.parseOptions).content:r.parse(Wy(t),n.parseOptions)}return zc("",e,n)}function RO(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof _t||i instanceof ut))return;const s=t.mapping.maps[r];let o=0;s.forEach((a,l,c,u)=>{o===0&&(o=u)}),t.setSelection(ue.near(t.doc.resolve(o),n))}const PO=t=>t.toString().startsWith("<"),LO=(t,e,n)=>({tr:r,dispatch:i,editor:s})=>{if(i){n={parseOptions:{},updateSelection:!0,...n};const o=zc(e,s.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(o.toString()==="<>")return!0;let{from:a,to:l}=typeof t=="number"?{from:t,to:t}:t,c=!0,u=!0;if((PO(o)?o:[o]).forEach(d=>{d.check(),c=c?d.isText&&d.marks.length===0:!1,u=u?d.isBlock:!1}),a===l&&u){const{parent:d}=r.doc.resolve(a);d.isTextblock&&!d.type.spec.code&&!d.childCount&&(a-=1,l+=1)}c?r.insertText(e,a,l):r.replaceWith(a,l,o),n.updateSelection&&RO(r,r.steps.length-1,-1)}return!0},BO=()=>({state:t,dispatch:e})=>BM(t,e),FO=()=>({state:t,dispatch:e})=>VM(t,e);function RE(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function VO(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,s,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))s=!0;else if(/^mod$/i.test(l))Hp()||RE()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}const $O=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const s=VO(t).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Na(t,e,n={}){const{from:r,to:i,empty:s}=t.selection,o=e?dt(e,t.schema):null,a=[];t.doc.nodesBetween(r,i,(h,d)=>{if(h.isText)return;const f=Math.max(r,d),p=Math.min(i,d+h.nodeSize);a.push({node:h,from:f,to:p})});const l=i-r,c=a.filter(h=>o?o.name===h.node.type.name:!0).filter(h=>Uc(h.node.attrs,n,{strict:!1}));return s?!!c.length:c.reduce((h,d)=>h+d.to-d.from,0)>=l}const UO=(t,e={})=>({state:n,dispatch:r})=>{const i=dt(t,n.schema);return Na(n,i,e)?UM(n,r):!1},zO=()=>({state:t,dispatch:e})=>KM(t,e),HO=t=>({state:e,dispatch:n})=>{const r=dt(t,e.schema);return ZM(r)(e,n)},jO=()=>({state:t,dispatch:e})=>zM(t,e);function Uu(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Gy(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const KO=(t,e)=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const a=Uu(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(s=dt(t,r.schema)),a==="mark"&&(o=ui(t,r.schema)),i&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{s&&s===c.type&&n.setNodeMarkup(u,void 0,Gy(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(h=>{o===h.type&&n.addMark(u,u+c.nodeSize,o.create(Gy(h.attrs,e)))})})}),!0):!1},qO=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),WO=()=>({tr:t,commands:e})=>e.setTextSelection({from:0,to:t.doc.content.size}),GO=()=>({state:t,dispatch:e})=>FM(t,e),JO=()=>({state:t,dispatch:e})=>$M(t,e),XO=()=>({state:t,dispatch:e})=>qM(t,e),YO=()=>({state:t,dispatch:e})=>JM(t,e),QO=()=>({state:t,dispatch:e})=>GM(t,e);function PE(t,e,n={}){return zc(t,e,{slice:!1,parseOptions:n})}const ZO=(t,e=!1,n={})=>({tr:r,editor:i,dispatch:s})=>{const{doc:o}=r,a=PE(t,i.schema,n);return s&&r.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0};function eN(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function df(t,e){const n=[];return t.descendants((r,i)=>{e(r)&&n.push({node:r,pos:i})}),n}function LE(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function jp(t){return e=>LE(e.$from,t)}function tN(t,e){const n=rr.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}function nN(t,e){const n={from:0,to:t.content.size};return OE(t,n,e)}function BE(t,e){const n=ui(e,t.schema),{from:r,to:i,empty:s}=t.selection,o=[];s?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function rN(t,e){const n=dt(e,t.schema),{from:r,to:i}=t.selection,s=[];t.doc.nodesBetween(r,i,a=>{s.push(a)});const o=s.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}function iN(t,e){const n=Uu(typeof e=="string"?e:e.name,t.schema);return n==="node"?rN(t,e):n==="mark"?BE(t,e):{}}function FE(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const s=n.resolve(t-1),o=Up(s,i.type);!o||r.push({mark:i,...o})}):n.nodesBetween(t,e,(i,s)=>{r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function ff(t,e,n={}){const{empty:r,ranges:i}=t.selection,s=e?ui(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(h=>s?s.name===h.type.name:!0).find(h=>Uc(h.attrs,n,{strict:!1}));let o=0;const a=[];if(i.forEach(({$from:h,$to:d})=>{const f=h.pos,p=d.pos;t.doc.nodesBetween(f,p,(g,m)=>{if(!g.isText&&!g.marks.length)return;const w=Math.max(f,m),_=Math.min(p,m+g.nodeSize);o+=_-w,a.push(...g.marks.map(y=>({mark:y,from:w,to:_})))})}),o===0)return!1;const l=a.filter(h=>s?s.name===h.mark.type.name:!0).filter(h=>Uc(h.mark.attrs,n,{strict:!1})).reduce((h,d)=>h+d.to-d.from,0),c=a.filter(h=>s?h.mark.type!==s&&h.mark.type.excludes(s):!0).reduce((h,d)=>h+d.to-d.from,0);return(l>0?l+c:l)>=o}function sN(t,e,n={}){if(!e)return Na(t,null,n)||ff(t,null,n);const r=Uu(e,t.schema);return r==="node"?Na(t,e,n):r==="mark"?ff(t,e,n):!1}function Jy(t,e){const{nodeExtensions:n}=Fu(e),r=n.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=Se(re(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function oN(t){var e;const n=(e=t.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=t.toJSON();return JSON.stringify(n)===JSON.stringify(r)}function aN(t){return t instanceof fe}function VE(t,e,n){const i=t.state.doc.content.size,s=br(e,0,i),o=br(n,0,i),a=t.coordsAtPos(s),l=t.coordsAtPos(o,-1),c=Math.min(a.top,l.top),u=Math.max(a.bottom,l.bottom),h=Math.min(a.left,l.left),d=Math.max(a.right,l.right),f=d-h,p=u-c,w={top:c,bottom:u,left:h,right:d,width:f,height:p,x:h,y:c};return{...w,toJSON:()=>w}}function lN(t,e,n){var r;const{selection:i}=e;let s=null;if(zp(i)&&(s=i.$cursor),s){const a=(r=t.storedMarks)!==null&&r!==void 0?r:s.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(a.pos,l.pos,(u,h,d)=>{if(c)return!1;if(u.isInline){const f=!d||d.type.allowsMarkType(n),p=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));c=f&&p}return!c}),c})}const cN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:s}=n,{empty:o,ranges:a}=s,l=ui(t,r.schema);if(i)if(o){const c=BE(r,l);n.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,h=c.$to.pos;r.doc.nodesBetween(u,h,(d,f)=>{const p=Math.max(f,u),g=Math.min(f+d.nodeSize,h);d.marks.find(w=>w.type===l)?d.marks.forEach(w=>{l===w.type&&n.addMark(p,g,l.create({...w.attrs,...e}))}):n.addMark(p,g,l.create(e))})});return lN(r,n,l)},uN=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),hN=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const s=dt(t,n.schema);return s.isTextblock?i().command(({commands:o})=>Hy(s,e)(n)?!0:o.clearNodes()).command(({state:o})=>Hy(s,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},dN=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=br(t,0,r.content.size),s=fe.create(r,i);e.setSelection(s)}return!0},fN=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:s}=typeof t=="number"?{from:t,to:t}:t,o=pe.atStart(r).from,a=pe.atEnd(r).to,l=br(i,o,a),c=br(s,o,a),u=pe.create(r,l,c);e.setSelection(u)}return!0},pN=t=>({state:e,dispatch:n})=>{const r=dt(t,e.schema);return nO(r)(e,n)};function hc(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function Xy(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e==null?void 0:e.includes(i.type.name));t.tr.ensureMarks(r)}}const gN=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:a,$to:l}=s,c=i.extensionManager.attributes,u=hc(c,a.node().type.name,a.node().attrs);if(s instanceof fe&&s.node.isBlock)return!a.parentOffset||!Ys(o,a.pos)?!1:(r&&(t&&Xy(n,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const h=l.parentOffset===l.parent.content.size;s instanceof pe&&e.deleteSelection();const d=a.depth===0?void 0:eN(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=h&&d?[{type:d,attrs:u}]:void 0,p=Ys(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!p&&Ys(e.doc,e.mapping.map(a.pos),1,d?[{type:d}]:void 0)&&(p=!0,f=d?[{type:d,attrs:u}]:void 0),p&&(e.split(e.mapping.map(a.pos),1,f),d&&!h&&!a.parentOffset&&a.parent.type!==d)){const g=e.mapping.map(a.before()),m=e.doc.resolve(g);a.node(-1).canReplaceWith(m.index(),m.index()+1,d)&&e.setNodeMarkup(e.mapping.map(a.before()),d)}t&&Xy(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},mN=t=>({tr:e,state:n,dispatch:r,editor:i})=>{var s;const o=dt(t,n.schema),{$from:a,$to:l}=n.selection,c=n.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==o)return!1;const h=i.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let m=z.empty;const w=a.index(-1)?1:a.index(-2)?2:3;for(let j=a.depth-w;j>=a.depth-3;j-=1)m=z.from(a.node(j).copy(m));const _=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,M=hc(h,a.node().type.name,a.node().attrs),y=((s=o.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(M))||void 0;m=m.append(z.from(o.createAndFill(null,y)||void 0));const L=a.before(a.depth-(w-1));e.replace(L,a.after(-_),new J(m,4-w,0));let R=-1;e.doc.nodesBetween(L,e.doc.content.size,(j,N)=>{if(R>-1)return!1;j.isTextblock&&j.content.size===0&&(R=N+1)}),R>-1&&e.setSelection(pe.near(e.doc.resolve(R))),e.scrollIntoView()}return!0}const d=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,f=hc(h,u.type.name,u.attrs),p=hc(h,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const g=d?[{type:o,attrs:f},{type:d,attrs:p}]:[{type:o,attrs:f}];return Ys(e.doc,a.pos,2)?(r&&e.split(a.pos,2,g).scrollIntoView(),!0):!1},Yy=(t,e)=>{const n=jp(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Mo(t.doc,n.pos)&&t.join(n.pos),!0},Qy=(t,e)=>{const n=jp(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===(i==null?void 0:i.type)&&Mo(t.doc,r)&&t.join(r),!0},yN=(t,e)=>({editor:n,tr:r,state:i,dispatch:s,chain:o,commands:a,can:l})=>{const{extensions:c}=n.extensionManager,u=dt(t,i.schema),h=dt(e,i.schema),{selection:d}=i,{$from:f,$to:p}=d,g=f.blockRange(p);if(!g)return!1;const m=jp(w=>Jy(w.type.name,c))(d);if(g.depth>=1&&m&&g.depth-m.depth<=1){if(m.node.type===u)return a.liftListItem(h);if(Jy(m.node.type.name,c)&&u.validContent(m.node.content)&&s)return o().command(()=>(r.setNodeMarkup(m.pos,u),!0)).command(()=>Yy(r,u)).command(()=>Qy(r,u)).run()}return o().command(()=>l().wrapInList(u)?!0:a.clearNodes()).wrapInList(u).command(()=>Yy(r,u)).command(()=>Qy(r,u)).run()},bN=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=n,o=ui(t,r.schema);return ff(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},wN=(t,e,n={})=>({state:r,commands:i})=>{const s=dt(t,r.schema),o=dt(e,r.schema);return Na(r,s,n)?i.setNode(o):i.setNode(s,n)},vN=(t,e={})=>({state:n,commands:r})=>{const i=dt(t,n.schema);return Na(n,i,e)?r.lift(i):r.wrapIn(i,e)},EN=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){const o=t.tr,a=s.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(s.text){const l=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,t.schema.text(s.text,l))}else o.delete(s.from,s.to)}return!0}}return!1},xN=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},SN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=n,l=ui(t,r.schema),{$from:c,empty:u,ranges:h}=a;if(!i)return!0;if(u&&o){let{from:d,to:f}=a;const p=(s=c.marks().find(m=>m.type===l))===null||s===void 0?void 0:s.attrs,g=Up(c,l,p);g&&(d=g.from,f=g.to),n.removeMark(d,f,l)}else h.forEach(d=>{n.removeMark(d.$from.pos,d.$to.pos,l)});return n.removeStoredMark(l),!0},TN=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const a=Uu(typeof t=="string"?t:t.name,r.schema);return a?(a==="node"&&(s=dt(t,r.schema)),a==="mark"&&(o=ui(t,r.schema)),i&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(h,d)=>{s&&s===h.type&&n.setNodeMarkup(d,void 0,{...h.attrs,...e}),o&&h.marks.length&&h.marks.forEach(f=>{if(o===f.type){const p=Math.max(d,c),g=Math.min(d+h.nodeSize,u);n.addMark(p,g,o.create({...f.attrs,...e}))}})})}),!0):!1},CN=(t,e={})=>({state:n,dispatch:r})=>{const i=dt(t,n.schema);return XM(i,e)(n,r)},kN=(t,e={})=>({state:n,dispatch:r})=>{const i=dt(t,n.schema);return YM(i,e)(n,r)};var IN=Object.freeze({__proto__:null,blur:bO,clearContent:wO,clearNodes:vO,command:EO,createParagraphNear:xO,deleteNode:SO,deleteRange:TO,deleteSelection:CO,enter:kO,exitCode:IO,extendMarkRange:_O,first:MO,focus:OO,forEach:NO,insertContent:DO,insertContentAt:LO,joinBackward:BO,joinForward:FO,keyboardShortcut:$O,lift:UO,liftEmptyBlock:zO,liftListItem:HO,newlineInCode:jO,resetAttributes:KO,scrollIntoView:qO,selectAll:WO,selectNodeBackward:GO,selectNodeForward:JO,selectParentNode:XO,selectTextblockEnd:YO,selectTextblockStart:QO,setContent:ZO,setMark:cN,setMeta:uN,setNode:hN,setNodeSelection:dN,setTextSelection:fN,sinkListItem:pN,splitBlock:gN,splitListItem:mN,toggleList:yN,toggleMark:bN,toggleNode:wN,toggleWrap:vN,undoInputRule:EN,unsetAllMarks:xN,unsetMark:SN,updateAttributes:TN,wrapIn:CN,wrapInList:kN});const AN=Xt.create({name:"commands",addCommands(){return{...IN}}}),_N=Xt.create({name:"editable",addProseMirrorPlugins(){return[new Tt({key:new ln("editable"),props:{editable:()=>this.editor.options.editable}})]}}),MN=Xt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Tt({key:new ln("focusEvents"),props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),ON=Xt.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:h}=l,{pos:d,parent:f}=h,p=ue.atStart(c).from===d;return!u||!p||!f.type.isTextblock||f.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Hp()||RE()?s:i},addProseMirrorPlugins(){return[new Tt({key:new ln("clearDocument"),appendTransaction:(t,e,n)=>{if(!(t.some(p=>p.docChanged)&&!e.doc.eq(n.doc)))return;const{empty:i,from:s,to:o}=e.selection,a=ue.atStart(e.doc).from,l=ue.atEnd(e.doc).to,c=s===a&&o===l,u=n.doc.textBetween(0,n.doc.content.size," "," ").length===0;if(i||!c||!u)return;const h=n.tr,d=Lu({state:n,transaction:h}),{commands:f}=new Bu({editor:this.editor,state:d});if(f.clearNodes(),!!h.steps.length)return h}})]}}),NN=Xt.create({name:"tabindex",addProseMirrorPlugins(){return[new Tt({key:new ln("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var DN=Object.freeze({__proto__:null,ClipboardTextSerializer:yO,Commands:AN,Editable:_N,FocusEvents:MN,Keymap:ON,Tabindex:NN});const RN=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function PN(t,e){const n=document.querySelector("style[data-tiptap-style]");if(n!==null)return n;const r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.setAttribute("data-tiptap-style",""),r.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(r),r}class LN extends rO{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=PN(RN,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){this.setOptions({editable:e}),this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=ME(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const n=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(n))});this.view.updateState(r)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(DN):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r==null?void 0:r.type));this.extensionManager=new Hs(n,this)}createCommandManager(){this.commandManager=new Bu({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=PE(this.options.content,this.schema,this.options.parseOptions),n=DE(e,this.options.autofocus);this.view=new CM(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:$s.create({doc:e,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return iN(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return sN(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return tN(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return nN(this.state.doc,{blockSeparator:n,textSerializers:{...r,...NE(this.schema)}})}get isEmpty(){return oN(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}}function uo(t){return new Vu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Se(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];let l=n.to;if(o){const c=a.search(/\S/),u=n.from+a.indexOf(o),h=u+o.length;if(FE(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===t.type&&g!==f.mark.type)).filter(f=>f.to>u).length)return null;h<n.to&&s.delete(h,n.to),u>n.from&&s.delete(n.from+c,u),l=n.from+c+o.length,s.addMark(n.from+c,l,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}function $E(t){return new Vu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Se(t.getAttributes,void 0,r)||{},{tr:s}=e,o=n.from;let a=n.to;if(r[1]){const l=r[0].lastIndexOf(r[1]);let c=o+l;c>a?c=a:a=c+r[1].length;const u=r[0][r[0].length-1];s.insertText(u,o+r[0].length-1),s.replaceWith(c,a,t.type.create(i))}else r[0]&&s.replaceWith(o,a,t.type.create(i))}})}function pf(t){return new Vu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),s=Se(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function Kp(t){return new Vu({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Se(t.getAttributes,void 0,r)||{},s=e.tr.delete(n.from,n.to),a=s.doc.resolve(n.from).blockRange(),l=a&&Ip(a,t.type,i);if(!l)return null;s.wrap(a,l);const c=s.doc.resolve(n.from-1).nodeBefore;c&&c.type===t.type&&Mo(s.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,c))&&s.join(n.from-1)}})}class si{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Se(re(this,"addOptions",{name:this.name}))),this.storage=Se(re(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new si(e)}configure(e={}){const n=this.extend();return n.options=$u(this.options,e),n.storage=Se(re(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new si(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Se(re(n,"addOptions",{name:n.name})),n.storage=Se(re(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}class at{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Se(re(this,"addOptions",{name:this.name}))),this.storage=Se(re(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new at(e)}configure(e={}){const n=this.extend();return n.options=$u(this.options,e),n.storage=Se(re(n,"addStorage",{name:n.name,options:n.options})),n}extend(e={}){const n=new at(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Se(re(n,"addOptions",{name:n.name})),n.storage=Se(re(n,"addStorage",{name:n.name,options:n.options})),n}}function ho(t){return new hO({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Se(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],a=r[0];let l=n.to;if(o){const c=a.search(/\S/),u=n.from+a.indexOf(o),h=u+o.length;if(FE(n.from,n.to,e.doc).filter(f=>f.mark.type.excluded.find(g=>g===t.type&&g!==f.mark.type)).filter(f=>f.to>u).length)return null;h<n.to&&s.delete(h,n.to),u>n.from&&s.delete(n.from+c,u),l=n.from+c+o.length,s.addMark(n.from+c,l,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}var sn="top",Mn="bottom",On="right",on="left",qp="auto",ll=[sn,Mn,On,on],fo="start",Da="end",BN="clippingParents",UE="viewport",$o="popper",FN="reference",Zy=ll.reduce(function(t,e){return t.concat([e+"-"+fo,e+"-"+Da])},[]),zE=[].concat(ll,[qp]).reduce(function(t,e){return t.concat([e,e+"-"+fo,e+"-"+Da])},[]),VN="beforeRead",$N="read",UN="afterRead",zN="beforeMain",HN="main",jN="afterMain",KN="beforeWrite",qN="write",WN="afterWrite",GN=[VN,$N,UN,zN,HN,jN,KN,qN,WN];function dr(t){return t?(t.nodeName||"").toLowerCase():null}function Dn(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function ss(t){var e=Dn(t).Element;return t instanceof e||t instanceof Element}function _n(t){var e=Dn(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Wp(t){if(typeof ShadowRoot>"u")return!1;var e=Dn(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function JN(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},s=e.elements[n];!_n(s)||!dr(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(o){var a=i[o];a===!1?s.removeAttribute(o):s.setAttribute(o,a===!0?"":a)}))})}function XN(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],s=e.attributes[r]||{},o=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=o.reduce(function(l,c){return l[c]="",l},{});!_n(i)||!dr(i)||(Object.assign(i.style,a),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}const HE={name:"applyStyles",enabled:!0,phase:"write",fn:JN,effect:XN,requires:["computeStyles"]};function cr(t){return t.split("-")[0]}var Ji=Math.max,Hc=Math.min,po=Math.round;function gf(){var t=navigator.userAgentData;return t!=null&&t.brands?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function jE(){return!/^((?!chrome|android).)*safari/i.test(gf())}function go(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,s=1;e&&_n(t)&&(i=t.offsetWidth>0&&po(r.width)/t.offsetWidth||1,s=t.offsetHeight>0&&po(r.height)/t.offsetHeight||1);var o=ss(t)?Dn(t):window,a=o.visualViewport,l=!jE()&&n,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/s,h=r.width/i,d=r.height/s;return{width:h,height:d,top:u,right:c+h,bottom:u+d,left:c,x:c,y:u}}function Gp(t){var e=go(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function KE(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Wp(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Tr(t){return Dn(t).getComputedStyle(t)}function YN(t){return["table","td","th"].indexOf(dr(t))>=0}function hi(t){return((ss(t)?t.ownerDocument:t.document)||window.document).documentElement}function zu(t){return dr(t)==="html"?t:t.assignedSlot||t.parentNode||(Wp(t)?t.host:null)||hi(t)}function eb(t){return!_n(t)||Tr(t).position==="fixed"?null:t.offsetParent}function QN(t){var e=/firefox/i.test(gf()),n=/Trident/i.test(gf());if(n&&_n(t)){var r=Tr(t);if(r.position==="fixed")return null}var i=zu(t);for(Wp(i)&&(i=i.host);_n(i)&&["html","body"].indexOf(dr(i))<0;){var s=Tr(i);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return i;i=i.parentNode}return null}function cl(t){for(var e=Dn(t),n=eb(t);n&&YN(n)&&Tr(n).position==="static";)n=eb(n);return n&&(dr(n)==="html"||dr(n)==="body"&&Tr(n).position==="static")?e:n||QN(t)||e}function Jp(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function ua(t,e,n){return Ji(t,Hc(e,n))}function ZN(t,e,n){var r=ua(t,e,n);return r>n?n:r}function qE(){return{top:0,right:0,bottom:0,left:0}}function WE(t){return Object.assign({},qE(),t)}function GE(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var eD=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,WE(typeof e!="number"?e:GE(e,ll))};function tD(t){var e,n=t.state,r=t.name,i=t.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=cr(n.placement),l=Jp(a),c=[on,On].indexOf(a)>=0,u=c?"height":"width";if(!(!s||!o)){var h=eD(i.padding,n),d=Gp(s),f=l==="y"?sn:on,p=l==="y"?Mn:On,g=n.rects.reference[u]+n.rects.reference[l]-o[l]-n.rects.popper[u],m=o[l]-n.rects.reference[l],w=cl(s),_=w?l==="y"?w.clientHeight||0:w.clientWidth||0:0,M=g/2-m/2,y=h[f],L=_-d[u]-h[p],R=_/2-d[u]/2+M,j=ua(y,R,L),N=l;n.modifiersData[r]=(e={},e[N]=j,e.centerOffset=j-R,e)}}function nD(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||!KE(e.elements.popper,i)||(e.elements.arrow=i))}const rD={name:"arrow",enabled:!0,phase:"main",fn:tD,effect:nD,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function mo(t){return t.split("-")[1]}var iD={top:"auto",right:"auto",bottom:"auto",left:"auto"};function sD(t){var e=t.x,n=t.y,r=window,i=r.devicePixelRatio||1;return{x:po(e*i)/i||0,y:po(n*i)/i||0}}function tb(t){var e,n=t.popper,r=t.popperRect,i=t.placement,s=t.variation,o=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,h=t.isFixed,d=o.x,f=d===void 0?0:d,p=o.y,g=p===void 0?0:p,m=typeof u=="function"?u({x:f,y:g}):{x:f,y:g};f=m.x,g=m.y;var w=o.hasOwnProperty("x"),_=o.hasOwnProperty("y"),M=on,y=sn,L=window;if(c){var R=cl(n),j="clientHeight",N="clientWidth";if(R===Dn(n)&&(R=hi(n),Tr(R).position!=="static"&&a==="absolute"&&(j="scrollHeight",N="scrollWidth")),R=R,i===sn||(i===on||i===On)&&s===Da){y=Mn;var G=h&&R===L&&L.visualViewport?L.visualViewport.height:R[j];g-=G-r.height,g*=l?1:-1}if(i===on||(i===sn||i===Mn)&&s===Da){M=On;var ie=h&&R===L&&L.visualViewport?L.visualViewport.width:R[N];f-=ie-r.width,f*=l?1:-1}}var he=Object.assign({position:a},c&&iD),ve=u===!0?sD({x:f,y:g}):{x:f,y:g};if(f=ve.x,g=ve.y,l){var Ee;return Object.assign({},he,(Ee={},Ee[y]=_?"0":"",Ee[M]=w?"0":"",Ee.transform=(L.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",Ee))}return Object.assign({},he,(e={},e[y]=_?g+"px":"",e[M]=w?f+"px":"",e.transform="",e))}function oD(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,s=n.adaptive,o=s===void 0?!0:s,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:cr(e.placement),variation:mo(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,tb(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:o,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,tb(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const aD={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:oD,data:{}};var Vl={passive:!0};function lD(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,s=i===void 0?!0:i,o=r.resize,a=o===void 0?!0:o,l=Dn(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",n.update,Vl)}),a&&l.addEventListener("resize",n.update,Vl),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",n.update,Vl)}),a&&l.removeEventListener("resize",n.update,Vl)}}const cD={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:lD,data:{}};var uD={left:"right",right:"left",bottom:"top",top:"bottom"};function dc(t){return t.replace(/left|right|bottom|top/g,function(e){return uD[e]})}var hD={start:"end",end:"start"};function nb(t){return t.replace(/start|end/g,function(e){return hD[e]})}function Xp(t){var e=Dn(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Yp(t){return go(hi(t)).left+Xp(t).scrollLeft}function dD(t,e){var n=Dn(t),r=hi(t),i=n.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var c=jE();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+Yp(t),y:l}}function fD(t){var e,n=hi(t),r=Xp(t),i=(e=t.ownerDocument)==null?void 0:e.body,s=Ji(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=Ji(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Yp(t),l=-r.scrollTop;return Tr(i||n).direction==="rtl"&&(a+=Ji(n.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function Qp(t){var e=Tr(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function JE(t){return["html","body","#document"].indexOf(dr(t))>=0?t.ownerDocument.body:_n(t)&&Qp(t)?t:JE(zu(t))}function ha(t,e){var n;e===void 0&&(e=[]);var r=JE(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),s=Dn(r),o=i?[s].concat(s.visualViewport||[],Qp(r)?r:[]):r,a=e.concat(o);return i?a:a.concat(ha(zu(o)))}function mf(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function pD(t,e){var n=go(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function rb(t,e,n){return e===UE?mf(dD(t,n)):ss(e)?pD(e,n):mf(fD(hi(t)))}function gD(t){var e=ha(zu(t)),n=["absolute","fixed"].indexOf(Tr(t).position)>=0,r=n&&_n(t)?cl(t):t;return ss(r)?e.filter(function(i){return ss(i)&&KE(i,r)&&dr(i)!=="body"}):[]}function mD(t,e,n,r){var i=e==="clippingParents"?gD(t):[].concat(e),s=[].concat(i,[n]),o=s[0],a=s.reduce(function(l,c){var u=rb(t,c,r);return l.top=Ji(u.top,l.top),l.right=Hc(u.right,l.right),l.bottom=Hc(u.bottom,l.bottom),l.left=Ji(u.left,l.left),l},rb(t,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function XE(t){var e=t.reference,n=t.element,r=t.placement,i=r?cr(r):null,s=r?mo(r):null,o=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(i){case sn:l={x:o,y:e.y-n.height};break;case Mn:l={x:o,y:e.y+e.height};break;case On:l={x:e.x+e.width,y:a};break;case on:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?Jp(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case fo:l[c]=l[c]-(e[u]/2-n[u]/2);break;case Da:l[c]=l[c]+(e[u]/2-n[u]/2);break}}return l}function Ra(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,s=n.strategy,o=s===void 0?t.strategy:s,a=n.boundary,l=a===void 0?BN:a,c=n.rootBoundary,u=c===void 0?UE:c,h=n.elementContext,d=h===void 0?$o:h,f=n.altBoundary,p=f===void 0?!1:f,g=n.padding,m=g===void 0?0:g,w=WE(typeof m!="number"?m:GE(m,ll)),_=d===$o?FN:$o,M=t.rects.popper,y=t.elements[p?_:d],L=mD(ss(y)?y:y.contextElement||hi(t.elements.popper),l,u,o),R=go(t.elements.reference),j=XE({reference:R,element:M,strategy:"absolute",placement:i}),N=mf(Object.assign({},M,j)),G=d===$o?N:R,ie={top:L.top-G.top+w.top,bottom:G.bottom-L.bottom+w.bottom,left:L.left-G.left+w.left,right:G.right-L.right+w.right},he=t.modifiersData.offset;if(d===$o&&he){var ve=he[i];Object.keys(ie).forEach(function(Ee){var Oe=[On,Mn].indexOf(Ee)>=0?1:-1,ze=[sn,Mn].indexOf(Ee)>=0?"y":"x";ie[Ee]+=ve[ze]*Oe})}return ie}function yD(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,s=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?zE:l,u=mo(r),h=u?a?Zy:Zy.filter(function(p){return mo(p)===u}):ll,d=h.filter(function(p){return c.indexOf(p)>=0});d.length===0&&(d=h);var f=d.reduce(function(p,g){return p[g]=Ra(t,{placement:g,boundary:i,rootBoundary:s,padding:o})[cr(g)],p},{});return Object.keys(f).sort(function(p,g){return f[p]-f[g]})}function bD(t){if(cr(t)===qp)return[];var e=dc(t);return[nb(t),e,nb(e)]}function wD(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,s=i===void 0?!0:i,o=n.altAxis,a=o===void 0?!0:o,l=n.fallbackPlacements,c=n.padding,u=n.boundary,h=n.rootBoundary,d=n.altBoundary,f=n.flipVariations,p=f===void 0?!0:f,g=n.allowedAutoPlacements,m=e.options.placement,w=cr(m),_=w===m,M=l||(_||!p?[dc(m)]:bD(m)),y=[m].concat(M).reduce(function(ke,Pe){return ke.concat(cr(Pe)===qp?yD(e,{placement:Pe,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:g}):Pe)},[]),L=e.rects.reference,R=e.rects.popper,j=new Map,N=!0,G=y[0],ie=0;ie<y.length;ie++){var he=y[ie],ve=cr(he),Ee=mo(he)===fo,Oe=[sn,Mn].indexOf(ve)>=0,ze=Oe?"width":"height",v=Ra(e,{placement:he,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),T=Oe?Ee?On:on:Ee?Mn:sn;L[ze]>R[ze]&&(T=dc(T));var O=dc(T),q=[];if(s&&q.push(v[ve]<=0),a&&q.push(v[T]<=0,v[O]<=0),q.every(function(ke){return ke})){G=he,N=!1;break}j.set(he,q)}if(N)for(var ne=p?3:1,me=function(Pe){var je=y.find(function(mt){var kt=j.get(mt);if(kt)return kt.slice(0,Pe).every(function(yt){return yt})});if(je)return G=je,"break"},xe=ne;xe>0;xe--){var Qe=me(xe);if(Qe==="break")break}e.placement!==G&&(e.modifiersData[r]._skip=!0,e.placement=G,e.reset=!0)}}const vD={name:"flip",enabled:!0,phase:"main",fn:wD,requiresIfExists:["offset"],data:{_skip:!1}};function ib(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function sb(t){return[sn,On,Mn,on].some(function(e){return t[e]>=0})}function ED(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,s=e.modifiersData.preventOverflow,o=Ra(e,{elementContext:"reference"}),a=Ra(e,{altBoundary:!0}),l=ib(o,r),c=ib(a,i,s),u=sb(l),h=sb(c);e.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}const xD={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ED};function SD(t,e,n){var r=cr(t),i=[on,sn].indexOf(r)>=0?-1:1,s=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[on,On].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function TD(t){var e=t.state,n=t.options,r=t.name,i=n.offset,s=i===void 0?[0,0]:i,o=zE.reduce(function(u,h){return u[h]=SD(h,e.rects,s),u},{}),a=o[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=o}const CD={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:TD};function kD(t){var e=t.state,n=t.name;e.modifiersData[n]=XE({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const ID={name:"popperOffsets",enabled:!0,phase:"read",fn:kD,data:{}};function AD(t){return t==="x"?"y":"x"}function _D(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,s=i===void 0?!0:i,o=n.altAxis,a=o===void 0?!1:o,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,h=n.padding,d=n.tether,f=d===void 0?!0:d,p=n.tetherOffset,g=p===void 0?0:p,m=Ra(e,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),w=cr(e.placement),_=mo(e.placement),M=!_,y=Jp(w),L=AD(y),R=e.modifiersData.popperOffsets,j=e.rects.reference,N=e.rects.popper,G=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,ie=typeof G=="number"?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),he=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,ve={x:0,y:0};if(!!R){if(s){var Ee,Oe=y==="y"?sn:on,ze=y==="y"?Mn:On,v=y==="y"?"height":"width",T=R[y],O=T+m[Oe],q=T-m[ze],ne=f?-N[v]/2:0,me=_===fo?j[v]:N[v],xe=_===fo?-N[v]:-j[v],Qe=e.elements.arrow,ke=f&&Qe?Gp(Qe):{width:0,height:0},Pe=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:qE(),je=Pe[Oe],mt=Pe[ze],kt=ua(0,j[v],ke[v]),yt=M?j[v]/2-ne-kt-je-ie.mainAxis:me-kt-je-ie.mainAxis,It=M?-j[v]/2+ne+kt+mt+ie.mainAxis:xe+kt+mt+ie.mainAxis,Yt=e.elements.arrow&&cl(e.elements.arrow),b=Yt?y==="y"?Yt.clientTop||0:Yt.clientLeft||0:0,E=(Ee=he==null?void 0:he[y])!=null?Ee:0,I=T+yt-E-b,$=T+It-E,B=ua(f?Hc(O,I):O,T,f?Ji(q,$):q);R[y]=B,ve[y]=B-T}if(a){var S,W=y==="x"?sn:on,D=y==="x"?Mn:On,A=R[L],F=L==="y"?"height":"width",Q=A+m[W],X=A-m[D],te=[sn,on].indexOf(w)!==-1,x=(S=he==null?void 0:he[L])!=null?S:0,C=te?Q:A-j[F]-N[F]-x+ie.altAxis,V=te?A+j[F]+N[F]-x-ie.altAxis:X,H=f&&te?ZN(C,A,V):ua(f?C:Q,A,f?V:X);R[L]=H,ve[L]=H-A}e.modifiersData[r]=ve}}const MD={name:"preventOverflow",enabled:!0,phase:"main",fn:_D,requiresIfExists:["offset"]};function OD(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function ND(t){return t===Dn(t)||!_n(t)?Xp(t):OD(t)}function DD(t){var e=t.getBoundingClientRect(),n=po(e.width)/t.offsetWidth||1,r=po(e.height)/t.offsetHeight||1;return n!==1||r!==1}function RD(t,e,n){n===void 0&&(n=!1);var r=_n(e),i=_n(e)&&DD(e),s=hi(e),o=go(t,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((dr(e)!=="body"||Qp(s))&&(a=ND(e)),_n(e)?(l=go(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=Yp(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function PD(t){var e=new Map,n=new Set,r=[];t.forEach(function(s){e.set(s.name,s)});function i(s){n.add(s.name);var o=[].concat(s.requires||[],s.requiresIfExists||[]);o.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&i(l)}}),r.push(s)}return t.forEach(function(s){n.has(s.name)||i(s)}),r}function LD(t){var e=PD(t);return GN.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function BD(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function FD(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var ob={placement:"bottom",modifiers:[],strategy:"absolute"};function ab(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function VD(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,s=i===void 0?ob:i;return function(a,l,c){c===void 0&&(c=s);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},ob,s),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},h=[],d=!1,f={state:u,setOptions:function(w){var _=typeof w=="function"?w(u.options):w;g(),u.options=Object.assign({},s,u.options,_),u.scrollParents={reference:ss(a)?ha(a):a.contextElement?ha(a.contextElement):[],popper:ha(l)};var M=LD(FD([].concat(r,u.options.modifiers)));return u.orderedModifiers=M.filter(function(y){return y.enabled}),p(),f.update()},forceUpdate:function(){if(!d){var w=u.elements,_=w.reference,M=w.popper;if(!!ab(_,M)){u.rects={reference:RD(_,cl(M),u.options.strategy==="fixed"),popper:Gp(M)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(ie){return u.modifiersData[ie.name]=Object.assign({},ie.data)});for(var y=0;y<u.orderedModifiers.length;y++){if(u.reset===!0){u.reset=!1,y=-1;continue}var L=u.orderedModifiers[y],R=L.fn,j=L.options,N=j===void 0?{}:j,G=L.name;typeof R=="function"&&(u=R({state:u,options:N,name:G,instance:f})||u)}}}},update:BD(function(){return new Promise(function(m){f.forceUpdate(),m(u)})}),destroy:function(){g(),d=!0}};if(!ab(a,l))return f;f.setOptions(c).then(function(m){!d&&c.onFirstUpdate&&c.onFirstUpdate(m)});function p(){u.orderedModifiers.forEach(function(m){var w=m.name,_=m.options,M=_===void 0?{}:_,y=m.effect;if(typeof y=="function"){var L=y({state:u,name:w,instance:f,options:M}),R=function(){};h.push(L||R)}})}function g(){h.forEach(function(m){return m()}),h=[]}return f}}var $D=[cD,ID,aD,HE,CD,vD,MD,rD,xD],UD=VD({defaultModifiers:$D}),zD="tippy-box",YE="tippy-content",HD="tippy-backdrop",QE="tippy-arrow",ZE="tippy-svg-arrow",Ci={passive:!0,capture:!0},ex=function(){return document.body};function id(t,e,n){if(Array.isArray(t)){var r=t[e];return r==null?Array.isArray(n)?n[e]:n:r}return t}function Zp(t,e){var n={}.toString.call(t);return n.indexOf("[object")===0&&n.indexOf(e+"]")>-1}function tx(t,e){return typeof t=="function"?t.apply(void 0,e):t}function lb(t,e){if(e===0)return t;var n;return function(r){clearTimeout(n),n=setTimeout(function(){t(r)},e)}}function jD(t){return t.split(/\s+/).filter(Boolean)}function Bs(t){return[].concat(t)}function cb(t,e){t.indexOf(e)===-1&&t.push(e)}function KD(t){return t.filter(function(e,n){return t.indexOf(e)===n})}function qD(t){return t.split("-")[0]}function jc(t){return[].slice.call(t)}function ub(t){return Object.keys(t).reduce(function(e,n){return t[n]!==void 0&&(e[n]=t[n]),e},{})}function da(){return document.createElement("div")}function Hu(t){return["Element","Fragment"].some(function(e){return Zp(t,e)})}function WD(t){return Zp(t,"NodeList")}function GD(t){return Zp(t,"MouseEvent")}function JD(t){return!!(t&&t._tippy&&t._tippy.reference===t)}function XD(t){return Hu(t)?[t]:WD(t)?jc(t):Array.isArray(t)?t:jc(document.querySelectorAll(t))}function sd(t,e){t.forEach(function(n){n&&(n.style.transitionDuration=e+"ms")})}function hb(t,e){t.forEach(function(n){n&&n.setAttribute("data-state",e)})}function YD(t){var e,n=Bs(t),r=n[0];return r!=null&&(e=r.ownerDocument)!=null&&e.body?r.ownerDocument:document}function QD(t,e){var n=e.clientX,r=e.clientY;return t.every(function(i){var s=i.popperRect,o=i.popperState,a=i.props,l=a.interactiveBorder,c=qD(o.placement),u=o.modifiersData.offset;if(!u)return!0;var h=c==="bottom"?u.top.y:0,d=c==="top"?u.bottom.y:0,f=c==="right"?u.left.x:0,p=c==="left"?u.right.x:0,g=s.top-r+h>l,m=r-s.bottom-d>l,w=s.left-n+f>l,_=n-s.right-p>l;return g||m||w||_})}function od(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(i){t[r](i,n)})}function db(t,e){for(var n=e;n;){var r;if(t.contains(n))return!0;n=n.getRootNode==null||(r=n.getRootNode())==null?void 0:r.host}return!1}var Qn={isTouch:!1},fb=0;function ZD(){Qn.isTouch||(Qn.isTouch=!0,window.performance&&document.addEventListener("mousemove",nx))}function nx(){var t=performance.now();t-fb<20&&(Qn.isTouch=!1,document.removeEventListener("mousemove",nx)),fb=t}function eR(){var t=document.activeElement;if(JD(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}function tR(){document.addEventListener("touchstart",ZD,Ci),window.addEventListener("blur",eR)}var nR=typeof window<"u"&&typeof document<"u",rR=nR?!!window.msCrypto:!1,iR={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},sR={allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999},Fn=Object.assign({appendTo:ex,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},iR,sR),oR=Object.keys(Fn),aR=function(e){var n=Object.keys(e);n.forEach(function(r){Fn[r]=e[r]})};function rx(t){var e=t.plugins||[],n=e.reduce(function(r,i){var s=i.name,o=i.defaultValue;if(s){var a;r[s]=t[s]!==void 0?t[s]:(a=Fn[s])!=null?a:o}return r},{});return Object.assign({},t,n)}function lR(t,e){var n=e?Object.keys(rx(Object.assign({},Fn,{plugins:e}))):oR,r=n.reduce(function(i,s){var o=(t.getAttribute("data-tippy-"+s)||"").trim();if(!o)return i;if(s==="content")i[s]=o;else try{i[s]=JSON.parse(o)}catch{i[s]=o}return i},{});return r}function pb(t,e){var n=Object.assign({},e,{content:tx(e.content,[t])},e.ignoreAttributes?{}:lR(t,e.plugins));return n.aria=Object.assign({},Fn.aria,n.aria),n.aria={expanded:n.aria.expanded==="auto"?e.interactive:n.aria.expanded,content:n.aria.content==="auto"?e.interactive?null:"describedby":n.aria.content},n}var cR=function(){return"innerHTML"};function yf(t,e){t[cR()]=e}function gb(t){var e=da();return t===!0?e.className=QE:(e.className=ZE,Hu(t)?e.appendChild(t):yf(e,t)),e}function mb(t,e){Hu(e.content)?(yf(t,""),t.appendChild(e.content)):typeof e.content!="function"&&(e.allowHTML?yf(t,e.content):t.textContent=e.content)}function bf(t){var e=t.firstElementChild,n=jc(e.children);return{box:e,content:n.find(function(r){return r.classList.contains(YE)}),arrow:n.find(function(r){return r.classList.contains(QE)||r.classList.contains(ZE)}),backdrop:n.find(function(r){return r.classList.contains(HD)})}}function ix(t){var e=da(),n=da();n.className=zD,n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=da();r.className=YE,r.setAttribute("data-state","hidden"),mb(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props);function i(s,o){var a=bf(e),l=a.box,c=a.content,u=a.arrow;o.theme?l.setAttribute("data-theme",o.theme):l.removeAttribute("data-theme"),typeof o.animation=="string"?l.setAttribute("data-animation",o.animation):l.removeAttribute("data-animation"),o.inertia?l.setAttribute("data-inertia",""):l.removeAttribute("data-inertia"),l.style.maxWidth=typeof o.maxWidth=="number"?o.maxWidth+"px":o.maxWidth,o.role?l.setAttribute("role",o.role):l.removeAttribute("role"),(s.content!==o.content||s.allowHTML!==o.allowHTML)&&mb(c,t.props),o.arrow?u?s.arrow!==o.arrow&&(l.removeChild(u),l.appendChild(gb(o.arrow))):l.appendChild(gb(o.arrow)):u&&l.removeChild(u)}return{popper:e,onUpdate:i}}ix.$$tippy=!0;var uR=1,$l=[],ad=[];function hR(t,e){var n=pb(t,Object.assign({},Fn,rx(ub(e)))),r,i,s,o=!1,a=!1,l=!1,c=!1,u,h,d,f=[],p=lb(I,n.interactiveDebounce),g,m=uR++,w=null,_=KD(n.plugins),M={isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},y={id:m,reference:t,popper:da(),popperInstance:w,props:n,state:M,plugins:_,clearDelayTimeouts:C,setProps:V,setContent:H,show:ce,hide:Ne,hideWithInteractivity:wn,enable:te,disable:x,unmount:Ar,destroy:mi};if(!n.render)return y;var L=n.render(y),R=L.popper,j=L.onUpdate;R.setAttribute("data-tippy-root",""),R.id="tippy-"+y.id,y.popper=R,t._tippy=y,R._tippy=y;var N=_.map(function(P){return P.fn(y)}),G=t.hasAttribute("aria-expanded");return Yt(),ne(),T(),O("onCreate",[y]),n.showOnCreate&&Q(),R.addEventListener("mouseenter",function(){y.props.interactive&&y.state.isVisible&&y.clearDelayTimeouts()}),R.addEventListener("mouseleave",function(){y.props.interactive&&y.props.trigger.indexOf("mouseenter")>=0&&Oe().addEventListener("mousemove",p)}),y;function ie(){var P=y.props.touch;return Array.isArray(P)?P:[P,0]}function he(){return ie()[0]==="hold"}function ve(){var P;return!!((P=y.props.render)!=null&&P.$$tippy)}function Ee(){return g||t}function Oe(){var P=Ee().parentNode;return P?YD(P):document}function ze(){return bf(R)}function v(P){return y.state.isMounted&&!y.state.isVisible||Qn.isTouch||u&&u.type==="focus"?0:id(y.props.delay,P?0:1,Fn.delay)}function T(P){P===void 0&&(P=!1),R.style.pointerEvents=y.props.interactive&&!P?"":"none",R.style.zIndex=""+y.props.zIndex}function O(P,Z,le){if(le===void 0&&(le=!0),N.forEach(function(De){De[P]&&De[P].apply(De,Z)}),le){var Re;(Re=y.props)[P].apply(Re,Z)}}function q(){var P=y.props.aria;if(!!P.content){var Z="aria-"+P.content,le=R.id,Re=Bs(y.props.triggerTarget||t);Re.forEach(function(De){var Vt=De.getAttribute(Z);if(y.state.isVisible)De.setAttribute(Z,Vt?Vt+" "+le:le);else{var vn=Vt&&Vt.replace(le,"").trim();vn?De.setAttribute(Z,vn):De.removeAttribute(Z)}})}}function ne(){if(!(G||!y.props.aria.expanded)){var P=Bs(y.props.triggerTarget||t);P.forEach(function(Z){y.props.interactive?Z.setAttribute("aria-expanded",y.state.isVisible&&Z===Ee()?"true":"false"):Z.removeAttribute("aria-expanded")})}}function me(){Oe().removeEventListener("mousemove",p),$l=$l.filter(function(P){return P!==p})}function xe(P){if(!(Qn.isTouch&&(l||P.type==="mousedown"))){var Z=P.composedPath&&P.composedPath()[0]||P.target;if(!(y.props.interactive&&db(R,Z))){if(Bs(y.props.triggerTarget||t).some(function(le){return db(le,Z)})){if(Qn.isTouch||y.state.isVisible&&y.props.trigger.indexOf("click")>=0)return}else O("onClickOutside",[y,P]);y.props.hideOnClick===!0&&(y.clearDelayTimeouts(),y.hide(),a=!0,setTimeout(function(){a=!1}),y.state.isMounted||je())}}}function Qe(){l=!0}function ke(){l=!1}function Pe(){var P=Oe();P.addEventListener("mousedown",xe,!0),P.addEventListener("touchend",xe,Ci),P.addEventListener("touchstart",ke,Ci),P.addEventListener("touchmove",Qe,Ci)}function je(){var P=Oe();P.removeEventListener("mousedown",xe,!0),P.removeEventListener("touchend",xe,Ci),P.removeEventListener("touchstart",ke,Ci),P.removeEventListener("touchmove",Qe,Ci)}function mt(P,Z){yt(P,function(){!y.state.isVisible&&R.parentNode&&R.parentNode.contains(R)&&Z()})}function kt(P,Z){yt(P,Z)}function yt(P,Z){var le=ze().box;function Re(De){De.target===le&&(od(le,"remove",Re),Z())}if(P===0)return Z();od(le,"remove",h),od(le,"add",Re),h=Re}function It(P,Z,le){le===void 0&&(le=!1);var Re=Bs(y.props.triggerTarget||t);Re.forEach(function(De){De.addEventListener(P,Z,le),f.push({node:De,eventType:P,handler:Z,options:le})})}function Yt(){he()&&(It("touchstart",E,{passive:!0}),It("touchend",$,{passive:!0})),jD(y.props.trigger).forEach(function(P){if(P!=="manual")switch(It(P,E),P){case"mouseenter":It("mouseleave",$);break;case"focus":It(rR?"focusout":"blur",B);break;case"focusin":It("focusout",B);break}})}function b(){f.forEach(function(P){var Z=P.node,le=P.eventType,Re=P.handler,De=P.options;Z.removeEventListener(le,Re,De)}),f=[]}function E(P){var Z,le=!1;if(!(!y.state.isEnabled||S(P)||a)){var Re=((Z=u)==null?void 0:Z.type)==="focus";u=P,g=P.currentTarget,ne(),!y.state.isVisible&&GD(P)&&$l.forEach(function(De){return De(P)}),P.type==="click"&&(y.props.trigger.indexOf("mouseenter")<0||o)&&y.props.hideOnClick!==!1&&y.state.isVisible?le=!0:Q(P),P.type==="click"&&(o=!le),le&&!Re&&X(P)}}function I(P){var Z=P.target,le=Ee().contains(Z)||R.contains(Z);if(!(P.type==="mousemove"&&le)){var Re=F().concat(R).map(function(De){var Vt,vn=De._tippy,ks=(Vt=vn.popperInstance)==null?void 0:Vt.state;return ks?{popperRect:De.getBoundingClientRect(),popperState:ks,props:n}:null}).filter(Boolean);QD(Re,P)&&(me(),X(P))}}function $(P){var Z=S(P)||y.props.trigger.indexOf("click")>=0&&o;if(!Z){if(y.props.interactive){y.hideWithInteractivity(P);return}X(P)}}function B(P){y.props.trigger.indexOf("focusin")<0&&P.target!==Ee()||y.props.interactive&&P.relatedTarget&&R.contains(P.relatedTarget)||X(P)}function S(P){return Qn.isTouch?he()!==P.type.indexOf("touch")>=0:!1}function W(){D();var P=y.props,Z=P.popperOptions,le=P.placement,Re=P.offset,De=P.getReferenceClientRect,Vt=P.moveTransition,vn=ve()?bf(R).arrow:null,ks=De?{getBoundingClientRect:De,contextElement:De.contextElement||Ee()}:t,gm={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(Il){var Is=Il.state;if(ve()){var kC=ze(),Mh=kC.box;["placement","reference-hidden","escaped"].forEach(function(Al){Al==="placement"?Mh.setAttribute("data-placement",Is.placement):Is.attributes.popper["data-popper-"+Al]?Mh.setAttribute("data-"+Al,""):Mh.removeAttribute("data-"+Al)}),Is.attributes.popper={}}}},yi=[{name:"offset",options:{offset:Re}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!Vt}},gm];ve()&&vn&&yi.push({name:"arrow",options:{element:vn,padding:3}}),yi.push.apply(yi,(Z==null?void 0:Z.modifiers)||[]),y.popperInstance=UD(ks,R,Object.assign({},Z,{placement:le,onFirstUpdate:d,modifiers:yi}))}function D(){y.popperInstance&&(y.popperInstance.destroy(),y.popperInstance=null)}function A(){var P=y.props.appendTo,Z,le=Ee();y.props.interactive&&P===ex||P==="parent"?Z=le.parentNode:Z=tx(P,[le]),Z.contains(R)||Z.appendChild(R),y.state.isMounted=!0,W()}function F(){return jc(R.querySelectorAll("[data-tippy-root]"))}function Q(P){y.clearDelayTimeouts(),P&&O("onTrigger",[y,P]),Pe();var Z=v(!0),le=ie(),Re=le[0],De=le[1];Qn.isTouch&&Re==="hold"&&De&&(Z=De),Z?r=setTimeout(function(){y.show()},Z):y.show()}function X(P){if(y.clearDelayTimeouts(),O("onUntrigger",[y,P]),!y.state.isVisible){je();return}if(!(y.props.trigger.indexOf("mouseenter")>=0&&y.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(P.type)>=0&&o)){var Z=v(!1);Z?i=setTimeout(function(){y.state.isVisible&&y.hide()},Z):s=requestAnimationFrame(function(){y.hide()})}}function te(){y.state.isEnabled=!0}function x(){y.hide(),y.state.isEnabled=!1}function C(){clearTimeout(r),clearTimeout(i),cancelAnimationFrame(s)}function V(P){if(!y.state.isDestroyed){O("onBeforeUpdate",[y,P]),b();var Z=y.props,le=pb(t,Object.assign({},Z,ub(P),{ignoreAttributes:!0}));y.props=le,Yt(),Z.interactiveDebounce!==le.interactiveDebounce&&(me(),p=lb(I,le.interactiveDebounce)),Z.triggerTarget&&!le.triggerTarget?Bs(Z.triggerTarget).forEach(function(Re){Re.removeAttribute("aria-expanded")}):le.triggerTarget&&t.removeAttribute("aria-expanded"),ne(),T(),j&&j(Z,le),y.popperInstance&&(W(),F().forEach(function(Re){requestAnimationFrame(Re._tippy.popperInstance.forceUpdate)})),O("onAfterUpdate",[y,P])}}function H(P){y.setProps({content:P})}function ce(){var P=y.state.isVisible,Z=y.state.isDestroyed,le=!y.state.isEnabled,Re=Qn.isTouch&&!y.props.touch,De=id(y.props.duration,0,Fn.duration);if(!(P||Z||le||Re)&&!Ee().hasAttribute("disabled")&&(O("onShow",[y],!1),y.props.onShow(y)!==!1)){if(y.state.isVisible=!0,ve()&&(R.style.visibility="visible"),T(),Pe(),y.state.isMounted||(R.style.transition="none"),ve()){var Vt=ze(),vn=Vt.box,ks=Vt.content;sd([vn,ks],0)}d=function(){var yi;if(!(!y.state.isVisible||c)){if(c=!0,R.offsetHeight,R.style.transition=y.props.moveTransition,ve()&&y.props.animation){var _h=ze(),Il=_h.box,Is=_h.content;sd([Il,Is],De),hb([Il,Is],"visible")}q(),ne(),cb(ad,y),(yi=y.popperInstance)==null||yi.forceUpdate(),O("onMount",[y]),y.props.animation&&ve()&&kt(De,function(){y.state.isShown=!0,O("onShown",[y])})}},A()}}function Ne(){var P=!y.state.isVisible,Z=y.state.isDestroyed,le=!y.state.isEnabled,Re=id(y.props.duration,1,Fn.duration);if(!(P||Z||le)&&(O("onHide",[y],!1),y.props.onHide(y)!==!1)){if(y.state.isVisible=!1,y.state.isShown=!1,c=!1,o=!1,ve()&&(R.style.visibility="hidden"),me(),je(),T(!0),ve()){var De=ze(),Vt=De.box,vn=De.content;y.props.animation&&(sd([Vt,vn],Re),hb([Vt,vn],"hidden"))}q(),ne(),y.props.animation?ve()&&mt(Re,y.unmount):y.unmount()}}function wn(P){Oe().addEventListener("mousemove",p),cb($l,p),p(P)}function Ar(){y.state.isVisible&&y.hide(),y.state.isMounted&&(D(),F().forEach(function(P){P._tippy.unmount()}),R.parentNode&&R.parentNode.removeChild(R),ad=ad.filter(function(P){return P!==y}),y.state.isMounted=!1,O("onHidden",[y]))}function mi(){y.state.isDestroyed||(y.clearDelayTimeouts(),y.unmount(),b(),delete t._tippy,y.state.isDestroyed=!0,O("onDestroy",[y]))}}function Oo(t,e){e===void 0&&(e={});var n=Fn.plugins.concat(e.plugins||[]);tR();var r=Object.assign({},e,{plugins:n}),i=XD(t),s=i.reduce(function(o,a){var l=a&&hR(a,r);return l&&o.push(l),o},[]);return Hu(t)?s[0]:s}Oo.defaultProps=Fn;Oo.setDefaultProps=aR;Oo.currentInput=Qn;Object.assign({},HE,{effect:function(e){var n=e.state,r={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(n.elements.popper.style,r.popper),n.styles=r,n.elements.arrow&&Object.assign(n.elements.arrow.style,r.arrow)}});Oo.setDefaultProps({render:ix});class dR{constructor({editor:e,element:n,view:r,tippyOptions:i={},shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:o,state:a,from:l,to:c})=>{const{doc:u,selection:h}=a,{empty:d}=h,f=!u.textBetween(l,c).length&&zp(a.selection),p=this.element.contains(document.activeElement);return!(!(o.hasFocus()||p)||d||f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}(o==null?void 0:o.relatedTarget)&&((a=this.element.parentNode)===null||a===void 0?void 0:a.contains(o.relatedTarget))||this.hide()},this.editor=e,this.element=n,this.view=r,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.tippy||!n||(this.tippy=Oo(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",r=>{this.blurHandler({event:r})}))}update(e,n){var r,i,s;const{state:o,composing:a}=e,{doc:l,selection:c}=o,u=n&&n.doc.eq(l)&&n.selection.eq(c);if(a||u)return;this.createTooltip();const{ranges:h}=c,d=Math.min(...h.map(g=>g.$from.pos)),f=Math.max(...h.map(g=>g.$to.pos));if(!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:e,state:o,oldState:n,from:d,to:f}))){this.hide();return}(i=this.tippy)===null||i===void 0||i.setProps({getReferenceClientRect:((s=this.tippyOptions)===null||s===void 0?void 0:s.getReferenceClientRect)||(()=>{if(aN(o.selection)){const g=e.nodeDOM(d);if(g)return g.getBoundingClientRect()}return VE(e,d,f)})}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e;(e=this.tippy)===null||e===void 0||e.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const sx=t=>new Tt({key:typeof t.pluginKey=="string"?new ln(t.pluginKey):t.pluginKey,view:e=>new dR({view:e,...t})});Xt.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[sx({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});class fR{constructor({editor:e,element:n,view:r,tippyOptions:i={},shouldShow:s}){this.preventHide=!1,this.shouldShow=({view:o,state:a})=>{const{selection:l}=a,{$anchor:c,empty:u}=l,h=c.depth===1,d=c.parent.isTextblock&&!c.parent.type.spec.code&&!c.parent.textContent;return!(!o.hasFocus()||!u||!h||!d||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}(o==null?void 0:o.relatedTarget)&&((a=this.element.parentNode)===null||a===void 0?void 0:a.contains(o.relatedTarget))||this.hide()},this.editor=e,this.element=n,this.view=r,s&&(this.shouldShow=s),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=i,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:e}=this.editor.options,n=!!e.parentElement;this.tippy||!n||(this.tippy=Oo(e,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",r=>{this.blurHandler({event:r})}))}update(e,n){var r,i,s;const{state:o}=e,{doc:a,selection:l}=o,{from:c,to:u}=l;if(n&&n.doc.eq(a)&&n.selection.eq(l))return;if(this.createTooltip(),!((r=this.shouldShow)===null||r===void 0?void 0:r.call(this,{editor:this.editor,view:e,state:o,oldState:n}))){this.hide();return}(i=this.tippy)===null||i===void 0||i.setProps({getReferenceClientRect:((s=this.tippyOptions)===null||s===void 0?void 0:s.getReferenceClientRect)||(()=>VE(e,c,u))}),this.show()}show(){var e;(e=this.tippy)===null||e===void 0||e.show()}hide(){var e;(e=this.tippy)===null||e===void 0||e.hide()}destroy(){var e;(e=this.tippy)===null||e===void 0||e.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const ox=t=>new Tt({key:typeof t.pluginKey=="string"?new ln(t.pluginKey):t.pluginKey,view:e=>new fR({view:e,...t})});Xt.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[ox({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});const pR=sl({name:"BubbleMenu",props:{pluginKey:{type:null,default:"bubbleMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(t,{slots:e}){const n=yp(null);return Iu(()=>{const{pluginKey:r,editor:i,tippyOptions:s,shouldShow:o}=t;i.registerPlugin(sx({pluginKey:r,editor:i,element:n.value,tippyOptions:s,shouldShow:o}))}),ol(()=>{const{pluginKey:r,editor:i}=t;i.unregisterPlugin(r)}),()=>{var r;return ji("div",{ref:n},(r=e.default)===null||r===void 0?void 0:r.call(e))}}});function yb(t){return bk((e,n)=>({get(){return e(),t},set(r){t=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class gR extends LN{constructor(e={}){return super(e),this.vueRenderers=xu(new Map),this.contentComponent=null,this.reactiveState=yb(this.view.state),this.reactiveExtensionStorage=yb(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),fp(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,n){super.registerPlugin(e,n),this.reactiveState.value=this.view.state}unregisterPlugin(e){super.unregisterPlugin(e),this.reactiveState.value=this.view.state}}const mR=sl({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(t){const e=yp(),n=f0();return Rk(()=>{const r=t.editor;r&&r.options.element&&e.value&&jv(()=>{if(!e.value||!r.options.element.firstChild)return;const i=$v(e.value);e.value.append(...r.options.element.childNodes),r.contentComponent=n.ctx._,r.setOptions({element:i}),r.createNodeViews()})}),ol(()=>{const r=t.editor;if(!r||(r.isDestroyed||r.view.setProps({nodeViews:{}}),r.contentComponent=null,!r.options.element.firstChild))return;const i=document.createElement("div");i.append(...r.options.element.childNodes),r.setOptions({element:i})}),{rootEl:e}},render(){const t=[];return this.editor&&this.editor.vueRenderers.forEach(e=>{const n=ji(yI,{to:e.teleportElement,key:e.id},ji(e.component,{ref:e.id,...e.props}));t.push(n)}),ji("div",{ref:e=>{this.rootEl=e}},...t)}});sl({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(t,{slots:e}){const n=yp(null);return Iu(()=>{const{pluginKey:r,editor:i,tippyOptions:s,shouldShow:o}=t;i.registerPlugin(ox({pluginKey:r,editor:i,element:n.value,tippyOptions:s,shouldShow:o}))}),ol(()=>{const{pluginKey:r,editor:i}=t;i.unregisterPlugin(r)}),()=>{var r;return ji("div",{ref:n},(r=e.default)===null||r===void 0?void 0:r.call(e))}}});sl({props:{as:{type:String,default:"div"}},render(){return ji(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}});sl({props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var t,e;return ji(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t))}});const yR=/^\s*>\s$/,bR=at.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Kp({find:yR,type:this.type})]}}),wR=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,vR=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,ER=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,xR=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,SR=si.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[uo({find:wR,type:this.type}),uo({find:ER,type:this.type})]},addPasteRules(){return[ho({find:vR,type:this.type}),ho({find:xR,type:this.type})]}}),TR=/^\s*([-+*])\s$/,CR=at.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[Kp({find:TR,type:this.type})]}}),kR=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,IR=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,AR=si.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[uo({find:kR,type:this.type})]},addPasteRules(){return[ho({find:IR,type:this.type})]}}),_R=/^```([a-z]+)?[\s\n]$/,MR=/^~~~([a-z]+)?[\s\n]$/,ax=at.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,s=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",nt(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:t.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:s}=n;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0||r.nodeAt(a)?!1:t.commands.exitCode()}}},addInputRules(){return[pf({find:_R,type:this.type,getAttributes:t=>({language:t[1]})}),pf({find:MR,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Tt({key:new ln("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i==null?void 0:i.mode;if(!n||!s)return!1;const{tr:o}=t.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(pe.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(n.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),OR=at.create({name:"doc",topNode:!0,content:"block+"});function NR(t={}){return new Tt({view(e){return new DR(e,t)}})}class DR{constructor(e,n){this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=n.width||1,this.color=n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(r=>{let i=s=>{this[r](s)};return e.dom.addEventListener(r,i),{name:r,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n;if(!e.parent.inlineContent){let o=e.nodeBefore,a=e.nodeAfter;if(o||a){let l=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0)).getBoundingClientRect(),c=o?l.bottom:l.top;o&&a&&(c=(c+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:l.left,right:l.right,top:c-this.width/2,bottom:c+this.width/2}}}if(!n){let o=this.editorView.coordsAtPos(this.cursorPos);n={left:o.left-this.width/2,right:o.left+this.width/2,top:o.top,bottom:o.bottom}}let r=this.editorView.dom.offsetParent;this.element||(this.element=r.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color);let i,s;if(!r||r==document.body&&getComputedStyle(r).position=="static")i=-pageXOffset,s=-pageYOffset;else{let o=r.getBoundingClientRect();i=o.left-r.scrollLeft,s=o.top-r.scrollTop}this.element.style.left=n.left-i+"px",this.element.style.top=n.top-s+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,n):i;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&(o=F0(this.editorView.state.doc,o,this.editorView.dragging.slice),o==null))return this.setCursor(null);this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const RR=Xt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[NR(this.options)]}});class Je extends ue{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return Je.valid(r)?new Je(r):ue.near(r)}content(){return J.empty}eq(e){return e instanceof Je&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Je(e.resolve(n.pos))}getBookmark(){return new eg(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!PR(e)||!LR(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&Je.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let a=e.node(o);if(n>0?e.indexAfter(o)<a.childCount:e.index(o)>0){s=a.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=n;let l=e.doc.resolve(i);if(Je.valid(l))return l}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!fe.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*n),r=!1;continue e}break}s=o,i+=n;let a=e.doc.resolve(i);if(Je.valid(a))return a}return null}}}Je.prototype.visible=!1;Je.findFrom=Je.findGapCursorFrom;ue.jsonID("gapcursor",Je);class eg{constructor(e){this.pos=e}map(e){return new eg(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return Je.valid(n)?new Je(n):ue.near(n)}}function PR(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function LR(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function BR(){return new Tt({props:{decorations:UR,createSelectionBetween(t,e,n){return e.pos==n.pos&&Je.valid(n)?new Je(n):null},handleClick:VR,handleKeyDown:FR,handleDOMEvents:{beforeinput:$R}}})}const FR=Vp({ArrowLeft:Ul("horiz",-1),ArrowRight:Ul("horiz",1),ArrowUp:Ul("vert",-1),ArrowDown:Ul("vert",1)});function Ul(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof pe){if(!s.endOfTextblock(n)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Je.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new Je(c))),!0):!1}}function VR(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!Je.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&fe.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new Je(r))),!0)}function $R(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof Je))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=z.empty;for(let o=r.length-1;o>=0;o--)i=z.from(r[o].createAndFill(null,i));let s=t.state.tr.replace(n.pos,n.pos,new J(i,0,0));return s.setSelection(pe.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function UR(t){if(!(t.selection instanceof Je))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",et.create(t.doc,[Ht.widget(t.selection.head,e,{key:"gapcursor"})])}const zR=Xt.create({name:"gapCursor",addProseMirrorPlugins(){return[BR()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Se(re(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),HR=at.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",nt(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const h=l.filter(d=>a.includes(d.type.name));c.ensureMarks(h)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),jR=at.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,nt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>pf({find:new RegExp(`^(#{1,${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var Kc=200,xt=function(){};xt.prototype.append=function(e){return e.length?(e=xt.from(e),!this.length&&e||e.length<Kc&&this.leafAppend(e)||this.length<Kc&&e.leafPrepend(this)||this.appendInner(e)):this};xt.prototype.prepend=function(e){return e.length?xt.from(e).append(this):this};xt.prototype.appendInner=function(e){return new KR(this,e)};xt.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?xt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};xt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};xt.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};xt.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},n,r),i};xt.from=function(e){return e instanceof xt?e:e&&e.length?new lx(e):xt.empty};var lx=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,a){for(var l=s;l<o;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,a){for(var l=s-1;l>=o;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Kc)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Kc)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(xt);xt.empty=new lx([]);var KR=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(s,a),o)===!1||s>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,s)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(s,a)-a,o+a)===!1||s<a&&this.left.forEachInvertedInner(r,Math.min(i,a),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(xt),cx=xt;const qR=500;class Ln{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;n&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((h,d)=>{if(!h.step){i||(i=this.remapping(r,d+1),s=i.maps.length),s--,u.push(h);return}if(i){u.push(new Xn(h.map));let f=h.step.map(i.slice(s)),p;f&&o.maybeStep(f).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new Xn(p,void 0,void 0,c.length+u.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(h.step);if(h.selection)return a=i?h.selection.map(i.slice(s)):h.selection,l=new Ln(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,n,r,i){let s=[],o=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let h=e.steps[u].invert(e.docs[u]),d=new Xn(e.mapping.maps[u],h,n),f;(f=l&&l.merge(d))&&(d=f,u?s.pop():a=a.slice(0,a.length-1)),s.push(d),n&&(o++,n=void 0),i||(l=d)}let c=o-r.depth;return c>GR&&(a=WR(a,c),o-=c),new Ln(a.append(s),o)}remapping(e,n){let r=new Xs;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new Ln(this.items.append(e.map(n=>new Xn(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(d=>{d.selection&&a--},i);let l=n;this.items.forEach(d=>{let f=s.getMirror(--l);if(f==null)return;o=Math.min(o,f);let p=s.maps[f];if(d.step){let g=e.steps[f].invert(e.docs[f]),m=d.selection&&d.selection.map(s.slice(l+1,f));m&&a++,r.push(new Xn(p,g,m))}else r.push(new Xn(p))},i);let c=[];for(let d=n;d<o;d++)c.push(new Xn(s.maps[d]));let u=this.items.slice(0,i).append(c).append(r),h=new Ln(u,a);return h.emptyItemCount()>qR&&(h=h.compress(this.items.length-r.length)),h}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],s=0;return this.items.forEach((o,a)=>{if(a>=e)i.push(o),o.selection&&s++;else if(o.step){let l=o.step.map(n.slice(r)),c=l&&l.getMap();if(r--,c&&n.appendMap(c,r),l){let u=o.selection&&o.selection.map(n.slice(r));u&&s++;let h=new Xn(c.invert(),l,u),d,f=i.length-1;(d=i.length&&i[f].merge(h))?i[f]=d:i.push(h)}}else o.map&&r--},this.items.length,0),new Ln(cx.from(i.reverse()),s)}}Ln.empty=new Ln(cx.empty,0);function WR(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class Xn{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Xn(n.getMap().invert(),n,this.selection)}}}class Rr{constructor(e,n,r,i){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i}}const GR=20;function JR(t,e,n,r){let i=n.getMeta(Jr),s;if(i)return i.historyState;n.getMeta(YR)&&(t=new Rr(t.done,t.undone,null,0));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(Jr))return o.getMeta(Jr).redo?new Rr(t.done.addTransform(n,void 0,r,fc(e)),t.undone,bb(n.mapping.maps[n.steps.length-1]),t.prevTime):new Rr(t.done,t.undone.addTransform(n,void 0,r,fc(e)),null,t.prevTime);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.prevTime==0||!o&&(t.prevTime<(n.time||0)-r.newGroupDelay||!XR(n,t.prevRanges)),l=o?ld(t.prevRanges,n.mapping):bb(n.mapping.maps[n.steps.length-1]);return new Rr(t.done.addTransform(n,a?e.selection.getBookmark():void 0,r,fc(e)),Ln.empty,l,n.time)}else return(s=n.getMeta("rebased"))?new Rr(t.done.rebased(n,s),t.undone.rebased(n,s),ld(t.prevRanges,n.mapping),t.prevTime):new Rr(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),ld(t.prevRanges,n.mapping),t.prevTime)}function XR(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(n=!0)}),n}function bb(t){let e=[];return t.forEach((n,r,i,s)=>e.push(i,s)),e}function ld(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),s=e.map(t[r+1],-1);i<=s&&n.push(i,s)}return n}function ux(t,e,n,r){let i=fc(e),s=Jr.get(e).spec.config,o=(r?t.undone:t.done).popEvent(e,i);if(!o)return;let a=o.selection.resolve(o.transform.doc),l=(r?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),c=new Rr(r?l:o.remaining,r?o.remaining:l,null,0);n(o.transform.setSelection(a).setMeta(Jr,{redo:r,historyState:c}).scrollIntoView())}let cd=!1,wb=null;function fc(t){let e=t.plugins;if(wb!=e){cd=!1,wb=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){cd=!0;break}}return cd}const Jr=new ln("history"),YR=new ln("closeHistory");function QR(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Tt({key:Jr,state:{init(){return new Rr(Ln.empty,Ln.empty,null,0)},apply(e,n,r){return JR(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?hx:r=="historyRedo"?dx:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const hx=(t,e)=>{let n=Jr.getState(t);return!n||n.done.eventCount==0?!1:(e&&ux(n,t,e,!1),!0)},dx=(t,e)=>{let n=Jr.getState(t);return!n||n.undone.eventCount==0?!1:(e&&ux(n,t,e,!0),!0)},ZR=Xt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>hx(t,e),redo:()=>({state:t,dispatch:e})=>dx(t,e)}},addProseMirrorPlugins(){return[QR(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}}),eP=at.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",nt(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t})=>t().insertContent({type:this.name}).command(({tr:e,dispatch:n})=>{var r;if(n){const{$to:i}=e.selection,s=i.end();if(i.nodeAfter)e.setSelection(pe.create(e.doc,i.pos));else{const o=(r=i.parent.type.contentMatch.defaultType)===null||r===void 0?void 0:r.create();o&&(e.insert(s,o),e.setSelection(pe.create(e.doc,s)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[$E({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),tP=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,nP=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,rP=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,iP=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,sP=si.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[uo({find:tP,type:this.type}),uo({find:rP,type:this.type})]},addPasteRules(){return[ho({find:nP,type:this.type}),ho({find:iP,type:this.type})]}}),oP=at.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",nt(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),aP=/^(\d+)\.\s$/,lP=at.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",nt(this.options.HTMLAttributes,n),0]:["ol",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t})=>t.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[Kp({find:aP,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,e)=>e.childCount+e.attrs.start===+t[1]})]}}),cP=at.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),uP=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,hP=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,dP=si.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",nt(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[uo({find:uP,type:this.type})]},addPasteRules(){return[ho({find:hP,type:this.type})]}}),fP=at.create({name:"text",group:"inline"}),pP=Xt.create({name:"starterKit",addExtensions(){var t,e,n,r,i,s,o,a,l,c,u,h,d,f,p,g,m,w;const _=[];return this.options.blockquote!==!1&&_.push(bR.configure((t=this.options)===null||t===void 0?void 0:t.blockquote)),this.options.bold!==!1&&_.push(SR.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&_.push(CR.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&_.push(AR.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&_.push(ax.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&_.push(OR.configure((s=this.options)===null||s===void 0?void 0:s.document)),this.options.dropcursor!==!1&&_.push(RR.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&_.push(zR.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&_.push(HR.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&_.push(jR.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&_.push(ZR.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&_.push(eP.configure((h=this.options)===null||h===void 0?void 0:h.horizontalRule)),this.options.italic!==!1&&_.push(sP.configure((d=this.options)===null||d===void 0?void 0:d.italic)),this.options.listItem!==!1&&_.push(oP.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&_.push(lP.configure((p=this.options)===null||p===void 0?void 0:p.orderedList)),this.options.paragraph!==!1&&_.push(cP.configure((g=this.options)===null||g===void 0?void 0:g.paragraph)),this.options.strike!==!1&&_.push(dP.configure((m=this.options)===null||m===void 0?void 0:m.strike)),this.options.text!==!1&&_.push(fP.configure((w=this.options)===null||w===void 0?void 0:w.text)),_}});var tg={exports:{}};function ng(t){return t instanceof Map?t.clear=t.delete=t.set=function(){throw new Error("map is read-only")}:t instanceof Set&&(t.add=t.clear=t.delete=function(){throw new Error("set is read-only")}),Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(e){var n=t[e];typeof n=="object"&&!Object.isFrozen(n)&&ng(n)}),t}tg.exports=ng;tg.exports.default=ng;class vb{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function fx(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function zr(t,...e){const n=Object.create(null);for(const r in t)n[r]=t[r];return e.forEach(function(r){for(const i in r)n[i]=r[i]}),n}const gP="</span>",Eb=t=>!!t.scope||t.sublanguage&&t.language,mP=(t,{prefix:e})=>{if(t.includes(".")){const n=t.split(".");return[`${e}${n.shift()}`,...n.map((r,i)=>`${r}${"_".repeat(i+1)}`)].join(" ")}return`${e}${t}`};class yP{constructor(e,n){this.buffer="",this.classPrefix=n.classPrefix,e.walk(this)}addText(e){this.buffer+=fx(e)}openNode(e){if(!Eb(e))return;let n="";e.sublanguage?n=`language-${e.language}`:n=mP(e.scope,{prefix:this.classPrefix}),this.span(n)}closeNode(e){!Eb(e)||(this.buffer+=gP)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const xb=(t={})=>{const e={children:[]};return Object.assign(e,t),e};class rg{constructor(){this.rootNode=xb(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const n=xb({scope:e});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,n){return typeof n=="string"?e.addText(n):n.children&&(e.openNode(n),n.children.forEach(r=>this._walk(e,r)),e.closeNode(n)),e}static _collapse(e){typeof e!="string"&&(!e.children||(e.children.every(n=>typeof n=="string")?e.children=[e.children.join("")]:e.children.forEach(n=>{rg._collapse(n)})))}}class bP extends rg{constructor(e){super(),this.options=e}addKeyword(e,n){e!==""&&(this.openNode(n),this.addText(e),this.closeNode())}addText(e){e!==""&&this.add(e)}addSublanguage(e,n){const r=e.root;r.sublanguage=!0,r.language=n,this.add(r)}toHTML(){return new yP(this,this.options).value()}finalize(){return!0}}function Pa(t){return t?typeof t=="string"?t:t.source:null}function px(t){return bs("(?=",t,")")}function wP(t){return bs("(?:",t,")*")}function vP(t){return bs("(?:",t,")?")}function bs(...t){return t.map(n=>Pa(n)).join("")}function EP(t){const e=t[t.length-1];return typeof e=="object"&&e.constructor===Object?(t.splice(t.length-1,1),e):{}}function ig(...t){const e=EP(t);return"("+(e.capture?"":"?:")+t.map(r=>Pa(r)).join("|")+")"}function gx(t){return new RegExp(t.toString()+"|").exec("").length-1}function xP(t,e){const n=t&&t.exec(e);return n&&n.index===0}const SP=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function sg(t,{joinWith:e}){let n=0;return t.map(r=>{n+=1;const i=n;let s=Pa(r),o="";for(;s.length>0;){const a=SP.exec(s);if(!a){o+=s;break}o+=s.substring(0,a.index),s=s.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?o+="\\"+String(Number(a[1])+i):(o+=a[0],a[0]==="("&&n++)}return o}).map(r=>`(${r})`).join(e)}const TP=/\b\B/,mx="[a-zA-Z]\\w*",og="[a-zA-Z_]\\w*",yx="\\b\\d+(\\.\\d+)?",bx="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",wx="\\b(0b[01]+)",CP="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",kP=(t={})=>{const e=/^#![ ]*\//;return t.binary&&(t.begin=bs(e,/.*\b/,t.binary,/\b.*/)),zr({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(n,r)=>{n.index!==0&&r.ignoreMatch()}},t)},La={begin:"\\\\[\\s\\S]",relevance:0},IP={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[La]},AP={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[La]},_P={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},ju=function(t,e,n={}){const r=zr({scope:"comment",begin:t,end:e,contains:[]},n);r.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const i=ig("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return r.contains.push({begin:bs(/[ ]+/,"(",i,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),r},MP=ju("//","$"),OP=ju("/\\*","\\*/"),NP=ju("#","$"),DP={scope:"number",begin:yx,relevance:0},RP={scope:"number",begin:bx,relevance:0},PP={scope:"number",begin:wx,relevance:0},LP={begin:/(?=\/[^/\n]*\/)/,contains:[{scope:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[La,{begin:/\[/,end:/\]/,relevance:0,contains:[La]}]}]},BP={scope:"title",begin:mx,relevance:0},FP={scope:"title",begin:og,relevance:0},VP={begin:"\\.\\s*"+og,relevance:0},$P=function(t){return Object.assign(t,{"on:begin":(e,n)=>{n.data._beginMatch=e[1]},"on:end":(e,n)=>{n.data._beginMatch!==e[1]&&n.ignoreMatch()}})};var zl=Object.freeze({__proto__:null,MATCH_NOTHING_RE:TP,IDENT_RE:mx,UNDERSCORE_IDENT_RE:og,NUMBER_RE:yx,C_NUMBER_RE:bx,BINARY_NUMBER_RE:wx,RE_STARTERS_RE:CP,SHEBANG:kP,BACKSLASH_ESCAPE:La,APOS_STRING_MODE:IP,QUOTE_STRING_MODE:AP,PHRASAL_WORDS_MODE:_P,COMMENT:ju,C_LINE_COMMENT_MODE:MP,C_BLOCK_COMMENT_MODE:OP,HASH_COMMENT_MODE:NP,NUMBER_MODE:DP,C_NUMBER_MODE:RP,BINARY_NUMBER_MODE:PP,REGEXP_MODE:LP,TITLE_MODE:BP,UNDERSCORE_TITLE_MODE:FP,METHOD_GUARD:VP,END_SAME_AS_BEGIN:$P});function UP(t,e){t.input[t.index-1]==="."&&e.ignoreMatch()}function zP(t,e){t.className!==void 0&&(t.scope=t.className,delete t.className)}function HP(t,e){!e||!t.beginKeywords||(t.begin="\\b("+t.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",t.__beforeBegin=UP,t.keywords=t.keywords||t.beginKeywords,delete t.beginKeywords,t.relevance===void 0&&(t.relevance=0))}function jP(t,e){!Array.isArray(t.illegal)||(t.illegal=ig(...t.illegal))}function KP(t,e){if(!!t.match){if(t.begin||t.end)throw new Error("begin & end are not supported with match");t.begin=t.match,delete t.match}}function qP(t,e){t.relevance===void 0&&(t.relevance=1)}const WP=(t,e)=>{if(!t.beforeMatch)return;if(t.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},t);Object.keys(t).forEach(r=>{delete t[r]}),t.keywords=n.keywords,t.begin=bs(n.beforeMatch,px(n.begin)),t.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},t.relevance=0,delete n.beforeMatch},GP=["of","and","for","in","not","or","if","then","parent","list","value"],JP="keyword";function vx(t,e,n=JP){const r=Object.create(null);return typeof t=="string"?i(n,t.split(" ")):Array.isArray(t)?i(n,t):Object.keys(t).forEach(function(s){Object.assign(r,vx(t[s],e,s))}),r;function i(s,o){e&&(o=o.map(a=>a.toLowerCase())),o.forEach(function(a){const l=a.split("|");r[l[0]]=[s,XP(l[0],l[1])]})}}function XP(t,e){return e?Number(e):YP(t)?0:1}function YP(t){return GP.includes(t.toLowerCase())}const Sb={},Xi=t=>{console.error(t)},Tb=(t,...e)=>{console.log(`WARN: ${t}`,...e)},_s=(t,e)=>{Sb[`${t}/${e}`]||(console.log(`Deprecated as of ${t}. ${e}`),Sb[`${t}/${e}`]=!0)},qc=new Error;function Ex(t,e,{key:n}){let r=0;const i=t[n],s={},o={};for(let a=1;a<=e.length;a++)o[a+r]=i[a],s[a+r]=!0,r+=gx(e[a-1]);t[n]=o,t[n]._emit=s,t[n]._multi=!0}function QP(t){if(!!Array.isArray(t.begin)){if(t.skip||t.excludeBegin||t.returnBegin)throw Xi("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),qc;if(typeof t.beginScope!="object"||t.beginScope===null)throw Xi("beginScope must be object"),qc;Ex(t,t.begin,{key:"beginScope"}),t.begin=sg(t.begin,{joinWith:""})}}function ZP(t){if(!!Array.isArray(t.end)){if(t.skip||t.excludeEnd||t.returnEnd)throw Xi("skip, excludeEnd, returnEnd not compatible with endScope: {}"),qc;if(typeof t.endScope!="object"||t.endScope===null)throw Xi("endScope must be object"),qc;Ex(t,t.end,{key:"endScope"}),t.end=sg(t.end,{joinWith:""})}}function eL(t){t.scope&&typeof t.scope=="object"&&t.scope!==null&&(t.beginScope=t.scope,delete t.scope)}function tL(t){eL(t),typeof t.beginScope=="string"&&(t.beginScope={_wrap:t.beginScope}),typeof t.endScope=="string"&&(t.endScope={_wrap:t.endScope}),QP(t),ZP(t)}function nL(t){function e(o,a){return new RegExp(Pa(o),"m"+(t.case_insensitive?"i":"")+(t.unicodeRegex?"u":"")+(a?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=gx(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=e(sg(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const c=l.findIndex((h,d)=>d>0&&h!==void 0),u=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,u)}}class r{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new n;return this.rules.slice(a).forEach(([c,u])=>l.addRule(c,u)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(a);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function i(o){const a=new r;return o.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),o.terminatorEnd&&a.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&a.addRule(o.illegal,{type:"illegal"}),a}function s(o,a){const l=o;if(o.isCompiled)return l;[zP,KP,tL,WP].forEach(u=>u(o,a)),t.compilerExtensions.forEach(u=>u(o,a)),o.__beforeBegin=null,[HP,jP,qP].forEach(u=>u(o,a)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=vx(o.keywords,t.case_insensitive)),l.keywordPatternRe=e(c,!0),a&&(o.begin||(o.begin=/\B|\b/),l.beginRe=e(l.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(l.endRe=e(l.end)),l.terminatorEnd=Pa(l.end)||"",o.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(o.end?"|":"")+a.terminatorEnd)),o.illegal&&(l.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(u){return rL(u==="self"?o:u)})),o.contains.forEach(function(u){s(u,l)}),o.starts&&s(o.starts,a),l.matcher=i(l),l}if(t.compilerExtensions||(t.compilerExtensions=[]),t.contains&&t.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return t.classNameAliases=zr(t.classNameAliases||{}),s(t)}function xx(t){return t?t.endsWithParent||xx(t.starts):!1}function rL(t){return t.variants&&!t.cachedVariants&&(t.cachedVariants=t.variants.map(function(e){return zr(t,{variants:null},e)})),t.cachedVariants?t.cachedVariants:xx(t)?zr(t,{starts:t.starts?zr(t.starts):null}):Object.isFrozen(t)?zr(t):t}var iL="11.6.0";class sL extends Error{constructor(e,n){super(e),this.name="HTMLInjectionError",this.html=n}}const ud=fx,Cb=zr,kb=Symbol("nomatch"),oL=7,aL=function(t){const e=Object.create(null),n=Object.create(null),r=[];let i=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:bP};function l(v){return a.noHighlightRe.test(v)}function c(v){let T=v.className+" ";T+=v.parentNode?v.parentNode.className:"";const O=a.languageDetectRe.exec(T);if(O){const q=G(O[1]);return q||(Tb(s.replace("{}",O[1])),Tb("Falling back to no-highlight mode for this block.",v)),q?O[1]:"no-highlight"}return T.split(/\s+/).find(q=>l(q)||G(q))}function u(v,T,O){let q="",ne="";typeof T=="object"?(q=v,O=T.ignoreIllegals,ne=T.language):(_s("10.7.0","highlight(lang, code, ...args) has been deprecated."),_s("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),ne=v,q=T),O===void 0&&(O=!0);const me={code:q,language:ne};Oe("before:highlight",me);const xe=me.result?me.result:h(me.language,me.code,O);return xe.code=me.code,Oe("after:highlight",xe),xe}function h(v,T,O,q){const ne=Object.create(null);function me(x,C){return x.keywords[C]}function xe(){if(!S.keywords){D.addText(A);return}let x=0;S.keywordPatternRe.lastIndex=0;let C=S.keywordPatternRe.exec(A),V="";for(;C;){V+=A.substring(x,C.index);const H=I.case_insensitive?C[0].toLowerCase():C[0],ce=me(S,H);if(ce){const[Ne,wn]=ce;if(D.addText(V),V="",ne[H]=(ne[H]||0)+1,ne[H]<=oL&&(F+=wn),Ne.startsWith("_"))V+=C[0];else{const Ar=I.classNameAliases[Ne]||Ne;D.addKeyword(C[0],Ar)}}else V+=C[0];x=S.keywordPatternRe.lastIndex,C=S.keywordPatternRe.exec(A)}V+=A.substring(x),D.addText(V)}function Qe(){if(A==="")return;let x=null;if(typeof S.subLanguage=="string"){if(!e[S.subLanguage]){D.addText(A);return}x=h(S.subLanguage,A,!0,W[S.subLanguage]),W[S.subLanguage]=x._top}else x=f(A,S.subLanguage.length?S.subLanguage:null);S.relevance>0&&(F+=x.relevance),D.addSublanguage(x._emitter,x.language)}function ke(){S.subLanguage!=null?Qe():xe(),A=""}function Pe(x,C){let V=1;const H=C.length-1;for(;V<=H;){if(!x._emit[V]){V++;continue}const ce=I.classNameAliases[x[V]]||x[V],Ne=C[V];ce?D.addKeyword(Ne,ce):(A=Ne,xe(),A=""),V++}}function je(x,C){return x.scope&&typeof x.scope=="string"&&D.openNode(I.classNameAliases[x.scope]||x.scope),x.beginScope&&(x.beginScope._wrap?(D.addKeyword(A,I.classNameAliases[x.beginScope._wrap]||x.beginScope._wrap),A=""):x.beginScope._multi&&(Pe(x.beginScope,C),A="")),S=Object.create(x,{parent:{value:S}}),S}function mt(x,C,V){let H=xP(x.endRe,V);if(H){if(x["on:end"]){const ce=new vb(x);x["on:end"](C,ce),ce.isMatchIgnored&&(H=!1)}if(H){for(;x.endsParent&&x.parent;)x=x.parent;return x}}if(x.endsWithParent)return mt(x.parent,C,V)}function kt(x){return S.matcher.regexIndex===0?(A+=x[0],1):(te=!0,0)}function yt(x){const C=x[0],V=x.rule,H=new vb(V),ce=[V.__beforeBegin,V["on:begin"]];for(const Ne of ce)if(!!Ne&&(Ne(x,H),H.isMatchIgnored))return kt(C);return V.skip?A+=C:(V.excludeBegin&&(A+=C),ke(),!V.returnBegin&&!V.excludeBegin&&(A=C)),je(V,x),V.returnBegin?0:C.length}function It(x){const C=x[0],V=T.substring(x.index),H=mt(S,x,V);if(!H)return kb;const ce=S;S.endScope&&S.endScope._wrap?(ke(),D.addKeyword(C,S.endScope._wrap)):S.endScope&&S.endScope._multi?(ke(),Pe(S.endScope,x)):ce.skip?A+=C:(ce.returnEnd||ce.excludeEnd||(A+=C),ke(),ce.excludeEnd&&(A=C));do S.scope&&D.closeNode(),!S.skip&&!S.subLanguage&&(F+=S.relevance),S=S.parent;while(S!==H.parent);return H.starts&&je(H.starts,x),ce.returnEnd?0:C.length}function Yt(){const x=[];for(let C=S;C!==I;C=C.parent)C.scope&&x.unshift(C.scope);x.forEach(C=>D.openNode(C))}let b={};function E(x,C){const V=C&&C[0];if(A+=x,V==null)return ke(),0;if(b.type==="begin"&&C.type==="end"&&b.index===C.index&&V===""){if(A+=T.slice(C.index,C.index+1),!i){const H=new Error(`0 width match regex (${v})`);throw H.languageName=v,H.badRule=b.rule,H}return 1}if(b=C,C.type==="begin")return yt(C);if(C.type==="illegal"&&!O){const H=new Error('Illegal lexeme "'+V+'" for mode "'+(S.scope||"<unnamed>")+'"');throw H.mode=S,H}else if(C.type==="end"){const H=It(C);if(H!==kb)return H}if(C.type==="illegal"&&V==="")return 1;if(X>1e5&&X>C.index*3)throw new Error("potential infinite loop, way more iterations than matches");return A+=V,V.length}const I=G(v);if(!I)throw Xi(s.replace("{}",v)),new Error('Unknown language: "'+v+'"');const $=nL(I);let B="",S=q||$;const W={},D=new a.__emitter(a);Yt();let A="",F=0,Q=0,X=0,te=!1;try{for(S.matcher.considerAll();;){X++,te?te=!1:S.matcher.considerAll(),S.matcher.lastIndex=Q;const x=S.matcher.exec(T);if(!x)break;const C=T.substring(Q,x.index),V=E(C,x);Q=x.index+V}return E(T.substring(Q)),D.closeAllNodes(),D.finalize(),B=D.toHTML(),{language:v,value:B,relevance:F,illegal:!1,_emitter:D,_top:S}}catch(x){if(x.message&&x.message.includes("Illegal"))return{language:v,value:ud(T),illegal:!0,relevance:0,_illegalBy:{message:x.message,index:Q,context:T.slice(Q-100,Q+100),mode:x.mode,resultSoFar:B},_emitter:D};if(i)return{language:v,value:ud(T),illegal:!1,relevance:0,errorRaised:x,_emitter:D,_top:S};throw x}}function d(v){const T={value:ud(v),illegal:!1,relevance:0,_top:o,_emitter:new a.__emitter(a)};return T._emitter.addText(v),T}function f(v,T){T=T||a.languages||Object.keys(e);const O=d(v),q=T.filter(G).filter(he).map(ke=>h(ke,v,!1));q.unshift(O);const ne=q.sort((ke,Pe)=>{if(ke.relevance!==Pe.relevance)return Pe.relevance-ke.relevance;if(ke.language&&Pe.language){if(G(ke.language).supersetOf===Pe.language)return 1;if(G(Pe.language).supersetOf===ke.language)return-1}return 0}),[me,xe]=ne,Qe=me;return Qe.secondBest=xe,Qe}function p(v,T,O){const q=T&&n[T]||O;v.classList.add("hljs"),v.classList.add(`language-${q}`)}function g(v){let T=null;const O=c(v);if(l(O))return;if(Oe("before:highlightElement",{el:v,language:O}),v.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(v)),a.throwUnescapedHTML))throw new sL("One of your code blocks includes unescaped HTML.",v.innerHTML);T=v;const q=T.textContent,ne=O?u(q,{language:O,ignoreIllegals:!0}):f(q);v.innerHTML=ne.value,p(v,O,ne.language),v.result={language:ne.language,re:ne.relevance,relevance:ne.relevance},ne.secondBest&&(v.secondBest={language:ne.secondBest.language,relevance:ne.secondBest.relevance}),Oe("after:highlightElement",{el:v,result:ne,text:q})}function m(v){a=Cb(a,v)}const w=()=>{y(),_s("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function _(){y(),_s("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let M=!1;function y(){if(document.readyState==="loading"){M=!0;return}document.querySelectorAll(a.cssSelector).forEach(g)}function L(){M&&y()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",L,!1);function R(v,T){let O=null;try{O=T(t)}catch(q){if(Xi("Language definition for '{}' could not be registered.".replace("{}",v)),i)Xi(q);else throw q;O=o}O.name||(O.name=v),e[v]=O,O.rawDefinition=T.bind(null,t),O.aliases&&ie(O.aliases,{languageName:v})}function j(v){delete e[v];for(const T of Object.keys(n))n[T]===v&&delete n[T]}function N(){return Object.keys(e)}function G(v){return v=(v||"").toLowerCase(),e[v]||e[n[v]]}function ie(v,{languageName:T}){typeof v=="string"&&(v=[v]),v.forEach(O=>{n[O.toLowerCase()]=T})}function he(v){const T=G(v);return T&&!T.disableAutodetect}function ve(v){v["before:highlightBlock"]&&!v["before:highlightElement"]&&(v["before:highlightElement"]=T=>{v["before:highlightBlock"](Object.assign({block:T.el},T))}),v["after:highlightBlock"]&&!v["after:highlightElement"]&&(v["after:highlightElement"]=T=>{v["after:highlightBlock"](Object.assign({block:T.el},T))})}function Ee(v){ve(v),r.push(v)}function Oe(v,T){const O=v;r.forEach(function(q){q[O]&&q[O](T)})}function ze(v){return _s("10.7.0","highlightBlock will be removed entirely in v12.0"),_s("10.7.0","Please use highlightElement now."),g(v)}Object.assign(t,{highlight:u,highlightAuto:f,highlightAll:y,highlightElement:g,highlightBlock:ze,configure:m,initHighlighting:w,initHighlightingOnLoad:_,registerLanguage:R,unregisterLanguage:j,listLanguages:N,getLanguage:G,registerAliases:ie,autoDetection:he,inherit:Cb,addPlugin:Ee}),t.debugMode=function(){i=!1},t.safeMode=function(){i=!0},t.versionString=iL,t.regex={concat:bs,lookahead:px,either:ig,optional:vP,anyNumberOfTimes:wP};for(const v in zl)typeof zl[v]=="object"&&tg.exports(zl[v]);return Object.assign(t,zl),t};var Ba=aL({}),lL=Ba;Ba.HighlightJS=Ba;Ba.default=Ba;var cL=lL;function Sx(t,e=[]){return t.map(n=>{const r=[...e,...n.properties?n.properties.className:[]];return n.children?Sx(n.children,r):{text:n.value,classes:r}}).flat()}function Ib(t){return t.value||t.children||[]}function uL(t){return Boolean(cL.getLanguage(t))}function Ab({doc:t,name:e,lowlight:n,defaultLanguage:r}){const i=[];return df(t,s=>s.type.name===e).forEach(s=>{let o=s.pos+1;const a=s.node.attrs.language||r,l=n.listLanguages(),c=a&&(l.includes(a)||uL(a))?Ib(n.highlight(a,s.node.textContent)):Ib(n.highlightAuto(s.node.textContent));Sx(c).forEach(u=>{const h=o+u.text.length;if(u.classes.length){const d=Ht.inline(o,h,{class:u.classes.join(" ")});i.push(d)}o=h})}),et.create(t,i)}function hL(t){return typeof t=="function"}function dL({name:t,lowlight:e,defaultLanguage:n}){if(!["highlight","highlightAuto","listLanguages"].every(i=>hL(e[i])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const r=new Tt({key:new ln("lowlight"),state:{init:(i,{doc:s})=>Ab({doc:s,name:t,lowlight:e,defaultLanguage:n}),apply:(i,s,o,a)=>{const l=o.selection.$head.parent.type.name,c=a.selection.$head.parent.type.name,u=df(o.doc,d=>d.type.name===t),h=df(a.doc,d=>d.type.name===t);return i.docChanged&&([l,c].includes(t)||h.length!==u.length||i.steps.some(d=>d.from!==void 0&&d.to!==void 0&&u.some(f=>f.pos>=d.from&&f.pos+f.node.nodeSize<=d.to)))?Ab({doc:i.doc,name:t,lowlight:e,defaultLanguage:n}):s.map(i.mapping,i.doc)}},props:{decorations(i){return r.getState(i)}}});return r}const fL=ax.extend({addOptions(){var t;return{...(t=this.parent)===null||t===void 0?void 0:t.call(this),lowlight:{},defaultLanguage:null}},addProseMirrorPlugins(){var t;return[...((t=this.parent)===null||t===void 0?void 0:t.call(this))||[],dL({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}}),pL=t=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:t.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z][A-Za-z0-9_-]*/}}),gL=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","p","q","quote","samp","section","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],mL=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"],yL=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"],bL=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"],wL=["align-content","align-items","align-self","all","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","content-visibility","counter-increment","counter-reset","cue","cue-after","cue-before","cursor","direction","display","empty-cells","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-size","font-size-adjust","font-smoothing","font-stretch","font-style","font-synthesis","font-variant","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","inline-size","isolation","justify-content","left","letter-spacing","line-break","line-height","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-wrap","overflow-x","overflow-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page-break-after","page-break-before","page-break-inside","pause","pause-after","pause-before","perspective","perspective-origin","pointer-events","position","quotes","resize","rest","rest-after","rest-before","right","row-gap","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","speak","speak-as","src","tab-size","table-layout","text-align","text-align-all","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-transform","text-underline-position","top","transform","transform-box","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index"].reverse();function vL(t){const e=t.regex,n=pL(t),r={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},i="and or not only",s=/@-?\w[\w]*(-\w+)*/,o="[a-zA-Z-][a-zA-Z0-9_-]*",a=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:!0,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[n.BLOCK_COMMENT,r,n.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+o,relevance:0},n.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+yL.join("|")+")"},{begin:":(:)?("+bL.join("|")+")"}]},n.CSS_VARIABLE,{className:"attribute",begin:"\\b("+wL.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[n.BLOCK_COMMENT,n.HEXCOLOR,n.IMPORTANT,n.CSS_NUMBER_MODE,...a,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...a,{className:"string",begin:/[^)]/,endsWithParent:!0,excludeEnd:!0}]},n.FUNCTION_DISPATCH]},{begin:e.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:s},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:i,attribute:mL.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...a,n.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+gL.join("|")+")\\b"}]}}const _b="[A-Za-z$_][0-9A-Za-z$_]*",EL=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],xL=["true","false","null","undefined","NaN","Infinity"],Tx=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],Cx=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],kx=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],SL=["arguments","this","super","console","window","document","localStorage","module","global"],TL=[].concat(kx,Tx,Cx);function CL(t){const e=t.regex,n=(T,{after:O})=>{const q="</"+T[0].slice(1);return T.input.indexOf(q,O)!==-1},r=_b,i={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,o={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(T,O)=>{const q=T[0].length+T.index,ne=T.input[q];if(ne==="<"||ne===","){O.ignoreMatch();return}ne===">"&&(n(T,{after:q})||O.ignoreMatch());let me;if((me=T.input.substring(q).match(/^\s+extends\s+/))&&me.index===0){O.ignoreMatch();return}}},a={$pattern:_b,keyword:EL,literal:xL,built_in:TL,"variable.language":SL},l="[0-9](_?[0-9])*",c=`\\.(${l})`,u="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",h={className:"number",variants:[{begin:`(\\b(${u})((${c})|\\.)?|(${c}))[eE][+-]?(${l})\\b`},{begin:`\\b(${u})\\b((${c})\\b|\\.)?|(${c})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},d={className:"subst",begin:"\\$\\{",end:"\\}",keywords:a,contains:[]},f={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,d],subLanguage:"xml"}},p={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,d],subLanguage:"css"}},g={className:"string",begin:"`",end:"`",contains:[t.BACKSLASH_ESCAPE,d]},m=t.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:r+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),w={className:"comment",variants:[m,t.C_BLOCK_COMMENT_MODE,t.C_LINE_COMMENT_MODE]},_=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,f,p,g,h];d.contains=_.concat({begin:/\{/,end:/\}/,keywords:a,contains:["self"].concat(_)});const M=[].concat(w,d.contains),y=M.concat([{begin:/\(/,end:/\)/,keywords:a,contains:["self"].concat(M)}]),L={className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:a,contains:y},R={variants:[{match:[/class/,/\s+/,r,/\s+/,/extends/,/\s+/,e.concat(r,"(",e.concat(/\./,r),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,r],scope:{1:"keyword",3:"title.class"}}]},j={relevance:0,match:e.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...Tx,...Cx]}},N={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},G={variants:[{match:[/function/,/\s+/,r,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[L],illegal:/%/},ie={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function he(T){return e.concat("(?!",T.join("|"),")")}const ve={match:e.concat(/\b/,he([...kx,"super"]),r,e.lookahead(/\(/)),className:"title.function",relevance:0},Ee={begin:e.concat(/\./,e.lookahead(e.concat(r,/(?![0-9A-Za-z$_(])/))),end:r,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},Oe={match:[/get|set/,/\s+/,r,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},L]},ze="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+t.UNDERSCORE_IDENT_RE+")\\s*=>",v={match:[/const|var|let/,/\s+/,r,/\s*/,/=\s*/,/(async\s*)?/,e.lookahead(ze)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[L]};return{name:"Javascript",aliases:["js","jsx","mjs","cjs"],keywords:a,exports:{PARAMS_CONTAINS:y,CLASS_REFERENCE:j},illegal:/#(?![$_A-z])/,contains:[t.SHEBANG({label:"shebang",binary:"node",relevance:5}),N,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,f,p,g,w,h,j,{className:"attr",begin:r+e.lookahead(":"),relevance:0},v,{begin:"("+t.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[w,t.REGEXP_MODE,{className:"function",begin:ze,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:t.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:a,contains:y}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:i.begin,end:i.end},{match:s},{begin:o.begin,"on:begin":o.isTrulyOpeningTag,end:o.end}],subLanguage:"xml",contains:[{begin:o.begin,end:o.end,skip:!0,contains:["self"]}]}]},G,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+t.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[L,t.inherit(t.TITLE_MODE,{begin:r,className:"title.function"})]},{match:/\.\.\./,relevance:0},Ee,{match:"\\$"+r,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[L]},ve,ie,R,Oe,{match:/\$[(.]/}]}}const Wc="[A-Za-z$_][0-9A-Za-z$_]*",Ix=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends"],Ax=["true","false","null","undefined","NaN","Infinity"],_x=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],Mx=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],Ox=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],Nx=["arguments","this","super","console","window","document","localStorage","module","global"],Dx=[].concat(Ox,_x,Mx);function kL(t){const e=t.regex,n=(T,{after:O})=>{const q="</"+T[0].slice(1);return T.input.indexOf(q,O)!==-1},r=Wc,i={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,o={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(T,O)=>{const q=T[0].length+T.index,ne=T.input[q];if(ne==="<"||ne===","){O.ignoreMatch();return}ne===">"&&(n(T,{after:q})||O.ignoreMatch());let me;if((me=T.input.substring(q).match(/^\s+extends\s+/))&&me.index===0){O.ignoreMatch();return}}},a={$pattern:Wc,keyword:Ix,literal:Ax,built_in:Dx,"variable.language":Nx},l="[0-9](_?[0-9])*",c=`\\.(${l})`,u="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",h={className:"number",variants:[{begin:`(\\b(${u})((${c})|\\.)?|(${c}))[eE][+-]?(${l})\\b`},{begin:`\\b(${u})\\b((${c})\\b|\\.)?|(${c})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},d={className:"subst",begin:"\\$\\{",end:"\\}",keywords:a,contains:[]},f={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,d],subLanguage:"xml"}},p={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,d],subLanguage:"css"}},g={className:"string",begin:"`",end:"`",contains:[t.BACKSLASH_ESCAPE,d]},m=t.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:r+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),w={className:"comment",variants:[m,t.C_BLOCK_COMMENT_MODE,t.C_LINE_COMMENT_MODE]},_=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,f,p,g,h];d.contains=_.concat({begin:/\{/,end:/\}/,keywords:a,contains:["self"].concat(_)});const M=[].concat(w,d.contains),y=M.concat([{begin:/\(/,end:/\)/,keywords:a,contains:["self"].concat(M)}]),L={className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:a,contains:y},R={variants:[{match:[/class/,/\s+/,r,/\s+/,/extends/,/\s+/,e.concat(r,"(",e.concat(/\./,r),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,r],scope:{1:"keyword",3:"title.class"}}]},j={relevance:0,match:e.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[..._x,...Mx]}},N={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},G={variants:[{match:[/function/,/\s+/,r,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[L],illegal:/%/},ie={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function he(T){return e.concat("(?!",T.join("|"),")")}const ve={match:e.concat(/\b/,he([...Ox,"super"]),r,e.lookahead(/\(/)),className:"title.function",relevance:0},Ee={begin:e.concat(/\./,e.lookahead(e.concat(r,/(?![0-9A-Za-z$_(])/))),end:r,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},Oe={match:[/get|set/,/\s+/,r,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},L]},ze="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+t.UNDERSCORE_IDENT_RE+")\\s*=>",v={match:[/const|var|let/,/\s+/,r,/\s*/,/=\s*/,/(async\s*)?/,e.lookahead(ze)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[L]};return{name:"Javascript",aliases:["js","jsx","mjs","cjs"],keywords:a,exports:{PARAMS_CONTAINS:y,CLASS_REFERENCE:j},illegal:/#(?![$_A-z])/,contains:[t.SHEBANG({label:"shebang",binary:"node",relevance:5}),N,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,f,p,g,w,h,j,{className:"attr",begin:r+e.lookahead(":"),relevance:0},v,{begin:"("+t.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[w,t.REGEXP_MODE,{className:"function",begin:ze,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:t.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:a,contains:y}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:i.begin,end:i.end},{match:s},{begin:o.begin,"on:begin":o.isTrulyOpeningTag,end:o.end}],subLanguage:"xml",contains:[{begin:o.begin,end:o.end,skip:!0,contains:["self"]}]}]},G,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+t.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[L,t.inherit(t.TITLE_MODE,{begin:r,className:"title.function"})]},{match:/\.\.\./,relevance:0},Ee,{match:"\\$"+r,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[L]},ve,ie,R,Oe,{match:/\$[(.]/}]}}function IL(t){const e=kL(t),n=Wc,r=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],i={beginKeywords:"namespace",end:/\{/,excludeEnd:!0,contains:[e.exports.CLASS_REFERENCE]},s={beginKeywords:"interface",end:/\{/,excludeEnd:!0,keywords:{keyword:"interface extends",built_in:r},contains:[e.exports.CLASS_REFERENCE]},o={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},a=["type","namespace","interface","public","private","protected","implements","declare","abstract","readonly","enum","override"],l={$pattern:Wc,keyword:Ix.concat(a),literal:Ax,built_in:Dx.concat(r),"variable.language":Nx},c={className:"meta",begin:"@"+n},u=(d,f,p)=>{const g=d.contains.findIndex(m=>m.label===f);if(g===-1)throw new Error("can not find mode to replace");d.contains.splice(g,1,p)};Object.assign(e.keywords,l),e.exports.PARAMS_CONTAINS.push(c),e.contains=e.contains.concat([c,i,s]),u(e,"shebang",t.SHEBANG()),u(e,"use_strict",o);const h=e.contains.find(d=>d.label==="func.def");return h.relevance=0,Object.assign(e,{name:"TypeScript",aliases:["ts","tsx"]}),e}function AL(t){const e=t.regex,n=e.concat(/[\p{L}_]/u,e.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),r=/[\p{L}0-9._:-]+/u,i={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},s={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},o=t.inherit(s,{begin:/\(/,end:/\)/}),a=t.inherit(t.APOS_STRING_MODE,{className:"string"}),l=t.inherit(t.QUOTE_STRING_MODE,{className:"string"}),c={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:r,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[i]},{begin:/'/,end:/'/,contains:[i]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[s,l,a,o,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[s,o,l,a]}]}]},t.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},i,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[l]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[c],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[c],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:e.concat(/</,e.lookahead(e.concat(n,e.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:n,relevance:0,starts:c}]},{className:"tag",begin:e.concat(/<\//,e.lookahead(e.concat(n,/>/))),contains:[{className:"name",begin:n,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}var ag={exports:{}};function lg(t){return t instanceof Map?t.clear=t.delete=t.set=function(){throw new Error("map is read-only")}:t instanceof Set&&(t.add=t.clear=t.delete=function(){throw new Error("set is read-only")}),Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(e){var n=t[e];typeof n=="object"&&!Object.isFrozen(n)&&lg(n)}),t}ag.exports=lg;ag.exports.default=lg;class Mb{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function Rx(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function Hr(t,...e){const n=Object.create(null);for(const r in t)n[r]=t[r];return e.forEach(function(r){for(const i in r)n[i]=r[i]}),n}const _L="</span>",Ob=t=>!!t.scope||t.sublanguage&&t.language,ML=(t,{prefix:e})=>{if(t.includes(".")){const n=t.split(".");return[`${e}${n.shift()}`,...n.map((r,i)=>`${r}${"_".repeat(i+1)}`)].join(" ")}return`${e}${t}`};class OL{constructor(e,n){this.buffer="",this.classPrefix=n.classPrefix,e.walk(this)}addText(e){this.buffer+=Rx(e)}openNode(e){if(!Ob(e))return;let n="";e.sublanguage?n=`language-${e.language}`:n=ML(e.scope,{prefix:this.classPrefix}),this.span(n)}closeNode(e){!Ob(e)||(this.buffer+=_L)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const Nb=(t={})=>{const e={children:[]};return Object.assign(e,t),e};class cg{constructor(){this.rootNode=Nb(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const n=Nb({scope:e});this.add(n),this.stack.push(n)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,n){return typeof n=="string"?e.addText(n):n.children&&(e.openNode(n),n.children.forEach(r=>this._walk(e,r)),e.closeNode(n)),e}static _collapse(e){typeof e!="string"&&(!e.children||(e.children.every(n=>typeof n=="string")?e.children=[e.children.join("")]:e.children.forEach(n=>{cg._collapse(n)})))}}class NL extends cg{constructor(e){super(),this.options=e}addKeyword(e,n){e!==""&&(this.openNode(n),this.addText(e),this.closeNode())}addText(e){e!==""&&this.add(e)}addSublanguage(e,n){const r=e.root;r.sublanguage=!0,r.language=n,this.add(r)}toHTML(){return new OL(this,this.options).value()}finalize(){return!0}}function Fa(t){return t?typeof t=="string"?t:t.source:null}function Px(t){return ws("(?=",t,")")}function DL(t){return ws("(?:",t,")*")}function RL(t){return ws("(?:",t,")?")}function ws(...t){return t.map(n=>Fa(n)).join("")}function PL(t){const e=t[t.length-1];return typeof e=="object"&&e.constructor===Object?(t.splice(t.length-1,1),e):{}}function ug(...t){const e=PL(t);return"("+(e.capture?"":"?:")+t.map(r=>Fa(r)).join("|")+")"}function Lx(t){return new RegExp(t.toString()+"|").exec("").length-1}function LL(t,e){const n=t&&t.exec(e);return n&&n.index===0}const BL=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function hg(t,{joinWith:e}){let n=0;return t.map(r=>{n+=1;const i=n;let s=Fa(r),o="";for(;s.length>0;){const a=BL.exec(s);if(!a){o+=s;break}o+=s.substring(0,a.index),s=s.substring(a.index+a[0].length),a[0][0]==="\\"&&a[1]?o+="\\"+String(Number(a[1])+i):(o+=a[0],a[0]==="("&&n++)}return o}).map(r=>`(${r})`).join(e)}const FL=/\b\B/,Bx="[a-zA-Z]\\w*",dg="[a-zA-Z_]\\w*",Fx="\\b\\d+(\\.\\d+)?",Vx="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",$x="\\b(0b[01]+)",VL="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",$L=(t={})=>{const e=/^#![ ]*\//;return t.binary&&(t.begin=ws(e,/.*\b/,t.binary,/\b.*/)),Hr({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(n,r)=>{n.index!==0&&r.ignoreMatch()}},t)},Va={begin:"\\\\[\\s\\S]",relevance:0},UL={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Va]},zL={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Va]},HL={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},Ku=function(t,e,n={}){const r=Hr({scope:"comment",begin:t,end:e,contains:[]},n);r.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const i=ug("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return r.contains.push({begin:ws(/[ ]+/,"(",i,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),r},jL=Ku("//","$"),KL=Ku("/\\*","\\*/"),qL=Ku("#","$"),WL={scope:"number",begin:Fx,relevance:0},GL={scope:"number",begin:Vx,relevance:0},JL={scope:"number",begin:$x,relevance:0},XL={begin:/(?=\/[^/\n]*\/)/,contains:[{scope:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[Va,{begin:/\[/,end:/\]/,relevance:0,contains:[Va]}]}]},YL={scope:"title",begin:Bx,relevance:0},QL={scope:"title",begin:dg,relevance:0},ZL={begin:"\\.\\s*"+dg,relevance:0},eB=function(t){return Object.assign(t,{"on:begin":(e,n)=>{n.data._beginMatch=e[1]},"on:end":(e,n)=>{n.data._beginMatch!==e[1]&&n.ignoreMatch()}})};var Hl=Object.freeze({__proto__:null,MATCH_NOTHING_RE:FL,IDENT_RE:Bx,UNDERSCORE_IDENT_RE:dg,NUMBER_RE:Fx,C_NUMBER_RE:Vx,BINARY_NUMBER_RE:$x,RE_STARTERS_RE:VL,SHEBANG:$L,BACKSLASH_ESCAPE:Va,APOS_STRING_MODE:UL,QUOTE_STRING_MODE:zL,PHRASAL_WORDS_MODE:HL,COMMENT:Ku,C_LINE_COMMENT_MODE:jL,C_BLOCK_COMMENT_MODE:KL,HASH_COMMENT_MODE:qL,NUMBER_MODE:WL,C_NUMBER_MODE:GL,BINARY_NUMBER_MODE:JL,REGEXP_MODE:XL,TITLE_MODE:YL,UNDERSCORE_TITLE_MODE:QL,METHOD_GUARD:ZL,END_SAME_AS_BEGIN:eB});function tB(t,e){t.input[t.index-1]==="."&&e.ignoreMatch()}function nB(t,e){t.className!==void 0&&(t.scope=t.className,delete t.className)}function rB(t,e){!e||!t.beginKeywords||(t.begin="\\b("+t.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",t.__beforeBegin=tB,t.keywords=t.keywords||t.beginKeywords,delete t.beginKeywords,t.relevance===void 0&&(t.relevance=0))}function iB(t,e){!Array.isArray(t.illegal)||(t.illegal=ug(...t.illegal))}function sB(t,e){if(!!t.match){if(t.begin||t.end)throw new Error("begin & end are not supported with match");t.begin=t.match,delete t.match}}function oB(t,e){t.relevance===void 0&&(t.relevance=1)}const aB=(t,e)=>{if(!t.beforeMatch)return;if(t.starts)throw new Error("beforeMatch cannot be used with starts");const n=Object.assign({},t);Object.keys(t).forEach(r=>{delete t[r]}),t.keywords=n.keywords,t.begin=ws(n.beforeMatch,Px(n.begin)),t.starts={relevance:0,contains:[Object.assign(n,{endsParent:!0})]},t.relevance=0,delete n.beforeMatch},lB=["of","and","for","in","not","or","if","then","parent","list","value"],cB="keyword";function Ux(t,e,n=cB){const r=Object.create(null);return typeof t=="string"?i(n,t.split(" ")):Array.isArray(t)?i(n,t):Object.keys(t).forEach(function(s){Object.assign(r,Ux(t[s],e,s))}),r;function i(s,o){e&&(o=o.map(a=>a.toLowerCase())),o.forEach(function(a){const l=a.split("|");r[l[0]]=[s,uB(l[0],l[1])]})}}function uB(t,e){return e?Number(e):hB(t)?0:1}function hB(t){return lB.includes(t.toLowerCase())}const Db={},Yi=t=>{console.error(t)},Rb=(t,...e)=>{console.log(`WARN: ${t}`,...e)},Ms=(t,e)=>{Db[`${t}/${e}`]||(console.log(`Deprecated as of ${t}. ${e}`),Db[`${t}/${e}`]=!0)},Gc=new Error;function zx(t,e,{key:n}){let r=0;const i=t[n],s={},o={};for(let a=1;a<=e.length;a++)o[a+r]=i[a],s[a+r]=!0,r+=Lx(e[a-1]);t[n]=o,t[n]._emit=s,t[n]._multi=!0}function dB(t){if(!!Array.isArray(t.begin)){if(t.skip||t.excludeBegin||t.returnBegin)throw Yi("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Gc;if(typeof t.beginScope!="object"||t.beginScope===null)throw Yi("beginScope must be object"),Gc;zx(t,t.begin,{key:"beginScope"}),t.begin=hg(t.begin,{joinWith:""})}}function fB(t){if(!!Array.isArray(t.end)){if(t.skip||t.excludeEnd||t.returnEnd)throw Yi("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Gc;if(typeof t.endScope!="object"||t.endScope===null)throw Yi("endScope must be object"),Gc;zx(t,t.end,{key:"endScope"}),t.end=hg(t.end,{joinWith:""})}}function pB(t){t.scope&&typeof t.scope=="object"&&t.scope!==null&&(t.beginScope=t.scope,delete t.scope)}function gB(t){pB(t),typeof t.beginScope=="string"&&(t.beginScope={_wrap:t.beginScope}),typeof t.endScope=="string"&&(t.endScope={_wrap:t.endScope}),dB(t),fB(t)}function mB(t){function e(o,a){return new RegExp(Fa(o),"m"+(t.case_insensitive?"i":"")+(t.unicodeRegex?"u":"")+(a?"g":""))}class n{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(a,l){l.position=this.position++,this.matchIndexes[this.matchAt]=l,this.regexes.push([l,a]),this.matchAt+=Lx(a)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const a=this.regexes.map(l=>l[1]);this.matcherRe=e(hg(a,{joinWith:"|"}),!0),this.lastIndex=0}exec(a){this.matcherRe.lastIndex=this.lastIndex;const l=this.matcherRe.exec(a);if(!l)return null;const c=l.findIndex((h,d)=>d>0&&h!==void 0),u=this.matchIndexes[c];return l.splice(0,c),Object.assign(l,u)}}class r{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(a){if(this.multiRegexes[a])return this.multiRegexes[a];const l=new n;return this.rules.slice(a).forEach(([c,u])=>l.addRule(c,u)),l.compile(),this.multiRegexes[a]=l,l}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(a,l){this.rules.push([a,l]),l.type==="begin"&&this.count++}exec(a){const l=this.getMatcher(this.regexIndex);l.lastIndex=this.lastIndex;let c=l.exec(a);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(a)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function i(o){const a=new r;return o.contains.forEach(l=>a.addRule(l.begin,{rule:l,type:"begin"})),o.terminatorEnd&&a.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&a.addRule(o.illegal,{type:"illegal"}),a}function s(o,a){const l=o;if(o.isCompiled)return l;[nB,sB,gB,aB].forEach(u=>u(o,a)),t.compilerExtensions.forEach(u=>u(o,a)),o.__beforeBegin=null,[rB,iB,oB].forEach(u=>u(o,a)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=Ux(o.keywords,t.case_insensitive)),l.keywordPatternRe=e(c,!0),a&&(o.begin||(o.begin=/\B|\b/),l.beginRe=e(l.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(l.endRe=e(l.end)),l.terminatorEnd=Fa(l.end)||"",o.endsWithParent&&a.terminatorEnd&&(l.terminatorEnd+=(o.end?"|":"")+a.terminatorEnd)),o.illegal&&(l.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(u){return yB(u==="self"?o:u)})),o.contains.forEach(function(u){s(u,l)}),o.starts&&s(o.starts,a),l.matcher=i(l),l}if(t.compilerExtensions||(t.compilerExtensions=[]),t.contains&&t.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return t.classNameAliases=Hr(t.classNameAliases||{}),s(t)}function Hx(t){return t?t.endsWithParent||Hx(t.starts):!1}function yB(t){return t.variants&&!t.cachedVariants&&(t.cachedVariants=t.variants.map(function(e){return Hr(t,{variants:null},e)})),t.cachedVariants?t.cachedVariants:Hx(t)?Hr(t,{starts:t.starts?Hr(t.starts):null}):Object.isFrozen(t)?Hr(t):t}var bB="11.6.0";class wB extends Error{constructor(e,n){super(e),this.name="HTMLInjectionError",this.html=n}}const hd=Rx,Pb=Hr,Lb=Symbol("nomatch"),vB=7,EB=function(t){const e=Object.create(null),n=Object.create(null),r=[];let i=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let a={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:NL};function l(v){return a.noHighlightRe.test(v)}function c(v){let T=v.className+" ";T+=v.parentNode?v.parentNode.className:"";const O=a.languageDetectRe.exec(T);if(O){const q=G(O[1]);return q||(Rb(s.replace("{}",O[1])),Rb("Falling back to no-highlight mode for this block.",v)),q?O[1]:"no-highlight"}return T.split(/\s+/).find(q=>l(q)||G(q))}function u(v,T,O){let q="",ne="";typeof T=="object"?(q=v,O=T.ignoreIllegals,ne=T.language):(Ms("10.7.0","highlight(lang, code, ...args) has been deprecated."),Ms("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),ne=v,q=T),O===void 0&&(O=!0);const me={code:q,language:ne};Oe("before:highlight",me);const xe=me.result?me.result:h(me.language,me.code,O);return xe.code=me.code,Oe("after:highlight",xe),xe}function h(v,T,O,q){const ne=Object.create(null);function me(x,C){return x.keywords[C]}function xe(){if(!S.keywords){D.addText(A);return}let x=0;S.keywordPatternRe.lastIndex=0;let C=S.keywordPatternRe.exec(A),V="";for(;C;){V+=A.substring(x,C.index);const H=I.case_insensitive?C[0].toLowerCase():C[0],ce=me(S,H);if(ce){const[Ne,wn]=ce;if(D.addText(V),V="",ne[H]=(ne[H]||0)+1,ne[H]<=vB&&(F+=wn),Ne.startsWith("_"))V+=C[0];else{const Ar=I.classNameAliases[Ne]||Ne;D.addKeyword(C[0],Ar)}}else V+=C[0];x=S.keywordPatternRe.lastIndex,C=S.keywordPatternRe.exec(A)}V+=A.substring(x),D.addText(V)}function Qe(){if(A==="")return;let x=null;if(typeof S.subLanguage=="string"){if(!e[S.subLanguage]){D.addText(A);return}x=h(S.subLanguage,A,!0,W[S.subLanguage]),W[S.subLanguage]=x._top}else x=f(A,S.subLanguage.length?S.subLanguage:null);S.relevance>0&&(F+=x.relevance),D.addSublanguage(x._emitter,x.language)}function ke(){S.subLanguage!=null?Qe():xe(),A=""}function Pe(x,C){let V=1;const H=C.length-1;for(;V<=H;){if(!x._emit[V]){V++;continue}const ce=I.classNameAliases[x[V]]||x[V],Ne=C[V];ce?D.addKeyword(Ne,ce):(A=Ne,xe(),A=""),V++}}function je(x,C){return x.scope&&typeof x.scope=="string"&&D.openNode(I.classNameAliases[x.scope]||x.scope),x.beginScope&&(x.beginScope._wrap?(D.addKeyword(A,I.classNameAliases[x.beginScope._wrap]||x.beginScope._wrap),A=""):x.beginScope._multi&&(Pe(x.beginScope,C),A="")),S=Object.create(x,{parent:{value:S}}),S}function mt(x,C,V){let H=LL(x.endRe,V);if(H){if(x["on:end"]){const ce=new Mb(x);x["on:end"](C,ce),ce.isMatchIgnored&&(H=!1)}if(H){for(;x.endsParent&&x.parent;)x=x.parent;return x}}if(x.endsWithParent)return mt(x.parent,C,V)}function kt(x){return S.matcher.regexIndex===0?(A+=x[0],1):(te=!0,0)}function yt(x){const C=x[0],V=x.rule,H=new Mb(V),ce=[V.__beforeBegin,V["on:begin"]];for(const Ne of ce)if(!!Ne&&(Ne(x,H),H.isMatchIgnored))return kt(C);return V.skip?A+=C:(V.excludeBegin&&(A+=C),ke(),!V.returnBegin&&!V.excludeBegin&&(A=C)),je(V,x),V.returnBegin?0:C.length}function It(x){const C=x[0],V=T.substring(x.index),H=mt(S,x,V);if(!H)return Lb;const ce=S;S.endScope&&S.endScope._wrap?(ke(),D.addKeyword(C,S.endScope._wrap)):S.endScope&&S.endScope._multi?(ke(),Pe(S.endScope,x)):ce.skip?A+=C:(ce.returnEnd||ce.excludeEnd||(A+=C),ke(),ce.excludeEnd&&(A=C));do S.scope&&D.closeNode(),!S.skip&&!S.subLanguage&&(F+=S.relevance),S=S.parent;while(S!==H.parent);return H.starts&&je(H.starts,x),ce.returnEnd?0:C.length}function Yt(){const x=[];for(let C=S;C!==I;C=C.parent)C.scope&&x.unshift(C.scope);x.forEach(C=>D.openNode(C))}let b={};function E(x,C){const V=C&&C[0];if(A+=x,V==null)return ke(),0;if(b.type==="begin"&&C.type==="end"&&b.index===C.index&&V===""){if(A+=T.slice(C.index,C.index+1),!i){const H=new Error(`0 width match regex (${v})`);throw H.languageName=v,H.badRule=b.rule,H}return 1}if(b=C,C.type==="begin")return yt(C);if(C.type==="illegal"&&!O){const H=new Error('Illegal lexeme "'+V+'" for mode "'+(S.scope||"<unnamed>")+'"');throw H.mode=S,H}else if(C.type==="end"){const H=It(C);if(H!==Lb)return H}if(C.type==="illegal"&&V==="")return 1;if(X>1e5&&X>C.index*3)throw new Error("potential infinite loop, way more iterations than matches");return A+=V,V.length}const I=G(v);if(!I)throw Yi(s.replace("{}",v)),new Error('Unknown language: "'+v+'"');const $=mB(I);let B="",S=q||$;const W={},D=new a.__emitter(a);Yt();let A="",F=0,Q=0,X=0,te=!1;try{for(S.matcher.considerAll();;){X++,te?te=!1:S.matcher.considerAll(),S.matcher.lastIndex=Q;const x=S.matcher.exec(T);if(!x)break;const C=T.substring(Q,x.index),V=E(C,x);Q=x.index+V}return E(T.substring(Q)),D.closeAllNodes(),D.finalize(),B=D.toHTML(),{language:v,value:B,relevance:F,illegal:!1,_emitter:D,_top:S}}catch(x){if(x.message&&x.message.includes("Illegal"))return{language:v,value:hd(T),illegal:!0,relevance:0,_illegalBy:{message:x.message,index:Q,context:T.slice(Q-100,Q+100),mode:x.mode,resultSoFar:B},_emitter:D};if(i)return{language:v,value:hd(T),illegal:!1,relevance:0,errorRaised:x,_emitter:D,_top:S};throw x}}function d(v){const T={value:hd(v),illegal:!1,relevance:0,_top:o,_emitter:new a.__emitter(a)};return T._emitter.addText(v),T}function f(v,T){T=T||a.languages||Object.keys(e);const O=d(v),q=T.filter(G).filter(he).map(ke=>h(ke,v,!1));q.unshift(O);const ne=q.sort((ke,Pe)=>{if(ke.relevance!==Pe.relevance)return Pe.relevance-ke.relevance;if(ke.language&&Pe.language){if(G(ke.language).supersetOf===Pe.language)return 1;if(G(Pe.language).supersetOf===ke.language)return-1}return 0}),[me,xe]=ne,Qe=me;return Qe.secondBest=xe,Qe}function p(v,T,O){const q=T&&n[T]||O;v.classList.add("hljs"),v.classList.add(`language-${q}`)}function g(v){let T=null;const O=c(v);if(l(O))return;if(Oe("before:highlightElement",{el:v,language:O}),v.children.length>0&&(a.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(v)),a.throwUnescapedHTML))throw new wB("One of your code blocks includes unescaped HTML.",v.innerHTML);T=v;const q=T.textContent,ne=O?u(q,{language:O,ignoreIllegals:!0}):f(q);v.innerHTML=ne.value,p(v,O,ne.language),v.result={language:ne.language,re:ne.relevance,relevance:ne.relevance},ne.secondBest&&(v.secondBest={language:ne.secondBest.language,relevance:ne.secondBest.relevance}),Oe("after:highlightElement",{el:v,result:ne,text:q})}function m(v){a=Pb(a,v)}const w=()=>{y(),Ms("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function _(){y(),Ms("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let M=!1;function y(){if(document.readyState==="loading"){M=!0;return}document.querySelectorAll(a.cssSelector).forEach(g)}function L(){M&&y()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",L,!1);function R(v,T){let O=null;try{O=T(t)}catch(q){if(Yi("Language definition for '{}' could not be registered.".replace("{}",v)),i)Yi(q);else throw q;O=o}O.name||(O.name=v),e[v]=O,O.rawDefinition=T.bind(null,t),O.aliases&&ie(O.aliases,{languageName:v})}function j(v){delete e[v];for(const T of Object.keys(n))n[T]===v&&delete n[T]}function N(){return Object.keys(e)}function G(v){return v=(v||"").toLowerCase(),e[v]||e[n[v]]}function ie(v,{languageName:T}){typeof v=="string"&&(v=[v]),v.forEach(O=>{n[O.toLowerCase()]=T})}function he(v){const T=G(v);return T&&!T.disableAutodetect}function ve(v){v["before:highlightBlock"]&&!v["before:highlightElement"]&&(v["before:highlightElement"]=T=>{v["before:highlightBlock"](Object.assign({block:T.el},T))}),v["after:highlightBlock"]&&!v["after:highlightElement"]&&(v["after:highlightElement"]=T=>{v["after:highlightBlock"](Object.assign({block:T.el},T))})}function Ee(v){ve(v),r.push(v)}function Oe(v,T){const O=v;r.forEach(function(q){q[O]&&q[O](T)})}function ze(v){return Ms("10.7.0","highlightBlock will be removed entirely in v12.0"),Ms("10.7.0","Please use highlightElement now."),g(v)}Object.assign(t,{highlight:u,highlightAuto:f,highlightAll:y,highlightElement:g,highlightBlock:ze,configure:m,initHighlighting:w,initHighlightingOnLoad:_,registerLanguage:R,unregisterLanguage:j,listLanguages:N,getLanguage:G,registerAliases:ie,autoDetection:he,inherit:Pb,addPlugin:Ee}),t.debugMode=function(){i=!1},t.safeMode=function(){i=!0},t.versionString=bB,t.regex={concat:ws,lookahead:Px,either:ug,optional:RL,anyNumberOfTimes:DL};for(const v in Hl)typeof Hl[v]=="object"&&ag.exports(Hl[v]);return Object.assign(t,Hl),t};var $a=EB({}),xB=$a;$a.HighlightJS=$a;$a.default=$a;const Vn=xB;var jx={exports:{}};(function(t){(function(){var e;e=t.exports=i,e.format=i,e.vsprintf=r,typeof console<"u"&&typeof console.log=="function"&&(e.printf=n);function n(){console.log(i.apply(null,arguments))}function r(s,o){return i.apply(null,[s].concat(o))}function i(s){for(var o=1,a=[].slice.call(arguments),l=0,c=s.length,u="",h,d=!1,f,p,g=!1,m,w=function(){return a[o++]},_=function(){for(var M="";/\d/.test(s[l]);)M+=s[l++],h=s[l];return M.length>0?parseInt(M):null};l<c;++l)if(h=s[l],d)switch(d=!1,h=="."?(g=!1,h=s[++l]):h=="0"&&s[l+1]=="."?(g=!0,l+=2,h=s[l]):g=!0,m=_(),h){case"b":u+=parseInt(w(),10).toString(2);break;case"c":f=w(),typeof f=="string"||f instanceof String?u+=f:u+=String.fromCharCode(parseInt(f,10));break;case"d":u+=parseInt(w(),10);break;case"f":p=String(parseFloat(w()).toFixed(m||6)),u+=g?p:p.replace(/^0/,"");break;case"j":u+=JSON.stringify(w());break;case"o":u+="0"+parseInt(w(),10).toString(8);break;case"s":u+=w();break;case"x":u+="0x"+parseInt(w(),10).toString(16);break;case"X":u+="0x"+parseInt(w(),10).toString(16).toUpperCase();break;default:u+=h;break}else h==="%"?d=!0:u+=h;return u}})()})(jx);const SB=jx.exports,pc=Object.assign(vi(Error),{eval:vi(EvalError),range:vi(RangeError),reference:vi(ReferenceError),syntax:vi(SyntaxError),type:vi(TypeError),uri:vi(URIError)});function vi(t){return e.displayName=t.displayName||t.name,e;function e(n,...r){const i=n&&SB(n,...r);return new t(i)}}const TB={}.hasOwnProperty,CB="hljs-";function Kx(t,e,n={}){let r=n.prefix;if(typeof t!="string")throw pc("Expected `string` for name, got `%s`",t);if(!Vn.getLanguage(t))throw pc("Unknown language: `%s` is not registered",t);if(typeof e!="string")throw pc("Expected `string` for value, got `%s`",e);r==null&&(r=CB),Vn.configure({__emitter:OB,classPrefix:r});const i=Vn.highlight(e,{language:t,ignoreIllegals:!0});if(Vn.configure({}),i.errorRaised)throw i.errorRaised;return i._emitter.root.data.language=i.language,i._emitter.root.data.relevance=i.relevance,i._emitter.root}function kB(t,e={}){const n=e.subset||Vn.listLanguages();e.prefix;let r=-1,i={type:"root",data:{language:null,relevance:0},children:[]};if(typeof t!="string")throw pc("Expected `string` for value, got `%s`",t);for(;++r<n.length;){const s=n[r];if(!Vn.getLanguage(s))continue;const o=Kx(s,t,e);o.data.relevance>i.data.relevance&&(i=o)}return i}function IB(t,e){Vn.registerLanguage(t,e)}const AB=function(t,e){if(typeof t=="string")Vn.registerAliases(e,{languageName:t});else{let n;for(n in t)TB.call(t,n)&&Vn.registerAliases(t[n],{languageName:n})}};function _B(t){return Boolean(Vn.getLanguage(t))}function MB(){return Vn.listLanguages()}class OB{constructor(e){this.options=e,this.root={type:"root",data:{language:null,relevance:0},children:[]},this.stack=[this.root]}addText(e){if(e==="")return;const n=this.stack[this.stack.length-1],r=n.children[n.children.length-1];r&&r.type==="text"?r.value+=e:n.children.push({type:"text",value:e})}addKeyword(e,n){this.openNode(n),this.addText(e),this.closeNode()}addSublanguage(e,n){const r=this.stack[this.stack.length-1],i=e.root.children;n?r.children.push({type:"element",tagName:"span",properties:{className:[n]},children:i}):r.children.push(...i)}openNode(e){const n=e.split(".").map((s,o)=>o?s+"_".repeat(o):this.options.classPrefix+s),r=this.stack[this.stack.length-1],i={type:"element",tagName:"span",properties:{className:n},children:[]};r.children.push(i),this.stack.push(i)}closeNode(){this.stack.pop()}closeAllNodes(){}finalize(){}toHTML(){return""}}const ul={highlight:Kx,highlightAuto:kB,registerLanguage:IB,registered:_B,listLanguages:MB,registerAlias:AB};let wf,vf;if(typeof WeakMap<"u"){let t=new WeakMap;wf=e=>t.get(e),vf=(e,n)=>(t.set(e,n),n)}else{let t=[],e=10,n=0;wf=r=>{for(let i=0;i<t.length;i+=2)if(t[i]==r)return t[i+1]},vf=(r,i)=>(n==e&&(n=0),t[n++]=r,t[n++]=i)}class yo{constructor(e,n,r,i){this.left=e,this.top=n,this.right=r,this.bottom=i}}class Xe{constructor(e,n,r,i){this.width=e,this.height=n,this.map=r,this.problems=i}findCell(e){for(let n=0;n<this.map.length;n++){let r=this.map[n];if(r!=e)continue;let i=n%this.width,s=n/this.width|0,o=i+1,a=s+1;for(let l=1;o<this.width&&this.map[n+l]==r;l++)o++;for(let l=1;a<this.height&&this.map[n+this.width*l]==r;l++)a++;return new yo(i,s,o,a)}throw new RangeError("No cell with offset "+e+" found")}colCount(e){for(let n=0;n<this.map.length;n++)if(this.map[n]==e)return n%this.width;throw new RangeError("No cell with offset "+e+" found")}nextCell(e,n,r){let{left:i,right:s,top:o,bottom:a}=this.findCell(e);return n=="horiz"?(r<0?i==0:s==this.width)?null:this.map[o*this.width+(r<0?i-1:s)]:(r<0?o==0:a==this.height)?null:this.map[i+this.width*(r<0?o-1:a)]}rectBetween(e,n){let{left:r,right:i,top:s,bottom:o}=this.findCell(e),{left:a,right:l,top:c,bottom:u}=this.findCell(n);return new yo(Math.min(r,a),Math.min(s,c),Math.max(i,l),Math.max(o,u))}cellsInRect(e){let n=[],r={};for(let i=e.top;i<e.bottom;i++)for(let s=e.left;s<e.right;s++){let o=i*this.width+s,a=this.map[o];r[a]||(r[a]=!0,(s!=e.left||!s||this.map[o-1]!=a)&&(i!=e.top||!i||this.map[o-this.width]!=a)&&n.push(a))}return n}positionAt(e,n,r){for(let i=0,s=0;;i++){let o=s+r.child(i).nodeSize;if(i==e){let a=n+e*this.width,l=(e+1)*this.width;for(;a<l&&this.map[a]<s;)a++;return a==l?o-1:this.map[a]}s=o}}static get(e){return wf(e)||vf(e,NB(e))}}function NB(t){if(t.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+t.type.name);let e=DB(t),n=t.childCount,r=[],i=0,s=null,o=[];for(let c=0,u=e*n;c<u;c++)r[c]=0;for(let c=0,u=0;c<n;c++){let h=t.child(c);u++;for(let p=0;;p++){for(;i<r.length&&r[i]!=0;)i++;if(p==h.childCount)break;let g=h.child(p),{colspan:m,rowspan:w,colwidth:_}=g.attrs;for(let M=0;M<w;M++){if(M+c>=n){(s||(s=[])).push({type:"overlong_rowspan",pos:u,n:w-M});break}let y=i+M*e;for(let L=0;L<m;L++){r[y+L]==0?r[y+L]=u:(s||(s=[])).push({type:"collision",row:c,pos:u,n:m-L});let R=_&&_[L];if(R){let j=(y+L)%e*2,N=o[j];N==null||N!=R&&o[j+1]==1?(o[j]=R,o[j+1]=1):N==R&&o[j+1]++}}}i+=m,u+=g.nodeSize}let d=(c+1)*e,f=0;for(;i<d;)r[i++]==0&&f++;f&&(s||(s=[])).push({type:"missing",row:c,n:f}),u++}let a=new Xe(e,n,r,s),l=!1;for(let c=0;!l&&c<o.length;c+=2)o[c]!=null&&o[c+1]<n&&(l=!0);return l&&RB(a,o,t),a}function DB(t){let e=-1,n=!1;for(let r=0;r<t.childCount;r++){let i=t.child(r),s=0;if(n)for(let o=0;o<r;o++){let a=t.child(o);for(let l=0;l<a.childCount;l++){let c=a.child(l);o+c.attrs.rowspan>r&&(s+=c.attrs.colspan)}}for(let o=0;o<i.childCount;o++){let a=i.child(o);s+=a.attrs.colspan,a.attrs.rowspan>1&&(n=!0)}e==-1?e=s:e!=s&&(e=Math.max(e,s))}return e}function RB(t,e,n){t.problems||(t.problems=[]);for(let r=0,i={};r<t.map.length;r++){let s=t.map[r];if(i[s])continue;i[s]=!0;let o=n.nodeAt(s),a=null;for(let l=0;l<o.attrs.colspan;l++){let c=(r+l)%t.width,u=e[c*2];u!=null&&(!o.attrs.colwidth||o.attrs.colwidth[l]!=u)&&((a||(a=PB(o.attrs)))[l]=u)}a&&t.problems.unshift({type:"colwidth mismatch",pos:s,colwidth:a})}}function PB(t){if(t.colwidth)return t.colwidth.slice();let e=[];for(let n=0;n<t.colspan;n++)e.push(0);return e}function Ft(t){let e=t.cached.tableNodeTypes;if(!e){e=t.cached.tableNodeTypes={};for(let n in t.nodes){let r=t.nodes[n],i=r.spec.tableRole;i&&(e[i]=r)}}return e}const Lr=new ln("selectingCells");function No(t){for(let e=t.depth-1;e>0;e--)if(t.node(e).type.spec.tableRole=="row")return t.node(0).resolve(t.before(e+1));return null}function LB(t){for(let e=t.depth;e>0;e--){const n=t.node(e).type.spec.tableRole;if(n==="cell"||n==="header_cell")return t.node(e)}return null}function Wn(t){let e=t.selection.$head;for(let n=e.depth;n>0;n--)if(e.node(n).type.spec.tableRole=="row")return!0;return!1}function qu(t){let e=t.selection;return e.$anchorCell?e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell:e.node&&e.node.type.spec.tableRole=="cell"?e.$anchor:No(e.$head)||BB(e.$head)}function BB(t){for(let e=t.nodeAfter,n=t.pos;e;e=e.firstChild,n++){let r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n)}for(let e=t.nodeBefore,n=t.pos;e;e=e.lastChild,n--){let r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return t.doc.resolve(n-e.nodeSize)}}function Ef(t){return t.parent.type.spec.tableRole=="row"&&t.nodeAfter}function FB(t){return t.node(0).resolve(t.pos+t.nodeAfter.nodeSize)}function fg(t,e){return t.depth==e.depth&&t.pos>=e.start(-1)&&t.pos<=e.end(-1)}function qx(t,e,n){let r=t.start(-1),s=Xe.get(t.node(-1)).nextCell(t.pos-r,e,n);return s==null?null:t.node(0).resolve(r+s)}function ht(t,e,n){let r={};for(let i in t)r[i]=t[i];return r[e]=n,r}function as(t,e,n=1){let r=ht(t,"colspan",t.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,n),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}function Wx(t,e,n=1){let r=ht(t,"colspan",t.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(let i=0;i<n;i++)r.colwidth.splice(e,0,0)}return r}function VB(t,e,n){let r=Ft(e.type.schema).header_cell;for(let i=0;i<t.height;i++)if(e.nodeAt(t.map[n+i*t.width]).type!=r)return!1;return!0}class Ae extends ue{constructor(e,n=e){let r=e.node(-1),i=Xe.get(r),s=e.start(-1),o=i.rectBetween(e.pos-s,n.pos-s),a=e.node(0),l=i.cellsInRect(o).filter(u=>u!=n.pos-s);l.unshift(n.pos-s);let c=l.map(u=>{let h=r.nodeAt(u),d=u+s+1;return new j0(a.resolve(d),a.resolve(d+h.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=e,this.$headCell=n}map(e,n){let r=e.resolve(n.map(this.$anchorCell.pos)),i=e.resolve(n.map(this.$headCell.pos));if(Ef(r)&&Ef(i)&&fg(r,i)){let s=this.$anchorCell.node(-1)!=r.node(-1);return s&&this.isRowSelection()?Ae.rowSelection(r,i):s&&this.isColSelection()?Ae.colSelection(r,i):new Ae(r,i)}return pe.between(r,i)}content(){let e=this.$anchorCell.node(-1),n=Xe.get(e),r=this.$anchorCell.start(-1),i=n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),s={},o=[];for(let l=i.top;l<i.bottom;l++){let c=[];for(let u=l*n.width+i.left,h=i.left;h<i.right;h++,u++){let d=n.map[u];if(!s[d]){s[d]=!0;let f=n.findCell(d),p=e.nodeAt(d),g=i.left-f.left,m=f.right-i.right;if(g>0||m>0){let w=p.attrs;g>0&&(w=as(w,0,g)),m>0&&(w=as(w,w.colspan-m,m)),f.left<i.left?p=p.type.createAndFill(w):p=p.type.create(w,p.content)}if(f.top<i.top||f.bottom>i.bottom){let w=ht(p.attrs,"rowspan",Math.min(f.bottom,i.bottom)-Math.max(f.top,i.top));f.top<i.top?p=p.type.createAndFill(w):p=p.type.create(w,p.content)}c.push(p)}}o.push(e.child(l).copy(z.from(c)))}const a=this.isColSelection()&&this.isRowSelection()?e:o;return new J(z.from(a),1,1)}replace(e,n=J.empty){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:a,$to:l}=i[o],c=e.mapping.slice(r);e.replace(c.map(a.pos),c.map(l.pos),o?J.empty:n)}let s=ue.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);s&&e.setSelection(s)}replaceWith(e,n){this.replace(e,new J(z.from(n),0,0))}forEachCell(e){let n=this.$anchorCell.node(-1),r=Xe.get(n),i=this.$anchorCell.start(-1),s=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let o=0;o<s.length;o++)e(n.nodeAt(s[o]),i+s[o])}isColSelection(){let e=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(e,n)>0)return!1;let r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,n=e){let r=Xe.get(e.node(-1)),i=e.start(-1),s=r.findCell(e.pos-i),o=r.findCell(n.pos-i),a=e.node(0);return s.top<=o.top?(s.top>0&&(e=a.resolve(i+r.map[s.left])),o.bottom<r.height&&(n=a.resolve(i+r.map[r.width*(r.height-1)+o.right-1]))):(o.top>0&&(n=a.resolve(i+r.map[o.left])),s.bottom<r.height&&(e=a.resolve(i+r.map[r.width*(r.height-1)+s.right-1]))),new Ae(e,n)}isRowSelection(){let e=Xe.get(this.$anchorCell.node(-1)),n=this.$anchorCell.start(-1),r=e.colCount(this.$anchorCell.pos-n),i=e.colCount(this.$headCell.pos-n);if(Math.min(r,i)>0)return!1;let s=r+this.$anchorCell.nodeAfter.attrs.colspan,o=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,o)==e.width}eq(e){return e instanceof Ae&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,n=e){let r=Xe.get(e.node(-1)),i=e.start(-1),s=r.findCell(e.pos-i),o=r.findCell(n.pos-i),a=e.node(0);return s.left<=o.left?(s.left>0&&(e=a.resolve(i+r.map[s.top*r.width])),o.right<r.width&&(n=a.resolve(i+r.map[r.width*(o.top+1)-1]))):(o.left>0&&(n=a.resolve(i+r.map[o.top*r.width])),s.right<r.width&&(e=a.resolve(i+r.map[r.width*(s.top+1)-1]))),new Ae(e,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,n){return new Ae(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){return new Ae(e.resolve(n),e.resolve(r))}getBookmark(){return new pg(this.$anchorCell.pos,this.$headCell.pos)}}Ae.prototype.visible=!1;ue.jsonID("cell",Ae);class pg{constructor(e,n){this.anchor=e,this.head=n}map(e){return new pg(e.map(this.anchor),e.map(this.head))}resolve(e){let n=e.resolve(this.anchor),r=e.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&r.index()<r.parent.childCount&&fg(n,r)?new Ae(n,r):ue.near(r,1)}}function $B(t){if(!(t.selection instanceof Ae))return null;let e=[];return t.selection.forEachCell((n,r)=>{e.push(Ht.node(r,r+n.nodeSize,{class:"selectedCell"}))}),et.create(t.doc,e)}function UB({$from:t,$to:e}){if(t.pos==e.pos||t.pos<t.pos-6)return!1;let n=t.pos,r=e.pos,i=t.depth;for(;i>=0&&!(t.after(i+1)<t.end(i));i--,n++);for(let s=e.depth;s>=0&&!(e.before(s+1)>e.start(s));s--,r--);return n==r&&/row|table/.test(t.node(i).type.spec.tableRole)}function zB({$from:t,$to:e}){let n,r;for(let i=t.depth;i>0;i--){let s=t.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){n=s;break}}for(let i=e.depth;i>0;i--){let s=e.node(i);if(s.type.spec.tableRole==="cell"||s.type.spec.tableRole==="header_cell"){r=s;break}}return n!==r&&e.parentOffset===0}function HB(t,e,n){let r=(e||t).selection,i=(e||t).doc,s,o;if(r instanceof fe&&(o=r.node.type.spec.tableRole)){if(o=="cell"||o=="header_cell")s=Ae.create(i,r.from);else if(o=="row"){let a=i.resolve(r.from+1);s=Ae.rowSelection(a,a)}else if(!n){let a=Xe.get(r.node),l=r.from+1,c=l+a.map[a.width*a.height-1];s=Ae.create(i,l+1,c)}}else r instanceof pe&&UB(r)?s=pe.create(i,r.from):r instanceof pe&&zB(r)&&(s=pe.create(i,r.$from.start(),r.$from.end()));return s&&(e||(e=t.tr)).setSelection(s),e}function jB(t){if(!t.size)return null;let{content:e,openStart:n,openEnd:r}=t;for(;e.childCount==1&&(n>0&&r>0||e.firstChild.type.spec.tableRole=="table");)n--,r--,e=e.firstChild.content;let i=e.firstChild,s=i.type.spec.tableRole,o=i.type.schema,a=[];if(s=="row")for(let l=0;l<e.childCount;l++){let c=e.child(l).content,u=l?0:Math.max(0,n-1),h=l<e.childCount-1?0:Math.max(0,r-1);(u||h)&&(c=xf(Ft(o).row,new J(c,u,h)).content),a.push(c)}else if(s=="cell"||s=="header_cell")a.push(n||r?xf(Ft(o).row,new J(e,n,r)).content:e);else return null;return KB(o,a)}function KB(t,e){let n=[];for(let i=0;i<e.length;i++){let s=e[i];for(let o=s.childCount-1;o>=0;o--){let{rowspan:a,colspan:l}=s.child(o).attrs;for(let c=i;c<i+a;c++)n[c]=(n[c]||0)+l}}let r=0;for(let i=0;i<n.length;i++)r=Math.max(r,n[i]);for(let i=0;i<n.length;i++)if(i>=e.length&&e.push(z.empty),n[i]<r){let s=Ft(t).cell.createAndFill(),o=[];for(let a=n[i];a<r;a++)o.push(s);e[i]=e[i].append(z.from(o))}return{height:e.length,width:r,rows:e}}function xf(t,e){let n=t.createAndFill();return new H0(n).replace(0,n.content.size,e).doc}function qB({width:t,height:e,rows:n},r,i){if(t!=r){let s=[],o=[];for(let a=0;a<n.length;a++){let l=n[a],c=[];for(let u=s[a]||0,h=0;u<r;h++){let d=l.child(h%l.childCount);u+d.attrs.colspan>r&&(d=d.type.create(as(d.attrs,d.attrs.colspan,u+d.attrs.colspan-r),d.content)),c.push(d),u+=d.attrs.colspan;for(let f=1;f<d.attrs.rowspan;f++)s[a+f]=(s[a+f]||0)+d.attrs.colspan}o.push(z.from(c))}n=o,t=r}if(e!=i){let s=[];for(let o=0,a=0;o<i;o++,a++){let l=[],c=n[a%e];for(let u=0;u<c.childCount;u++){let h=c.child(u);o+h.attrs.rowspan>i&&(h=h.type.create(ht(h.attrs,"rowspan",Math.max(1,i-h.attrs.rowspan)),h.content)),l.push(h)}s.push(z.from(l))}n=s,e=i}return{width:t,height:e,rows:n}}function WB(t,e,n,r,i,s,o){let a=t.doc.type.schema,l=Ft(a),c,u;if(i>e.width)for(let h=0,d=0;h<e.height;h++){let f=n.child(h);d+=f.nodeSize;let p=[],g;f.lastChild==null||f.lastChild.type==l.cell?g=c||(c=l.cell.createAndFill()):g=u||(u=l.header_cell.createAndFill());for(let m=e.width;m<i;m++)p.push(g);t.insert(t.mapping.slice(o).map(d-1+r),p)}if(s>e.height){let h=[];for(let p=0,g=(e.height-1)*e.width;p<Math.max(e.width,i);p++){let m=p>=e.width?!1:n.nodeAt(e.map[g+p]).type==l.header_cell;h.push(m?u||(u=l.header_cell.createAndFill()):c||(c=l.cell.createAndFill()))}let d=l.row.create(null,z.from(h)),f=[];for(let p=e.height;p<s;p++)f.push(d);t.insert(t.mapping.slice(o).map(r+n.nodeSize-2),f)}return!!(c||u)}function Bb(t,e,n,r,i,s,o,a){if(o==0||o==e.height)return!1;let l=!1;for(let c=i;c<s;c++){let u=o*e.width+c,h=e.map[u];if(e.map[u-e.width]==h){l=!0;let d=n.nodeAt(h),{top:f,left:p}=e.findCell(h);t.setNodeMarkup(t.mapping.slice(a).map(h+r),null,ht(d.attrs,"rowspan",o-f)),t.insert(t.mapping.slice(a).map(e.positionAt(o,p,n)),d.type.createAndFill(ht(d.attrs,"rowspan",f+d.attrs.rowspan-o))),c+=d.attrs.colspan-1}}return l}function Fb(t,e,n,r,i,s,o,a){if(o==0||o==e.width)return!1;let l=!1;for(let c=i;c<s;c++){let u=c*e.width+o,h=e.map[u];if(e.map[u-1]==h){l=!0;let d=n.nodeAt(h),f=e.colCount(h),p=t.mapping.slice(a).map(h+r);t.setNodeMarkup(p,null,as(d.attrs,o-f,d.attrs.colspan-(o-f))),t.insert(p+d.nodeSize,d.type.createAndFill(as(d.attrs,0,o-f))),c+=d.attrs.rowspan-1}}return l}function Vb(t,e,n,r,i){let s=n?t.doc.nodeAt(n-1):t.doc,o=Xe.get(s),{top:a,left:l}=r,c=l+i.width,u=a+i.height,h=t.tr,d=0;function f(){s=n?h.doc.nodeAt(n-1):h.doc,o=Xe.get(s),d=h.mapping.maps.length}WB(h,o,s,n,c,u,d)&&f(),Bb(h,o,s,n,l,c,a,d)&&f(),Bb(h,o,s,n,l,c,u,d)&&f(),Fb(h,o,s,n,a,u,l,d)&&f(),Fb(h,o,s,n,a,u,c,d)&&f();for(let p=a;p<u;p++){let g=o.positionAt(p,l,s),m=o.positionAt(p,c,s);h.replace(h.mapping.slice(d).map(g+n),h.mapping.slice(d).map(m+n),new J(i.rows[p-a],0,0))}f(),h.setSelection(new Ae(h.doc.resolve(n+o.positionAt(a,l,s)),h.doc.resolve(n+o.positionAt(u-1,c-1,s)))),e(h)}const GB=Vp({ArrowLeft:jl("horiz",-1),ArrowRight:jl("horiz",1),ArrowUp:jl("vert",-1),ArrowDown:jl("vert",1),"Shift-ArrowLeft":Kl("horiz",-1),"Shift-ArrowRight":Kl("horiz",1),"Shift-ArrowUp":Kl("vert",-1),"Shift-ArrowDown":Kl("vert",1),Backspace:ql,"Mod-Backspace":ql,Delete:ql,"Mod-Delete":ql});function gc(t,e,n){return n.eq(t.selection)?!1:(e&&e(t.tr.setSelection(n).scrollIntoView()),!0)}function jl(t,e){return(n,r,i)=>{let s=n.selection;if(s instanceof Ae)return gc(n,r,ue.near(s.$headCell,e));if(t!="horiz"&&!s.empty)return!1;let o=Gx(i,t,e);if(o==null)return!1;if(t=="horiz")return gc(n,r,ue.near(n.doc.resolve(s.head+e),e));{let a=n.doc.resolve(o),l=qx(a,t,e),c;return l?c=ue.near(l,1):e<0?c=ue.near(n.doc.resolve(a.before(-1)),-1):c=ue.near(n.doc.resolve(a.after(-1)),1),gc(n,r,c)}}}function Kl(t,e){return(n,r,i)=>{let s=n.selection;if(!(s instanceof Ae)){let a=Gx(i,t,e);if(a==null)return!1;s=new Ae(n.doc.resolve(a))}let o=qx(s.$headCell,t,e);return o?gc(n,r,new Ae(s.$anchorCell,o)):!1}}function ql(t,e){let n=t.selection;if(!(n instanceof Ae))return!1;if(e){let r=t.tr,i=Ft(t.schema).cell.createAndFill().content;n.forEachCell((s,o)=>{s.content.eq(i)||r.replace(r.mapping.map(o+1),r.mapping.map(o+s.nodeSize-1),new J(i,0,0))}),r.docChanged&&e(r)}return!0}function JB(t,e){let n=t.state.doc,r=No(n.resolve(e));return r?(t.dispatch(t.state.tr.setSelection(new Ae(r))),!0):!1}function XB(t,e,n){if(!Wn(t.state))return!1;let r=jB(n),i=t.state.selection;if(i instanceof Ae){r||(r={width:1,height:1,rows:[z.from(xf(Ft(t.state.schema).cell,n))]});let s=i.$anchorCell.node(-1),o=i.$anchorCell.start(-1),a=Xe.get(s).rectBetween(i.$anchorCell.pos-o,i.$headCell.pos-o);return r=qB(r,a.right-a.left,a.bottom-a.top),Vb(t.state,t.dispatch,o,a,r),!0}else if(r){let s=qu(t.state),o=s.start(-1);return Vb(t.state,t.dispatch,o,Xe.get(s.node(-1)).findCell(s.pos-o),r),!0}else return!1}function YB(t,e){if(e.ctrlKey||e.metaKey)return;let n=$b(t,e.target),r;if(e.shiftKey&&t.state.selection instanceof Ae)i(t.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&n&&(r=No(t.state.selection.$anchor))!=null&&dd(t,e).pos!=r.pos)i(r,e),e.preventDefault();else if(!n)return;function i(a,l){let c=dd(t,l),u=Lr.getState(t.state)==null;if(!c||!fg(a,c))if(u)c=a;else return;let h=new Ae(a,c);if(u||!t.state.selection.eq(h)){let d=t.state.tr.setSelection(h);u&&d.setMeta(Lr,a.pos),t.dispatch(d)}}function s(){t.root.removeEventListener("mouseup",s),t.root.removeEventListener("dragstart",s),t.root.removeEventListener("mousemove",o),Lr.getState(t.state)!=null&&t.dispatch(t.state.tr.setMeta(Lr,-1))}function o(a){let l=Lr.getState(t.state),c;if(l!=null)c=t.state.doc.resolve(l);else if($b(t,a.target)!=n&&(c=dd(t,e),!c))return s();c&&i(c,a)}t.root.addEventListener("mouseup",s),t.root.addEventListener("dragstart",s),t.root.addEventListener("mousemove",o)}function Gx(t,e,n){if(!(t.state.selection instanceof pe))return null;let{$head:r}=t.state.selection;for(let i=r.depth-1;i>=0;i--){let s=r.node(i);if((n<0?r.index(i):r.indexAfter(i))!=(n<0?0:s.childCount))return null;if(s.type.spec.tableRole=="cell"||s.type.spec.tableRole=="header_cell"){let a=r.before(i),l=e=="vert"?n>0?"down":"up":n>0?"right":"left";return t.endOfTextblock(l)?a:null}}return null}function $b(t,e){for(;e&&e!=t.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e}function dd(t,e){let n=t.posAtCoords({left:e.clientX,top:e.clientY});return n&&n?No(t.state.doc.resolve(n.pos)):null}const QB=new ln("fix-tables");function Jx(t,e,n,r){let i=t.childCount,s=e.childCount;e:for(let o=0,a=0;o<s;o++){let l=e.child(o);for(let c=a,u=Math.min(i,o+3);c<u;c++)if(t.child(c)==l){a=c+1,n+=l.nodeSize;continue e}r(l,n),a<i&&t.child(a).sameMarkup(l)?Jx(t.child(a),l,n+1,r):l.nodesBetween(0,l.content.size,r,n+1),n+=l.nodeSize}}function Xx(t,e){let n,r=(i,s)=>{i.type.spec.tableRole=="table"&&(n=ZB(t,i,s,n))};return e?e.doc!=t.doc&&Jx(e.doc,t.doc,0,r):t.doc.descendants(r),n}function ZB(t,e,n,r){let i=Xe.get(e);if(!i.problems)return r;r||(r=t.tr);let s=[];for(let l=0;l<i.height;l++)s.push(0);for(let l=0;l<i.problems.length;l++){let c=i.problems[l];if(c.type=="collision"){let u=e.nodeAt(c.pos);for(let h=0;h<u.attrs.rowspan;h++)s[c.row+h]+=c.n;r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,as(u.attrs,u.attrs.colspan-c.n,c.n))}else if(c.type=="missing")s[c.row]+=c.n;else if(c.type=="overlong_rowspan"){let u=e.nodeAt(c.pos);r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,ht(u.attrs,"rowspan",u.attrs.rowspan-c.n))}else if(c.type=="colwidth mismatch"){let u=e.nodeAt(c.pos);r.setNodeMarkup(r.mapping.map(n+1+c.pos),null,ht(u.attrs,"colwidth",c.colwidth))}}let o,a;for(let l=0;l<s.length;l++)s[l]&&(o==null&&(o=l),a=l);for(let l=0,c=n+1;l<i.height;l++){let u=e.child(l),h=c+u.nodeSize,d=s[l];if(d>0){let f="cell";u.firstChild&&(f=u.firstChild.type.spec.tableRole);let p=[];for(let m=0;m<d;m++)p.push(Ft(t.schema)[f].createAndFill());let g=(l==0||o==l-1)&&a==l?c+1:h-1;r.insert(r.mapping.map(g),p)}c=h}return r.setMeta(QB,{fixTables:!0})}function gr(t){let e=t.selection,n=qu(t),r=n.node(-1),i=n.start(-1),s=Xe.get(r),o;return e instanceof Ae?o=s.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o=s.findCell(n.pos-i),o.tableStart=i,o.map=s,o.table=r,o}function Yx(t,{map:e,tableStart:n,table:r},i){let s=i>0?-1:0;VB(e,r,i+s)&&(s=i==0||i==e.width?null:0);for(let o=0;o<e.height;o++){let a=o*e.width+i;if(i>0&&i<e.width&&e.map[a-1]==e.map[a]){let l=e.map[a],c=r.nodeAt(l);t.setNodeMarkup(t.mapping.map(n+l),null,Wx(c.attrs,i-e.colCount(l))),o+=c.attrs.rowspan-1}else{let l=s==null?Ft(r.type.schema).cell:r.nodeAt(e.map[a+s]).type,c=e.positionAt(o,i,r);t.insert(t.mapping.map(n+c),l.createAndFill())}}return t}function eF(t,e){if(!Wn(t))return!1;if(e){let n=gr(t);e(Yx(t.tr,n,n.left))}return!0}function tF(t,e){if(!Wn(t))return!1;if(e){let n=gr(t);e(Yx(t.tr,n,n.right))}return!0}function nF(t,{map:e,table:n,tableStart:r},i){let s=t.mapping.maps.length;for(let o=0;o<e.height;){let a=o*e.width+i,l=e.map[a],c=n.nodeAt(l);if(i>0&&e.map[a-1]==l||i<e.width-1&&e.map[a+1]==l)t.setNodeMarkup(t.mapping.slice(s).map(r+l),null,as(c.attrs,i-e.colCount(l)));else{let u=t.mapping.slice(s).map(r+l);t.delete(u,u+c.nodeSize)}o+=c.attrs.rowspan}}function rF(t,e){if(!Wn(t))return!1;if(e){let n=gr(t),r=t.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let i=n.right-1;nF(r,n,i),i!=n.left;i--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=Xe.get(n.table);e(r)}return!0}function iF(t,e,n){let r=Ft(e.type.schema).header_cell;for(let i=0;i<t.width;i++)if(e.nodeAt(t.map[i+n*t.width]).type!=r)return!1;return!0}function Qx(t,{map:e,tableStart:n,table:r},i){let s=n;for(let l=0;l<i;l++)s+=r.child(l).nodeSize;let o=[],a=i>0?-1:0;iF(e,r,i+a)&&(a=i==0||i==e.height?null:0);for(let l=0,c=e.width*i;l<e.width;l++,c++)if(i>0&&i<e.height&&e.map[c]==e.map[c-e.width]){let u=e.map[c],h=r.nodeAt(u).attrs;t.setNodeMarkup(n+u,null,ht(h,"rowspan",h.rowspan+1)),l+=h.colspan-1}else{let u=a==null?Ft(r.type.schema).cell:r.nodeAt(e.map[c+a*e.width]).type;o.push(u.createAndFill())}return t.insert(s,Ft(r.type.schema).row.create(null,o)),t}function sF(t,e){if(!Wn(t))return!1;if(e){let n=gr(t);e(Qx(t.tr,n,n.top))}return!0}function oF(t,e){if(!Wn(t))return!1;if(e){let n=gr(t);e(Qx(t.tr,n,n.bottom))}return!0}function aF(t,{map:e,table:n,tableStart:r},i){let s=0;for(let l=0;l<i;l++)s+=n.child(l).nodeSize;let o=s+n.child(i).nodeSize,a=t.mapping.maps.length;t.delete(s+r,o+r);for(let l=0,c=i*e.width;l<e.width;l++,c++){let u=e.map[c];if(i>0&&u==e.map[c-e.width]){let h=n.nodeAt(u).attrs;t.setNodeMarkup(t.mapping.slice(a).map(u+r),null,ht(h,"rowspan",h.rowspan-1)),l+=h.colspan-1}else if(i<e.width&&u==e.map[c+e.width]){let h=n.nodeAt(u),d=h.type.create(ht(h.attrs,"rowspan",h.attrs.rowspan-1),h.content),f=e.positionAt(i+1,l,n);t.insert(t.mapping.slice(a).map(r+f),d),l+=h.attrs.colspan-1}}}function lF(t,e){if(!Wn(t))return!1;if(e){let n=gr(t),r=t.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let i=n.bottom-1;aF(r,n,i),i!=n.top;i--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=Xe.get(n.table);e(r)}return!0}function Ub(t){let e=t.content;return e.childCount==1&&e.firstChild.isTextblock&&e.firstChild.childCount==0}function cF({width:t,height:e,map:n},r){let i=r.top*t+r.left,s=i,o=(r.bottom-1)*t+r.left,a=i+(r.right-r.left-1);for(let l=r.top;l<r.bottom;l++){if(r.left>0&&n[s]==n[s-1]||r.right<t&&n[a]==n[a+1])return!0;s+=t,a+=t}for(let l=r.left;l<r.right;l++){if(r.top>0&&n[i]==n[i-t]||r.bottom<e&&n[o]==n[o+t])return!0;i++,o++}return!1}function zb(t,e){let n=t.selection;if(!(n instanceof Ae)||n.$anchorCell.pos==n.$headCell.pos)return!1;let r=gr(t),{map:i}=r;if(cF(i,r))return!1;if(e){let s=t.tr,o={},a=z.empty,l,c;for(let u=r.top;u<r.bottom;u++)for(let h=r.left;h<r.right;h++){let d=i.map[u*i.width+h],f=r.table.nodeAt(d);if(!o[d])if(o[d]=!0,l==null)l=d,c=f;else{Ub(f)||(a=a.append(f.content));let p=s.mapping.map(d+r.tableStart);s.delete(p,p+f.nodeSize)}}if(s.setNodeMarkup(l+r.tableStart,null,ht(Wx(c.attrs,c.attrs.colspan,r.right-r.left-c.attrs.colspan),"rowspan",r.bottom-r.top)),a.size){let u=l+1+c.content.size,h=Ub(c)?l+1:u;s.replaceWith(h+r.tableStart,u+r.tableStart,a)}s.setSelection(new Ae(s.doc.resolve(l+r.tableStart))),e(s)}return!0}function Hb(t,e){const n=Ft(t.schema);return uF(({node:r})=>n[r.type.spec.tableRole])(t,e)}function uF(t){return(e,n)=>{let r=e.selection,i,s;if(r instanceof Ae){if(r.$anchorCell.pos!=r.$headCell.pos)return!1;i=r.$anchorCell.nodeAfter,s=r.$anchorCell.pos}else{if(i=LB(r.$from),!i)return!1;s=No(r.$from).pos}if(i.attrs.colspan==1&&i.attrs.rowspan==1)return!1;if(n){let o=i.attrs,a=[],l=o.colwidth;o.rowspan>1&&(o=ht(o,"rowspan",1)),o.colspan>1&&(o=ht(o,"colspan",1));let c=gr(e),u=e.tr;for(let d=0;d<c.right-c.left;d++)a.push(l?ht(o,"colwidth",l&&l[d]?[l[d]]:null):o);let h;for(let d=c.top;d<c.bottom;d++){let f=c.map.positionAt(d,c.left,c.table);d==c.top&&(f+=i.nodeSize);for(let p=c.left,g=0;p<c.right;p++,g++)p==c.left&&d==c.top||u.insert(h=u.mapping.map(f+c.tableStart,1),t({node:i,row:d,col:p}).createAndFill(a[g]))}u.setNodeMarkup(s,t({node:i,row:c.top,col:c.left}),a[0]),r instanceof Ae&&u.setSelection(new Ae(u.doc.resolve(r.$anchorCell.pos),h&&u.doc.resolve(h))),n(u)}return!0}}function hF(t,e){return function(n,r){if(!Wn(n))return!1;let i=qu(n);if(i.nodeAfter.attrs[t]===e)return!1;if(r){let s=n.tr;n.selection instanceof Ae?n.selection.forEachCell((o,a)=>{o.attrs[t]!==e&&s.setNodeMarkup(a,null,ht(o.attrs,t,e))}):s.setNodeMarkup(i.pos,null,ht(i.nodeAfter.attrs,t,e)),r(s)}return!0}}function dF(t){return function(e,n){if(!Wn(e))return!1;if(n){let r=Ft(e.schema),i=gr(e),s=e.tr,o=i.map.cellsInRect(t=="column"?new yo(i.left,0,i.right,i.map.height):t=="row"?new yo(0,i.top,i.map.width,i.bottom):i),a=o.map(l=>i.table.nodeAt(l));for(let l=0;l<o.length;l++)a[l].type==r.header_cell&&s.setNodeMarkup(i.tableStart+o[l],r.cell,a[l].attrs);if(s.steps.length==0)for(let l=0;l<o.length;l++)s.setNodeMarkup(i.tableStart+o[l],r.header_cell,a[l].attrs);n(s)}return!0}}function jb(t,e,n){const r=e.map.cellsInRect({left:0,top:0,right:t=="row"?e.map.width:1,bottom:t=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const s=e.table.nodeAt(r[i]);if(s&&s.type!==n.header_cell)return!1}return!0}function Ua(t,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?dF(t):function(n,r){if(!Wn(n))return!1;if(r){let i=Ft(n.schema),s=gr(n),o=n.tr,a=jb("row",s,i),l=jb("column",s,i),u=(t==="column"?a:t==="row"?l:!1)?1:0,h=t=="column"?new yo(0,u,1,s.map.height):t=="row"?new yo(u,0,s.map.width,1):s,d=t=="column"?l?i.cell:i.header_cell:t=="row"?a?i.cell:i.header_cell:i.cell;s.map.cellsInRect(h).forEach(f=>{const p=f+s.tableStart,g=o.doc.nodeAt(p);g&&o.setNodeMarkup(p,d,g.attrs)}),r(o)}return!0}}Ua("row",{useDeprecatedLogic:!0});Ua("column",{useDeprecatedLogic:!0});let fF=Ua("cell",{useDeprecatedLogic:!0});function pF(t,e){if(e<0){let n=t.nodeBefore;if(n)return t.pos-n.nodeSize;for(let r=t.index(-1)-1,i=t.before();r>=0;r--){let s=t.node(-1).child(r);if(s.childCount)return i-1-s.lastChild.nodeSize;i-=s.nodeSize}}else{if(t.index()<t.parent.childCount-1)return t.pos+t.nodeAfter.nodeSize;let n=t.node(-1);for(let r=t.indexAfter(-1),i=t.after();r<n.childCount;r++){let s=n.child(r);if(s.childCount)return i+1;i+=s.nodeSize}}}function Kb(t){return function(e,n){if(!Wn(e))return!1;let r=pF(qu(e),t);if(r!=null){if(n){let i=e.doc.resolve(r);n(e.tr.setSelection(pe.between(i,FB(i))).scrollIntoView())}return!0}}}function gF(t,e){let n=t.selection.$anchor;for(let r=n.depth;r>0;r--)if(n.node(r).type.spec.tableRole=="table")return e&&e(t.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0;return!1}class mF{constructor(e,n){this.node=e,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Sf(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Sf(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}}function Sf(t,e,n,r,i,s){let o=0,a=!0,l=e.firstChild,c=t.firstChild;for(let u=0,h=0;u<c.childCount;u++){let{colspan:d,colwidth:f}=c.child(u).attrs;for(let p=0;p<d;p++,h++){let g=i==h?s:f&&f[p],m=g?g+"px":"";o+=g||r,g||(a=!1),l?(l.style.width!=m&&(l.style.width=m),l=l.nextSibling):e.appendChild(document.createElement("col")).style.width=m}}for(;l;){let u=l.nextSibling;l.parentNode.removeChild(l),l=u}a?(n.style.width=o+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=o+"px")}const Cn=new ln("tableColumnResizing");function yF({handleWidth:t=5,cellMinWidth:e=25,View:n=mF,lastColumnResizable:r=!0}={}){return new Tt({key:Cn,state:{init(s,o){return this.spec.props.nodeViews[Ft(o.schema).table.name]=(a,l)=>new n(a,e,l),new fa(-1,!1)},apply(s,o){return o.apply(s)}},props:{attributes(s){return Cn.getState(s).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove(s,o){bF(s,o,t,e,r)},mouseleave(s){wF(s)},mousedown(s,o){vF(s,o,e)}},decorations(s){let o=Cn.getState(s);if(o.activeHandle>-1)return kF(s,o.activeHandle)},nodeViews:{}}})}class fa{constructor(e,n){this.activeHandle=e,this.dragging=n}apply(e){let n=this,r=e.getMeta(Cn);if(r&&r.setHandle!=null)return new fa(r.setHandle,null);if(r&&r.setDragging!==void 0)return new fa(n.activeHandle,r.setDragging);if(n.activeHandle>-1&&e.docChanged){let i=e.mapping.map(n.activeHandle,-1);Ef(e.doc.resolve(i))||(i=null),n=new fa(i,n.dragging)}return n}}function bF(t,e,n,r,i){let s=Cn.getState(t.state);if(!s.dragging){let o=xF(e.target),a=-1;if(o){let{left:l,right:c}=o.getBoundingClientRect();e.clientX-l<=n?a=qb(t,e,"left"):c-e.clientX<=n&&(a=qb(t,e,"right"))}if(a!=s.activeHandle){if(!i&&a!==-1){let l=t.state.doc.resolve(a),c=l.node(-1),u=Xe.get(c),h=l.start(-1);if(u.colCount(l.pos-h)+l.nodeAfter.attrs.colspan-1==u.width-1)return}Zx(t,a)}}}function wF(t){let e=Cn.getState(t.state);e.activeHandle>-1&&!e.dragging&&Zx(t,-1)}function vF(t,e,n){let r=Cn.getState(t.state);if(r.activeHandle==-1||r.dragging)return!1;let i=t.state.doc.nodeAt(r.activeHandle),s=EF(t,r.activeHandle,i.attrs);t.dispatch(t.state.tr.setMeta(Cn,{setDragging:{startX:e.clientX,startWidth:s}}));function o(l){window.removeEventListener("mouseup",o),window.removeEventListener("mousemove",a);let c=Cn.getState(t.state);c.dragging&&(SF(t,c.activeHandle,Wb(c.dragging,l,n)),t.dispatch(t.state.tr.setMeta(Cn,{setDragging:null})))}function a(l){if(!l.which)return o(l);let c=Cn.getState(t.state),u=Wb(c.dragging,l,n);TF(t,c.activeHandle,u,n)}return window.addEventListener("mouseup",o),window.addEventListener("mousemove",a),e.preventDefault(),!0}function EF(t,e,{colspan:n,colwidth:r}){let i=r&&r[r.length-1];if(i)return i;let s=t.domAtPos(e),a=s.node.childNodes[s.offset].offsetWidth,l=n;if(r)for(let c=0;c<n;c++)r[c]&&(a-=r[c],l--);return a/l}function xF(t){for(;t&&t.nodeName!="TD"&&t.nodeName!="TH";)t=t.classList.contains("ProseMirror")?null:t.parentNode;return t}function qb(t,e,n){let r=t.posAtCoords({left:e.clientX,top:e.clientY});if(!r)return-1;let{pos:i}=r,s=No(t.state.doc.resolve(i));if(!s)return-1;if(n=="right")return s.pos;let o=Xe.get(s.node(-1)),a=s.start(-1),l=o.map.indexOf(s.pos-a);return l%o.width==0?-1:a+o.map[l-1]}function Wb(t,e,n){let r=e.clientX-t.startX;return Math.max(n,t.startWidth+r)}function Zx(t,e){t.dispatch(t.state.tr.setMeta(Cn,{setHandle:e}))}function SF(t,e,n){let r=t.state.doc.resolve(e),i=r.node(-1),s=Xe.get(i),o=r.start(-1),a=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan-1,l=t.state.tr;for(let c=0;c<s.height;c++){let u=c*s.width+a;if(c&&s.map[u]==s.map[u-s.width])continue;let h=s.map[u],{attrs:d}=i.nodeAt(h),f=d.colspan==1?0:a-s.colCount(h);if(d.colwidth&&d.colwidth[f]==n)continue;let p=d.colwidth?d.colwidth.slice():CF(d.colspan);p[f]=n,l.setNodeMarkup(o+h,null,ht(d,"colwidth",p))}l.docChanged&&t.dispatch(l)}function TF(t,e,n,r){let i=t.state.doc.resolve(e),s=i.node(-1),o=i.start(-1),a=Xe.get(s).colCount(i.pos-o)+i.nodeAfter.attrs.colspan-1,l=t.domAtPos(i.start(-1)).node;for(;l.nodeName!="TABLE";)l=l.parentNode;Sf(s,l.firstChild,l,r,a,n)}function CF(t){let e=[];for(let n=0;n<t;n++)e.push(0);return e}function kF(t,e){let n=[],r=t.doc.resolve(e),i=r.node(-1),s=Xe.get(i),o=r.start(-1),a=s.colCount(r.pos-o)+r.nodeAfter.attrs.colspan;for(let l=0;l<s.height;l++){let c=a+l*s.width-1;if((a==s.width||s.map[c]!=s.map[c+1])&&(l==0||s.map[c-1]!=s.map[c-1-s.width])){let u=s.map[c],h=o+u+i.nodeAt(u).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",n.push(Ht.widget(h,d))}}return et.create(t.doc,n)}function IF({allowTableNodeSelection:t=!1}={}){return new Tt({key:Lr,state:{init(){return null},apply(e,n){let r=e.getMeta(Lr);if(r!=null)return r==-1?null:r;if(n==null||!e.docChanged)return n;let{deleted:i,pos:s}=e.mapping.mapResult(n);return i?null:s}},props:{decorations:$B,handleDOMEvents:{mousedown:YB},createSelectionBetween(e){if(Lr.getState(e.state)!=null)return e.state.selection},handleTripleClick:JB,handleKeyDown:GB,handlePaste:XB},appendTransaction(e,n,r){return HB(r,Xx(r,n),t)}})}function Gb(t,e,n,r,i,s){let o=0,a=!0,l=e.firstChild;const c=t.firstChild;for(let u=0,h=0;u<c.childCount;u+=1){const{colspan:d,colwidth:f}=c.child(u).attrs;for(let p=0;p<d;p+=1,h+=1){const g=i===h?s:f&&f[p],m=g?`${g}px`:"";o+=g||r,g||(a=!1),l?(l.style.width!==m&&(l.style.width=m),l=l.nextSibling):e.appendChild(document.createElement("col")).style.width=m}}for(;l;){const u=l.nextSibling;l.parentNode.removeChild(l),l=u}a?(n.style.width=`${o}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${o}px`)}class AF{constructor(e,n){this.node=e,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Gb(e,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!==this.node.type?!1:(this.node=e,Gb(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return e.type==="attributes"&&(e.target===this.table||this.colgroup.contains(e.target))}}function Jb(t,e){return e?t.createChecked(null,e):t.createAndFill()}function _F(t){if(t.cached.tableNodeTypes)return t.cached.tableNodeTypes;const e={};return Object.keys(t.nodes).forEach(n=>{const r=t.nodes[n];r.spec.tableRole&&(e[r.spec.tableRole]=r)}),t.cached.tableNodeTypes=e,e}function MF(t,e,n,r,i){const s=_F(t),o=[],a=[];for(let c=0;c<n;c+=1){const u=Jb(s.cell,i);if(u&&a.push(u),r){const h=Jb(s.header_cell,i);h&&o.push(h)}}const l=[];for(let c=0;c<e;c+=1)l.push(s.row.createChecked(null,r&&c===0?o:a));return s.table.createChecked(null,l)}function OF(t){return t instanceof Ae}const Wl=({editor:t})=>{const{selection:e}=t.state;if(!OF(e))return!1;let n=0;const r=LE(e.ranges[0].$from,s=>s.type.name==="table");return r==null||r.node.descendants(s=>{if(s.type.name==="table")return!1;["tableCell","tableHeader"].includes(s.type.name)&&(n+=1)}),n===e.ranges.length?(t.commands.deleteTable(),!0):!1},NF=at.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:AF,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({HTMLAttributes:t}){return["table",nt(this.options.HTMLAttributes,t),["tbody",0]]},addCommands(){return{insertTable:({rows:t=3,cols:e=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:i,editor:s})=>{const o=MF(s.schema,t,e,n);if(i){const a=r.selection.anchor+1;r.replaceSelectionWith(o).scrollIntoView().setSelection(pe.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:t,dispatch:e})=>eF(t,e),addColumnAfter:()=>({state:t,dispatch:e})=>tF(t,e),deleteColumn:()=>({state:t,dispatch:e})=>rF(t,e),addRowBefore:()=>({state:t,dispatch:e})=>sF(t,e),addRowAfter:()=>({state:t,dispatch:e})=>oF(t,e),deleteRow:()=>({state:t,dispatch:e})=>lF(t,e),deleteTable:()=>({state:t,dispatch:e})=>gF(t,e),mergeCells:()=>({state:t,dispatch:e})=>zb(t,e),splitCell:()=>({state:t,dispatch:e})=>Hb(t,e),toggleHeaderColumn:()=>({state:t,dispatch:e})=>Ua("column")(t,e),toggleHeaderRow:()=>({state:t,dispatch:e})=>Ua("row")(t,e),toggleHeaderCell:()=>({state:t,dispatch:e})=>fF(t,e),mergeOrSplit:()=>({state:t,dispatch:e})=>zb(t,e)?!0:Hb(t,e),setCellAttribute:(t,e)=>({state:n,dispatch:r})=>hF(t,e)(n,r),goToNextCell:()=>({state:t,dispatch:e})=>Kb(1)(t,e),goToPreviousCell:()=>({state:t,dispatch:e})=>Kb(-1)(t,e),fixTables:()=>({state:t,dispatch:e})=>(e&&Xx(t),!0),setCellSelection:t=>({tr:e,dispatch:n})=>{if(n){const r=Ae.create(e.doc,t.anchorCell,t.headCell);e.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:Wl,"Mod-Backspace":Wl,Delete:Wl,"Mod-Delete":Wl}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[yF({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],IF({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(t){const e={name:t.name,options:t.options,storage:t.storage};return{tableRole:Se(re(t,"tableRole",e))}}}),DF=at.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:t}){return["td",nt(this.options.HTMLAttributes,t),0]}}),RF=at.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:t=>{const e=t.getAttribute("colwidth");return e?[parseInt(e,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:t}){return["th",nt(this.options.HTMLAttributes,t),0]}}),PF=at.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:t}){return["tr",nt(this.options.HTMLAttributes,t),0]}}),LF=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,BF=at.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:t}){return["img",nt(this.options.HTMLAttributes,t)]},addCommands(){return{setImage:t=>({commands:e})=>e.insertContent({type:this.name,attrs:t})}},addInputRules(){return[$E({find:LF,type:this.type,getAttributes:t=>{const[,,e,n,r]=t;return{src:n,alt:e,title:r}}})]}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},FF=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},tS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,h=(s&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),r.push(n[u],n[h],n[d],n[f])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(eS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):FF(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw Error();const d=s<<2|a>>4;if(r.push(d),c!==64){const f=a<<4&240|c>>2;if(r.push(f),h!==64){const p=c<<6&192|h;r.push(p)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},VF=function(t){const e=eS(t);return tS.encodeByteArray(e,!0)},Jc=function(t){return VF(t).replace(/\./g,"")},$F=function(t){try{return tS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tf(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function UF(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function zF(){return!UF()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nS(){return typeof indexedDB=="object"}function HF(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function jF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KF=()=>jF().__FIREBASE_DEFAULTS__,qF=()=>{if(typeof process>"u")return;const t=process.env.__FIREBASE_DEFAULTS__,e=process.env.__FIREBASE_DEFAULTS_PATH__;if(t)return e&&console.warn("Values were provided for both __FIREBASE_DEFAULTS__ and __FIREBASE_DEFAULTS_PATH__. __FIREBASE_DEFAULTS_PATH__ will be ignored."),JSON.parse(t);if(e&&typeof require<"u")try{return require(e)}catch{console.warn(`Unable to read defaults from file provided to __FIREBASE_DEFAULTS_PATH__: ${e}`)}},WF=()=>{if(typeof document>"u")return;const t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/),e=t&&$F(t[1]);return e&&JSON.parse(e)},rS=()=>KF()||qF()||WF(),iS=t=>{var e,n;return(n=(e=rS())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},GF=()=>{var t;return(t=rS())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Jc(JSON.stringify(n)),Jc(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XF="FirebaseError";class vs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=XF,Object.setPrototypeOf(this,vs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,oS.prototype.create)}}class oS{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?YF(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new vs(i,a,r)}}function YF(t,e){return t.replace(QF,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const QF=/\{\$([^}]+)}/g;function Cf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Xb(s)&&Xb(o)){if(!Cf(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Xb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(t){return t&&t._delegate?t._delegate:t}class bo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new JF;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tV(e))try{this.getOrInitializeService({instanceIdentifier:ki})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ki){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ki){return this.instances.has(e)}getOptions(e=ki){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(!!r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:eV(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ki){return this.component?this.component.multipleInstances?e:ki:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eV(t){return t===ki?void 0:t}function tV(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ZF(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Le||(Le={}));const rV={debug:Le.DEBUG,verbose:Le.VERBOSE,info:Le.INFO,warn:Le.WARN,error:Le.ERROR,silent:Le.SILENT},iV=Le.INFO,sV={[Le.DEBUG]:"log",[Le.VERBOSE]:"log",[Le.INFO]:"info",[Le.WARN]:"warn",[Le.ERROR]:"error"},oV=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=sV[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class aS{constructor(e){this.name=e,this._logLevel=iV,this._logHandler=oV,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Le.DEBUG,...e),this._logHandler(this,Le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Le.VERBOSE,...e),this._logHandler(this,Le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Le.INFO,...e),this._logHandler(this,Le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Le.WARN,...e),this._logHandler(this,Le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Le.ERROR,...e),this._logHandler(this,Le.ERROR,...e)}}const aV=(t,e)=>e.some(n=>t instanceof n);let Yb,Qb;function lV(){return Yb||(Yb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cV(){return Qb||(Qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const lS=new WeakMap,kf=new WeakMap,cS=new WeakMap,fd=new WeakMap,gg=new WeakMap;function uV(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Xr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&lS.set(n,t)}).catch(()=>{}),gg.set(e,t),e}function hV(t){if(kf.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});kf.set(t,e)}let If={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return kf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||cS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Xr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function dV(t){If=t(If)}function fV(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(pd(this),e,...n);return cS.set(r,e.sort?e.sort():[e]),Xr(r)}:cV().includes(t)?function(...e){return t.apply(pd(this),e),Xr(lS.get(this))}:function(...e){return Xr(t.apply(pd(this),e))}}function pV(t){return typeof t=="function"?fV(t):(t instanceof IDBTransaction&&hV(t),aV(t,lV())?new Proxy(t,If):t)}function Xr(t){if(t instanceof IDBRequest)return uV(t);if(fd.has(t))return fd.get(t);const e=pV(t);return e!==t&&(fd.set(t,e),gg.set(e,t)),e}const pd=t=>gg.get(t);function gV(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=Xr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Xr(o.result),l.oldVersion,l.newVersion,Xr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}const mV=["get","getKey","getAll","getAllKeys","count"],yV=["put","add","delete","clear"],gd=new Map;function Zb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(gd.get(e))return gd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=yV.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||mV.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return gd.set(e,s),s}dV(t=>({...t,get:(e,n,r)=>Zb(e,n)||t.get(e,n,r),has:(e,n)=>!!Zb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(wV(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function wV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Af="@firebase/app",ew="0.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls=new aS("@firebase/app"),vV="@firebase/app-compat",EV="@firebase/analytics-compat",xV="@firebase/analytics",SV="@firebase/app-check-compat",TV="@firebase/app-check",CV="@firebase/auth",kV="@firebase/auth-compat",IV="@firebase/database",AV="@firebase/database-compat",_V="@firebase/functions",MV="@firebase/functions-compat",OV="@firebase/installations",NV="@firebase/installations-compat",DV="@firebase/messaging",RV="@firebase/messaging-compat",PV="@firebase/performance",LV="@firebase/performance-compat",BV="@firebase/remote-config",FV="@firebase/remote-config-compat",VV="@firebase/storage",$V="@firebase/storage-compat",UV="@firebase/firestore",zV="@firebase/firestore-compat",HV="firebase",jV="9.11.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _f="[DEFAULT]",KV={[Af]:"fire-core",[vV]:"fire-core-compat",[xV]:"fire-analytics",[EV]:"fire-analytics-compat",[TV]:"fire-app-check",[SV]:"fire-app-check-compat",[CV]:"fire-auth",[kV]:"fire-auth-compat",[IV]:"fire-rtdb",[AV]:"fire-rtdb-compat",[_V]:"fire-fn",[MV]:"fire-fn-compat",[OV]:"fire-iid",[NV]:"fire-iid-compat",[DV]:"fire-fcm",[RV]:"fire-fcm-compat",[PV]:"fire-perf",[LV]:"fire-perf-compat",[BV]:"fire-rc",[FV]:"fire-rc-compat",[VV]:"fire-gcs",[$V]:"fire-gcs-compat",[UV]:"fire-fst",[zV]:"fire-fst-compat","fire-js":"fire-js",[HV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=new Map,Mf=new Map;function qV(t,e){try{t.container.addComponent(e)}catch(n){ls.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function za(t){const e=t.name;if(Mf.has(e))return ls.debug(`There were multiple attempts to register component ${e}.`),!1;Mf.set(e,t);for(const n of Xc.values())qV(n,t);return!0}function uS(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Yr=new oS("app","Firebase",WV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS=jV;function dS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:_f,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Yr.create("bad-app-name",{appName:String(i)});if(n||(n=GF()),!n)throw Yr.create("no-options");const s=Xc.get(i);if(s){if(Cf(n,s.options)&&Cf(r,s.config))return s;throw Yr.create("duplicate-app",{appName:i})}const o=new nV(i);for(const l of Mf.values())o.addComponent(l);const a=new GV(n,r,o);return Xc.set(i,a),a}function fS(t=_f){const e=Xc.get(t);if(!e&&t===_f)return dS();if(!e)throw Yr.create("no-app",{appName:t});return e}function Qr(t,e,n){var r;let i=(r=KV[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ls.warn(a.join(" "));return}za(new bo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JV="firebase-heartbeat-database",XV=1,Ha="firebase-heartbeat-store";let md=null;function pS(){return md||(md=gV(JV,XV,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Ha)}}}).catch(t=>{throw Yr.create("idb-open",{originalErrorMessage:t.message})})),md}async function YV(t){var e;try{return(await pS()).transaction(Ha).objectStore(Ha).get(gS(t))}catch(n){if(n instanceof vs)ls.warn(n.message);else{const r=Yr.create("idb-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message});ls.warn(r.message)}}}async function tw(t,e){var n;try{const i=(await pS()).transaction(Ha,"readwrite");return await i.objectStore(Ha).put(e,gS(t)),i.done}catch(r){if(r instanceof vs)ls.warn(r.message);else{const i=Yr.create("idb-set",{originalErrorMessage:(n=r)===null||n===void 0?void 0:n.message});ls.warn(i.message)}}}function gS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QV=1024,ZV=30*24*60*60*1e3;class e${constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new n$(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=nw();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{const s=new Date(i.date).valueOf();return Date.now()-s<=ZV}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nw(),{heartbeatsToSend:n,unsentEntries:r}=t$(this._heartbeatsCache.heartbeats),i=Jc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function nw(){return new Date().toISOString().substring(0,10)}function t$(t,e=QV){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),rw(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),rw(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class n${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nS()?HF().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await YV(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return tw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return tw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function rw(t){return Jc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r$(t){za(new bo("platform-logger",e=>new bV(e),"PRIVATE")),za(new bo("heartbeat",e=>new e$(e),"PRIVATE")),Qr(Af,ew,t),Qr(Af,ew,"esm2017"),Qr("fire-js","")}r$("");var i$="firebase",s$="9.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qr(i$,s$,"app");var o$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oe,mg=mg||{},ye=o$||self;function Yc(){}function Wu(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function hl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function a$(t){return Object.prototype.hasOwnProperty.call(t,yd)&&t[yd]||(t[yd]=++l$)}var yd="closure_uid_"+(1e9*Math.random()>>>0),l$=0;function c$(t,e,n){return t.call.apply(t.bind,arguments)}function u$(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Pt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Pt=c$:Pt=u$,Pt.apply(null,arguments)}function Gl(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function Ct(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function di(){this.s=this.s,this.o=this.o}var h$=0;di.prototype.s=!1;di.prototype.na=function(){!this.s&&(this.s=!0,this.M(),h$!=0)&&a$(this)};di.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const mS=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function yg(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function iw(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Wu(r)){const i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Lt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Lt.prototype.h=function(){this.defaultPrevented=!0};var d$=function(){if(!ye.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ye.addEventListener("test",Yc,e),ye.removeEventListener("test",Yc,e)}catch{}return t}();function Qc(t){return/^[\s\xa0]*$/.test(t)}var sw=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function bd(t,e){return t<e?-1:t>e?1:0}function Gu(){var t=ye.navigator;return t&&(t=t.userAgent)?t:""}function nr(t){return Gu().indexOf(t)!=-1}function bg(t){return bg[" "](t),t}bg[" "]=Yc;function f$(t){var e=m$;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var p$=nr("Opera"),wo=nr("Trident")||nr("MSIE"),yS=nr("Edge"),Of=yS||wo,bS=nr("Gecko")&&!(Gu().toLowerCase().indexOf("webkit")!=-1&&!nr("Edge"))&&!(nr("Trident")||nr("MSIE"))&&!nr("Edge"),g$=Gu().toLowerCase().indexOf("webkit")!=-1&&!nr("Edge");function wS(){var t=ye.document;return t?t.documentMode:void 0}var Zc;e:{var wd="",vd=function(){var t=Gu();if(bS)return/rv:([^\);]+)(\)|;)/.exec(t);if(yS)return/Edge\/([\d\.]+)/.exec(t);if(wo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(g$)return/WebKit\/(\S+)/.exec(t);if(p$)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(vd&&(wd=vd?vd[1]:""),wo){var Ed=wS();if(Ed!=null&&Ed>parseFloat(wd)){Zc=String(Ed);break e}}Zc=wd}var m$={};function y$(){return f$(function(){let t=0;const e=sw(String(Zc)).split("."),n=sw("9").split("."),r=Math.max(e.length,n.length);for(let o=0;t==0&&o<r;o++){var i=e[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],i[0].length==0&&s[0].length==0)break;t=bd(i[1].length==0?0:parseInt(i[1],10),s[1].length==0?0:parseInt(s[1],10))||bd(i[2].length==0,s[2].length==0)||bd(i[2],s[2]),i=i[3],s=s[3]}while(t==0)}return 0<=t})}var Nf;if(ye.document&&wo){var ow=wS();Nf=ow||parseInt(Zc,10)||void 0}else Nf=void 0;var b$=Nf;function ja(t,e){if(Lt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(bS){e:{try{bg(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:w$[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ja.X.h.call(this)}}Ct(ja,Lt);var w$={2:"touch",3:"pen",4:"mouse"};ja.prototype.h=function(){ja.X.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var dl="closure_listenable_"+(1e6*Math.random()|0),v$=0;function E$(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ha=i,this.key=++v$,this.ba=this.ea=!1}function Ju(t){t.ba=!0,t.listener=null,t.proxy=null,t.src=null,t.ha=null}function wg(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function vS(t){const e={};for(const n in t)e[n]=t[n];return e}const aw="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ES(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<aw.length;s++)n=aw[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Xu(t){this.src=t,this.g={},this.h=0}Xu.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Rf(t,e,r,i);return-1<o?(e=t[o],n||(e.ea=!1)):(e=new E$(e,this.src,s,!!r,i),e.ea=n,t.push(e)),e};function Df(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=mS(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ju(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Rf(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.ba&&s.listener==e&&s.capture==!!n&&s.ha==r)return i}return-1}var vg="closure_lm_"+(1e6*Math.random()|0),xd={};function xS(t,e,n,r,i){if(r&&r.once)return TS(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)xS(t,e[s],n,r,i);return null}return n=Sg(n),t&&t[dl]?t.N(e,n,hl(r)?!!r.capture:!!r,i):SS(t,e,n,!1,r,i)}function SS(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=hl(i)?!!i.capture:!!i,a=xg(t);if(a||(t[vg]=a=new Xu(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=x$(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)d$||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kS(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function x$(){function t(n){return e.call(t.src,t.listener,n)}const e=S$;return t}function TS(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)TS(t,e[s],n,r,i);return null}return n=Sg(n),t&&t[dl]?t.O(e,n,hl(r)?!!r.capture:!!r,i):SS(t,e,n,!0,r,i)}function CS(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)CS(t,e[s],n,r,i);else r=hl(r)?!!r.capture:!!r,n=Sg(n),t&&t[dl]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Rf(s,n,r,i),-1<n&&(Ju(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=xg(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Rf(e,n,r,i)),(n=-1<t?e[t]:null)&&Eg(n))}function Eg(t){if(typeof t!="number"&&t&&!t.ba){var e=t.src;if(e&&e[dl])Df(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kS(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xg(e))?(Df(n,t),n.h==0&&(n.src=null,e[vg]=null)):Ju(t)}}}function kS(t){return t in xd?xd[t]:xd[t]="on"+t}function S$(t,e){if(t.ba)t=!0;else{e=new ja(e,this);var n=t.listener,r=t.ha||t.src;t.ea&&Eg(t),t=n.call(r,e)}return t}function xg(t){return t=t[vg],t instanceof Xu?t:null}var Sd="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sg(t){return typeof t=="function"?t:(t[Sd]||(t[Sd]=function(e){return t.handleEvent(e)}),t[Sd])}function ft(){di.call(this),this.i=new Xu(this),this.P=this,this.I=null}Ct(ft,di);ft.prototype[dl]=!0;ft.prototype.removeEventListener=function(t,e,n,r){CS(this,t,e,n,r)};function St(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new Lt(e,t);else if(e instanceof Lt)e.target=e.target||t;else{var i=e;e=new Lt(r,t),ES(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Jl(o,r,!0,e)&&i}if(o=e.g=t,i=Jl(o,r,!0,e)&&i,i=Jl(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Jl(o,r,!1,e)&&i}ft.prototype.M=function(){if(ft.X.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ju(n[r]);delete t.g[e],t.h--}}this.I=null};ft.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ft.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Jl(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.ea&&Df(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var Tg=ye.JSON.stringify;function T$(){var t=_S;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class C${constructor(){this.h=this.g=null}add(e,n){const r=IS.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var IS=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new k$,t=>t.reset());class k${constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function I$(t){ye.setTimeout(()=>{throw t},0)}function AS(t,e){Pf||A$(),Lf||(Pf(),Lf=!0),_S.add(t,e)}var Pf;function A$(){var t=ye.Promise.resolve(void 0);Pf=function(){t.then(_$)}}var Lf=!1,_S=new C$;function _$(){for(var t;t=T$();){try{t.h.call(t.g)}catch(n){I$(n)}var e=IS;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Lf=!1}function Yu(t,e){ft.call(this),this.h=t||1,this.g=e||ye,this.j=Pt(this.kb,this),this.l=Date.now()}Ct(Yu,ft);oe=Yu.prototype;oe.ca=!1;oe.R=null;oe.kb=function(){if(this.ca){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-t):(this.R&&(this.g.clearTimeout(this.R),this.R=null),St(this,"tick"),this.ca&&(Cg(this),this.start()))}};oe.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Cg(t){t.ca=!1,t.R&&(t.g.clearTimeout(t.R),t.R=null)}oe.M=function(){Yu.X.M.call(this),Cg(this),delete this.g};function kg(t,e,n){if(typeof t=="function")n&&(t=Pt(t,n));else if(t&&typeof t.handleEvent=="function")t=Pt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ye.setTimeout(t,e||0)}function MS(t){t.g=kg(()=>{t.g=null,t.i&&(t.i=!1,MS(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class M$ extends di{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:MS(this)}M(){super.M(),this.g&&(ye.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ka(t){di.call(this),this.h=t,this.g={}}Ct(Ka,di);var lw=[];function OS(t,e,n,r){Array.isArray(n)||(n&&(lw[0]=n.toString()),n=lw);for(var i=0;i<n.length;i++){var s=xS(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function NS(t){wg(t.g,function(e,n){this.g.hasOwnProperty(n)&&Eg(e)},t),t.g={}}Ka.prototype.M=function(){Ka.X.M.call(this),NS(this)};Ka.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Qu(){this.g=!0}Qu.prototype.Aa=function(){this.g=!1};function O$(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+c+"&"):o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function N$(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function js(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+R$(t,n)+(r?" "+r:"")})}function D$(t,e){t.info(function(){return"TIMEOUT: "+e})}Qu.prototype.info=function(){};function R$(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Tg(n)}catch{return e}}var Es={},cw=null;function Zu(){return cw=cw||new ft}Es.Oa="serverreachability";function DS(t){Lt.call(this,Es.Oa,t)}Ct(DS,Lt);function qa(t){const e=Zu();St(e,new DS(e))}Es.STAT_EVENT="statevent";function RS(t,e){Lt.call(this,Es.STAT_EVENT,t),this.stat=e}Ct(RS,Lt);function jt(t){const e=Zu();St(e,new RS(e,t))}Es.Pa="timingevent";function PS(t,e){Lt.call(this,Es.Pa,t),this.size=e}Ct(PS,Lt);function fl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ye.setTimeout(function(){t()},e)}var eh={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,La:7,TIMEOUT:8,Cb:9},LS={qb:"complete",Mb:"success",Ma:"error",La:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Ig(){}Ig.prototype.h=null;function uw(t){return t.h||(t.h=t.i())}function BS(){}var pl={OPEN:"a",pb:"b",Ma:"c",Bb:"d"};function Ag(){Lt.call(this,"d")}Ct(Ag,Lt);function _g(){Lt.call(this,"c")}Ct(_g,Lt);var Bf;function th(){}Ct(th,Ig);th.prototype.g=function(){return new XMLHttpRequest};th.prototype.i=function(){return{}};Bf=new th;function gl(t,e,n,r){this.l=t,this.j=e,this.m=n,this.U=r||1,this.S=new Ka(this),this.O=P$,t=Of?125:void 0,this.T=new Yu(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new FS}function FS(){this.i=null,this.g="",this.h=!1}var P$=45e3,Ff={},eu={};oe=gl.prototype;oe.setTimeout=function(t){this.O=t};function Vf(t,e,n){t.K=1,t.v=rh(Cr(e)),t.s=n,t.P=!0,VS(t,null)}function VS(t,e){t.F=Date.now(),ml(t),t.A=Cr(t.v);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),WS(n.i,"t",r),t.C=0,n=t.l.H,t.h=new FS,t.g=pT(t.l,n?e:null,!t.s),0<t.N&&(t.L=new M$(Pt(t.Ka,t,t.g),t.N)),OS(t.S,t.g,"readystatechange",t.hb),e=t.H?vS(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.da(t.A,t.u,t.s,e)):(t.u="GET",t.g.da(t.A,t.u,null,e)),qa(),O$(t.j,t.u,t.A,t.m,t.U,t.s)}oe.hb=function(t){t=t.target;const e=this.L;e&&wr(t)==3?e.l():this.Ka(t)};oe.Ka=function(t){try{if(t==this.g)e:{const u=wr(this.g);var e=this.g.Ea();const h=this.g.aa();if(!(3>u)&&(u!=3||Of||this.g&&(this.h.h||this.g.fa()||pw(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?qa(3):qa(2)),nh(this);var n=this.g.aa();this.Y=n;t:if($S(this)){var r=pw(this.g);t="";var i=r.length,s=wr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$i(this),pa(this);var o="";break t}this.h.i=new ye.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=n==200,N$(this.j,this.u,this.A,this.m,this.U,u,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Qc(a)){var c=a;break t}}c=null}if(n=c)js(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,$f(this,n);else{this.i=!1,this.o=3,jt(12),$i(this),pa(this);break e}}this.P?(US(this,u,o),Of&&this.i&&u==3&&(OS(this.S,this.T,"tick",this.gb),this.T.start())):(js(this.j,this.m,o,null),$f(this,o)),u==4&&$i(this),this.i&&!this.I&&(u==4?uT(this.l,this):(this.i=!1,ml(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,jt(12)):(this.o=0,jt(13)),$i(this),pa(this)}}}catch{}finally{}};function $S(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Da:!1}function US(t,e,n){let r=!0,i;for(;!t.I&&t.C<n.length;)if(i=L$(t,n),i==eu){e==4&&(t.o=4,jt(14),r=!1),js(t.j,t.m,null,"[Incomplete Response]");break}else if(i==Ff){t.o=4,jt(15),js(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else js(t.j,t.m,i,null),$f(t,i);$S(t)&&i!=eu&&i!=Ff&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,jt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.$&&(t.$=!0,e=t.l,e.g==t&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Lg(e),e.K=!0,jt(11))):(js(t.j,t.m,n,"[Invalid Chunked Response]"),$i(t),pa(t))}oe.gb=function(){if(this.g){var t=wr(this.g),e=this.g.fa();this.C<e.length&&(nh(this),US(this,t,e),this.i&&t!=4&&ml(this))}};function L$(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?eu:(n=Number(e.substring(n,r)),isNaN(n)?Ff:(r+=1,r+n>e.length?eu:(e=e.substr(r,n),t.C=r+n,e)))}oe.cancel=function(){this.I=!0,$i(this)};function ml(t){t.V=Date.now()+t.O,zS(t,t.O)}function zS(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=fl(Pt(t.fb,t),e)}function nh(t){t.B&&(ye.clearTimeout(t.B),t.B=null)}oe.fb=function(){this.B=null;const t=Date.now();0<=t-this.V?(D$(this.j,this.A),this.K!=2&&(qa(),jt(17)),$i(this),this.o=2,pa(this)):zS(this,this.V-t)};function pa(t){t.l.G==0||t.I||uT(t.l,t)}function $i(t){nh(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Cg(t.T),NS(t.S),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function $f(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Uf(n.h,t))){if(!t.J&&Uf(n.h,t)&&n.G==3){try{var r=n.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)ru(n),oh(n);else break e;Pg(n),jt(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&n.A==0&&!n.v&&(n.v=fl(Pt(n.bb,n),6e3));if(1>=XS(n.h)&&n.ja){try{n.ja()}catch{}n.ja=void 0}}else Ui(n,11)}else if((t.J||n.g==t)&&ru(n),!Qc(e))for(i=n.Fa.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.T=c[0],c=c[1],n.G==2)if(c[0]=="c"){n.I=c[1],n.ka=c[2];const u=c[3];u!=null&&(n.ma=u,n.j.info("VER="+n.ma));const h=c[4];h!=null&&(n.Ca=h,n.j.info("SVER="+n.Ca));const d=c[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.h;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Mg(s,s.h),s.h=null))}if(r.D){const g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.za=g,Ke(r.F,r.D,g))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-t.F,n.j.info("Handshake RTT: "+n.P+"ms")),r=n;var o=t;if(r.sa=fT(r,r.H?r.ka:null,r.V),o.J){YS(r.h,o);var a=o,l=r.J;l&&a.setTimeout(l),a.B&&(nh(a),ml(a)),r.g=o}else lT(r);0<n.i.length&&ah(n)}else c[0]!="stop"&&c[0]!="close"||Ui(n,7);else n.G==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Ui(n,7):Rg(n):c[0]!="noop"&&n.l&&n.l.wa(c),n.A=0)}}qa(4)}catch{}}function B$(t){if(t.W&&typeof t.W=="function")return t.W();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Wu(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function F$(t){if(t.oa&&typeof t.oa=="function")return t.oa();if(!t.W||typeof t.W!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Wu(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function HS(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Wu(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=F$(t),r=B$(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var jS=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function V$(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Qi(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Qi){this.h=e!==void 0?e:t.h,tu(this,t.j),this.s=t.s,this.g=t.g,nu(this,t.m),this.l=t.l,e=t.i;var n=new Wa;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),hw(this,n),this.o=t.o}else t&&(n=String(t).match(jS))?(this.h=!!e,tu(this,n[1]||"",!0),this.s=Zo(n[2]||""),this.g=Zo(n[3]||"",!0),nu(this,n[4]),this.l=Zo(n[5]||"",!0),hw(this,n[6]||"",!0),this.o=Zo(n[7]||"")):(this.h=!!e,this.i=new Wa(null,this.h))}Qi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ea(e,dw,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(ea(e,dw,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(ea(n,n.charAt(0)=="/"?z$:U$,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ea(n,j$)),t.join("")};function Cr(t){return new Qi(t)}function tu(t,e,n){t.j=n?Zo(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function nu(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function hw(t,e,n){e instanceof Wa?(t.i=e,K$(t.i,t.h)):(n||(e=ea(e,H$)),t.i=new Wa(e,t.h))}function Ke(t,e,n){t.i.set(e,n)}function rh(t){return Ke(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Zo(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ea(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,$$),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function $$(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var dw=/[#\/\?@]/g,U$=/[#\?:]/g,z$=/[#\?]/g,H$=/[#\?@]/g,j$=/#/g;function Wa(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function fi(t){t.g||(t.g=new Map,t.h=0,t.i&&V$(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}oe=Wa.prototype;oe.add=function(t,e){fi(this),this.i=null,t=Do(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function KS(t,e){fi(t),e=Do(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function qS(t,e){return fi(t),e=Do(t,e),t.g.has(e)}oe.forEach=function(t,e){fi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};oe.oa=function(){fi(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};oe.W=function(t){fi(this);let e=[];if(typeof t=="string")qS(this,t)&&(e=e.concat(this.g.get(Do(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};oe.set=function(t,e){return fi(this),this.i=null,t=Do(this,t),qS(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};oe.get=function(t,e){return t?(t=this.W(t),0<t.length?String(t[0]):e):e};function WS(t,e,n){KS(t,e),0<n.length&&(t.i=null,t.g.set(Do(t,e),yg(n)),t.h+=n.length)}oe.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Do(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function K$(t,e){e&&!t.j&&(fi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(KS(this,r),WS(this,i,n))},t)),t.j=e}var q$=class{constructor(t,e){this.h=t,this.g=e}};function GS(t){this.l=t||W$,ye.PerformanceNavigationTiming?(t=ye.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ye.g&&ye.g.Ga&&ye.g.Ga()&&ye.g.Ga().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var W$=10;function JS(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function XS(t){return t.h?1:t.g?t.g.size:0}function Uf(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Mg(t,e){t.g?t.g.add(e):t.h=e}function YS(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}GS.prototype.cancel=function(){if(this.i=QS(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function QS(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return yg(t.i)}function Og(){}Og.prototype.stringify=function(t){return ye.JSON.stringify(t,void 0)};Og.prototype.parse=function(t){return ye.JSON.parse(t,void 0)};function G$(){this.g=new Og}function J$(t,e,n){const r=n||"";try{HS(t,function(i,s){let o=i;hl(i)&&(o=Tg(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function X$(t,e){const n=new Qu;if(ye.Image){const r=new Image;r.onload=Gl(Xl,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Gl(Xl,n,r,"TestLoadImage: error",!1,e),r.onabort=Gl(Xl,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Gl(Xl,n,r,"TestLoadImage: timeout",!1,e),ye.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Xl(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function yl(t){this.l=t.$b||null,this.j=t.ib||!1}Ct(yl,Ig);yl.prototype.g=function(){return new ih(this.l,this.j)};yl.prototype.i=function(t){return function(){return t}}({});function ih(t,e){ft.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Ng,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ct(ih,ft);var Ng=0;oe=ih.prototype;oe.open=function(t,e){if(this.readyState!=Ng)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ga(this)};oe.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ye).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ga.bind(this))};oe.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,bl(this)),this.readyState=Ng};oe.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ga(this)),this.g&&(this.readyState=3,Ga(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ga.bind(this));else if(typeof ye.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ZS(this)}else t.text().then(this.Ua.bind(this),this.ga.bind(this))};function ZS(t){t.j.read().then(t.Sa.bind(t)).catch(t.ga.bind(t))}oe.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?bl(this):Ga(this),this.readyState==3&&ZS(this)}};oe.Ua=function(t){this.g&&(this.response=this.responseText=t,bl(this))};oe.Ta=function(t){this.g&&(this.response=t,bl(this))};oe.ga=function(){this.g&&bl(this)};function bl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ga(t)}oe.setRequestHeader=function(t,e){this.v.append(t,e)};oe.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};oe.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ga(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(ih.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Y$=ye.JSON.parse;function rt(t){ft.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=eT,this.K=this.L=!1}Ct(rt,ft);var eT="",Q$=/^https?$/i,Z$=["POST","PUT"];oe=rt.prototype;oe.da=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Bf.g(),this.C=this.u?uw(this.u):uw(Bf),this.g.onreadystatechange=Pt(this.Ha,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(s){fw(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=ye.FormData&&t instanceof ye.FormData,!(0<=mS(Z$,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{rT(this),0<this.B&&((this.K=eU(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Pt(this.qa,this)):this.A=kg(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){fw(this,s)}};function eU(t){return wo&&y$()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}oe.qa=function(){typeof mg<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,St(this,"timeout"),this.abort(8))};function fw(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,tT(t),sh(t)}function tT(t){t.D||(t.D=!0,St(t,"complete"),St(t,"error"))}oe.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,St(this,"complete"),St(this,"abort"),sh(this))};oe.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),sh(this,!0)),rt.X.M.call(this)};oe.Ha=function(){this.s||(this.F||this.v||this.l?nT(this):this.eb())};oe.eb=function(){nT(this)};function nT(t){if(t.h&&typeof mg<"u"&&(!t.C[1]||wr(t)!=4||t.aa()!=2)){if(t.v&&wr(t)==4)kg(t.Ha,0,t);else if(St(t,"readystatechange"),wr(t)==4){t.h=!1;try{const a=t.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=a===0){var i=String(t.H).match(jS)[1]||null;if(!i&&ye.self&&ye.self.location){var s=ye.self.location.protocol;i=s.substr(0,s.length-1)}r=!Q$.test(i?i.toLowerCase():"")}n=r}if(n)St(t,"complete"),St(t,"success");else{t.m=6;try{var o=2<wr(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.aa()+"]",tT(t)}}finally{sh(t)}}}}function sh(t,e){if(t.g){rT(t);const n=t.g,r=t.C[0]?Yc:null;t.g=null,t.C=null,e||St(t,"ready");try{n.onreadystatechange=r}catch{}}}function rT(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ye.clearTimeout(t.A),t.A=null)}function wr(t){return t.g?t.g.readyState:0}oe.aa=function(){try{return 2<wr(this)?this.g.status:-1}catch{return-1}};oe.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}};oe.Ra=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Y$(e)}};function pw(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case eT:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}oe.Ea=function(){return this.m};oe.Na=function(){return typeof this.j=="string"?this.j:String(this.j)};function iT(t){let e="";return wg(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Dg(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=iT(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ke(t,e,n))}function Uo(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function sT(t){this.Ca=0,this.i=[],this.j=new Qu,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.$a=this.U=0,this.Ya=Uo("failFast",!1,t),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Wa=Uo("baseRetryDelayMs",5e3,t),this.ab=Uo("retryDelaySeedMs",1e4,t),this.Za=Uo("forwardChannelMaxRetries",2,t),this.ta=Uo("forwardChannelRequestTimeoutMs",2e4,t),this.ra=t&&t.xmlHttpFactory||void 0,this.Da=t&&t.Yb||!1,this.J=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.I="",this.h=new GS(t&&t.concurrentRequestLimit),this.Fa=new G$,this.O=t&&t.fastHandshake||!1,this.N=t&&t.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Xa=t&&t.Wb||!1,t&&t.Aa&&this.j.Aa(),t&&t.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&t&&t.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}oe=sT.prototype;oe.ma=8;oe.G=1;function Rg(t){if(oT(t),t.G==3){var e=t.U++,n=Cr(t.F);Ke(n,"SID",t.I),Ke(n,"RID",e),Ke(n,"TYPE","terminate"),wl(t,n),e=new gl(t,t.j,e,void 0),e.K=2,e.v=rh(Cr(n)),n=!1,ye.navigator&&ye.navigator.sendBeacon&&(n=ye.navigator.sendBeacon(e.v.toString(),"")),!n&&ye.Image&&(new Image().src=e.v,n=!0),n||(e.g=pT(e.l,null),e.g.da(e.v)),e.F=Date.now(),ml(e)}dT(t)}function oh(t){t.g&&(Lg(t),t.g.cancel(),t.g=null)}function oT(t){oh(t),t.u&&(ye.clearTimeout(t.u),t.u=null),ru(t),t.h.cancel(),t.m&&(typeof t.m=="number"&&ye.clearTimeout(t.m),t.m=null)}function ah(t){JS(t.h)||t.m||(t.m=!0,AS(t.Ja,t),t.C=0)}function tU(t,e){return XS(t.h)>=t.h.j-(t.m?1:0)?!1:t.m?(t.i=e.D.concat(t.i),!0):t.G==1||t.G==2||t.C>=(t.Ya?0:t.Za)?!1:(t.m=fl(Pt(t.Ja,t,e),hT(t,t.C)),t.C++,!0)}oe.Ja=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.U=Math.floor(1e5*Math.random()),t=this.U++;const i=new gl(this,this.j,t,void 0);let s=this.s;if(this.S&&(s?(s=vS(s),ES(s,this.S)):s=this.S),this.o!==null||this.N||(i.H=s,s=null),this.O)e:{for(var e=0,n=0;n<this.i.length;n++){t:{var r=this.i[n];if("__data__"in r.g&&(r=r.g.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.i.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=aT(this,i,e),n=Cr(this.F),Ke(n,"RID",t),Ke(n,"CVER",22),this.D&&Ke(n,"X-HTTP-Session-Id",this.D),wl(this,n),s&&(this.N?e="headers="+encodeURIComponent(String(iT(s)))+"&"+e:this.o&&Dg(n,this.o,s)),Mg(this.h,i),this.Xa&&Ke(n,"TYPE","init"),this.O?(Ke(n,"$req",e),Ke(n,"SID","null"),i.Z=!0,Vf(i,n,null)):Vf(i,n,e),this.G=2}}else this.G==3&&(t?gw(this,t):this.i.length==0||JS(this.h)||gw(this))};function gw(t,e){var n;e?n=e.m:n=t.U++;const r=Cr(t.F);Ke(r,"SID",t.I),Ke(r,"RID",n),Ke(r,"AID",t.T),wl(t,r),t.o&&t.s&&Dg(r,t.o,t.s),n=new gl(t,t.j,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.i=e.D.concat(t.i)),e=aT(t,n,1e3),n.setTimeout(Math.round(.5*t.ta)+Math.round(.5*t.ta*Math.random())),Mg(t.h,n),Vf(n,r,e)}function wl(t,e){t.ia&&wg(t.ia,function(n,r){Ke(e,r,n)}),t.l&&HS({},function(n,r){Ke(e,r,n)})}function aT(t,e,n){n=Math.min(t.i.length,n);var r=t.l?Pt(t.l.Qa,t.l,t):null;e:{var i=t.i;let s=-1;for(;;){const o=["count="+n];s==-1?0<n?(s=i[0].h,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=i[l].h;const u=i[l].g;if(c-=s,0>c)s=Math.max(0,i[l].h-100),a=!1;else try{J$(u,o,"req"+c+"_")}catch{r&&r(u)}}if(a){r=o.join("&");break e}}}return t=t.i.splice(0,n),e.D=t,r}function lT(t){t.g||t.u||(t.Z=1,AS(t.Ia,t),t.A=0)}function Pg(t){return t.g||t.u||3<=t.A?!1:(t.Z++,t.u=fl(Pt(t.Ia,t),hT(t,t.A)),t.A++,!0)}oe.Ia=function(){if(this.u=null,cT(this),this.$&&!(this.K||this.g==null||0>=this.P)){var t=2*this.P;this.j.info("BP detection timer enabled: "+t),this.B=fl(Pt(this.cb,this),t)}};oe.cb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,jt(10),oh(this),cT(this))};function Lg(t){t.B!=null&&(ye.clearTimeout(t.B),t.B=null)}function cT(t){t.g=new gl(t,t.j,"rpc",t.Z),t.o===null&&(t.g.H=t.s),t.g.N=0;var e=Cr(t.sa);Ke(e,"RID","rpc"),Ke(e,"SID",t.I),Ke(e,"CI",t.L?"0":"1"),Ke(e,"AID",t.T),Ke(e,"TYPE","xmlhttp"),wl(t,e),t.o&&t.s&&Dg(e,t.o,t.s),t.J&&t.g.setTimeout(t.J);var n=t.g;t=t.ka,n.K=1,n.v=rh(Cr(e)),n.s=null,n.P=!0,VS(n,t)}oe.bb=function(){this.v!=null&&(this.v=null,oh(this),Pg(this),jt(19))};function ru(t){t.v!=null&&(ye.clearTimeout(t.v),t.v=null)}function uT(t,e){var n=null;if(t.g==e){ru(t),Lg(t),t.g=null;var r=2}else if(Uf(t.h,e))n=e.D,YS(t.h,e),r=1;else return;if(t.G!=0){if(t.pa=e.Y,e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;r=Zu(),St(r,new PS(r,n)),ah(t)}else lT(t);else if(i=e.o,i==3||i==0&&0<t.pa||!(r==1&&tU(t,e)||r==2&&Pg(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:Ui(t,5);break;case 4:Ui(t,10);break;case 3:Ui(t,6);break;default:Ui(t,2)}}}function hT(t,e){let n=t.Wa+Math.floor(Math.random()*t.ab);return t.l||(n*=2),n*e}function Ui(t,e){if(t.j.info("Error code "+e),e==2){var n=null;t.l&&(n=null);var r=Pt(t.jb,t);n||(n=new Qi("//www.google.com/images/cleardot.gif"),ye.location&&ye.location.protocol=="http"||tu(n,"https"),rh(n)),X$(n.toString(),r)}else jt(2);t.G=0,t.l&&t.l.va(e),dT(t),oT(t)}oe.jb=function(t){t?(this.j.info("Successfully pinged google.com"),jt(2)):(this.j.info("Failed to ping google.com"),jt(1))};function dT(t){if(t.G=0,t.la=[],t.l){const e=QS(t.h);(e.length!=0||t.i.length!=0)&&(iw(t.la,e),iw(t.la,t.i),t.h.i.length=0,yg(t.i),t.i.length=0),t.l.ua()}}function fT(t,e,n){var r=n instanceof Qi?Cr(n):new Qi(n,void 0);if(r.g!="")e&&(r.g=e+"."+r.g),nu(r,r.m);else{var i=ye.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Qi(null,void 0);r&&tu(s,r),e&&(s.g=e),i&&nu(s,i),n&&(s.l=n),r=s}return n=t.D,e=t.za,n&&e&&Ke(r,n,e),Ke(r,"VER",t.ma),wl(t,r),r}function pT(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Da&&!t.ra?new rt(new yl({ib:!0})):new rt(t.ra),e.L=t.H,e}function gT(){}oe=gT.prototype;oe.xa=function(){};oe.wa=function(){};oe.va=function(){};oe.ua=function(){};oe.Qa=function(){};function iu(){if(wo&&!(10<=Number(b$)))throw Error("Environmental error: no available transport.")}iu.prototype.g=function(t,e){return new yn(t,e)};function yn(t,e){ft.call(this),this.g=new sT(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.S=t,(t=e&&e.Xb)&&!Qc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Qc(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new Ro(this)}Ct(yn,ft);yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;jt(0),t.V=e,t.ia=n||{},t.L=t.Y,t.F=fT(t,null,t.V),ah(t)};yn.prototype.close=function(){Rg(this.g)};yn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Tg(t),t=n);e.i.push(new q$(e.$a++,t)),e.G==3&&ah(e)};yn.prototype.M=function(){this.g.l=null,delete this.j,Rg(this.g),delete this.g,yn.X.M.call(this)};function mT(t){Ag.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}Ct(mT,Ag);function yT(){_g.call(this),this.status=1}Ct(yT,_g);function Ro(t){this.g=t}Ct(Ro,gT);Ro.prototype.xa=function(){St(this.g,"a")};Ro.prototype.wa=function(t){St(this.g,new mT(t))};Ro.prototype.va=function(t){St(this.g,new yT)};Ro.prototype.ua=function(){St(this.g,"b")};iu.prototype.createWebChannel=iu.prototype.g;yn.prototype.send=yn.prototype.u;yn.prototype.open=yn.prototype.m;yn.prototype.close=yn.prototype.close;eh.NO_ERROR=0;eh.TIMEOUT=8;eh.HTTP_ERROR=6;LS.COMPLETE="complete";BS.EventType=pl;pl.OPEN="a";pl.CLOSE="b";pl.ERROR="c";pl.MESSAGE="d";ft.prototype.listen=ft.prototype.N;rt.prototype.listenOnce=rt.prototype.O;rt.prototype.getLastError=rt.prototype.Na;rt.prototype.getLastErrorCode=rt.prototype.Ea;rt.prototype.getStatus=rt.prototype.aa;rt.prototype.getResponseJson=rt.prototype.Ra;rt.prototype.getResponseText=rt.prototype.fa;rt.prototype.send=rt.prototype.da;var nU=function(){return new iu},rU=function(){return Zu()},Td=eh,iU=LS,sU=Es,mw={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},oU=yl,Yl=BS,aU=rt;const yw="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}wt.UNAUTHENTICATED=new wt(null),wt.GOOGLE_CREDENTIALS=new wt("google-credentials-uid"),wt.FIRST_PARTY=new wt("first-party-uid"),wt.MOCK_USER=new wt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Po="9.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cs=new aS("@firebase/firestore");function zf(){return cs.logLevel}function K(t,...e){if(cs.logLevel<=Le.DEBUG){const n=e.map(Bg);cs.debug(`Firestore (${Po}): ${t}`,...n)}}function zt(t,...e){if(cs.logLevel<=Le.ERROR){const n=e.map(Bg);cs.error(`Firestore (${Po}): ${t}`,...n)}}function su(t,...e){if(cs.logLevel<=Le.WARN){const n=e.map(Bg);cs.warn(`Firestore (${Po}): ${t}`,...n)}}function Bg(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ae(t="Unexpected state"){const e=`FIRESTORE (${Po}) INTERNAL ASSERTION FAILED: `+t;throw zt(e),new Error(e)}function be(t,e){t||ae()}function we(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends vs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(wt.UNAUTHENTICATED))}shutdown(){}}class cU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class uU{constructor(e){this.t=e,this.currentUser=wt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new jn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new jn,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new jn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(be(typeof r.accessToken=="string"),new bT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return be(e===null||typeof e=="string"),new wt(e)}}class hU{constructor(e,n,r,i){this.h=e,this.l=n,this.m=r,this.g=i,this.type="FirstParty",this.user=wt.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(be(!(typeof this.h!="object"||this.h===null||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class dU{constructor(e,n,r,i){this.h=e,this.l=n,this.m=r,this.g=i}getToken(){return Promise.resolve(new hU(this.h,this.l,this.m,this.g))}start(e,n){e.enqueueRetryable(()=>n(wt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fU{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pU{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,n){const r=s=>{s.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.A;return this.A=s.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.T.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.T.getImmediate({optional:!0});s?i(s):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(be(typeof n.token=="string"),this.A=n.token,new fU(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gU(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=gU(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function Te(t,e){return t<e?-1:t>e?1:0}function vo(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function vT(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new se(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new se(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new se(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return We.fromMillis(Date.now())}static fromDate(e){return We.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new We(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ge(e)}static min(){return new ge(new We(0,0))}static max(){return new ge(new We(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,n,r){n===void 0?n=0:n>e.length&&ae(),r===void 0?r=e.length-n:r>e.length-n&&ae(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Ja.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Ja?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Ve extends Ja{construct(e,n,r){return new Ve(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Ve(n)}static emptyPath(){return new Ve([])}}const mU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tt extends Ja{construct(e,n,r){return new tt(e,n,r)}static isValidIdentifier(e){return mU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new tt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new se(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new se(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new se(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new se(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tt(n)}static emptyPath(){return new tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Ve.fromString(e))}static fromName(e){return new ee(Ve.fromString(e).popFirst(5))}static empty(){return new ee(Ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ve.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Ve(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Hf(t){return t.fields.find(e=>e.kind===2)}function Ii(t){return t.fields.filter(e=>e.kind!==2)}ET.UNKNOWN_ID=-1;class yU{constructor(e,n){this.fieldPath=e,this.kind=n}}class ou{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new ou(0,bn.min())}}function bU(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ge.fromTimestamp(r===1e9?new We(n+1,0):new We(n,r));return new bn(i,ee.empty(),e)}function xT(t){return new bn(t.readTime,t.key,-1)}class bn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new bn(ge.min(),ee.empty(),-1)}static max(){return new bn(ge.max(),ee.empty(),-1)}}function Fg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:Te(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class TT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xs(t){if(t.code!==U.FAILED_PRECONDITION||t.message!==ST)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new k((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof k?n:k.resolve(n)}catch(n){return k.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):k.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):k.reject(n)}static resolve(e){return new k((n,r)=>{n(e)})}static reject(e){return new k((n,r)=>{r(e)})}static waitFor(e){return new k((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=k.resolve(!1);for(const r of e)n=n.next(i=>i?k.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new k((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(u=>{o[c]=u,++a,a===s&&r(o)},u=>i(u))}})}static doWhile(e,n){return new k((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.P=new jn,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{n.error?this.P.reject(new ga(e,n.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=Vg(r.target.error);this.P.reject(new ga(e,i))}}static open(e,n,r,i){try{return new lh(n,e.transaction(i,r))}catch(s){throw new ga(n,s)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(K("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new vU(n)}}class vr{constructor(e,n,r){this.name=e,this.version=n,this.S=r,vr.D(Tf())===12.2&&zt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return K("SimpleDb","Removing database:",e),Ri(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!nS())return!1;if(vr.N())return!0;const e=Tf(),n=vr.D(e),r=0<n&&n<10,i=vr.k(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static N(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.O)==="YES"}static M(e,n){return e.store(n)}static D(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async F(e){return this.db||(K("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new ga(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new se(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new se(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ga(e,o))},i.onupgradeneeded=s=>{K("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.S.$(o,i.transaction,s.oldVersion,this.version).next(()=>{K("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.F(e);const a=lh.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.V(),c)).catch(c=>(a.abort(c),k.reject(c))).toPromise();return l.catch(()=>{}),await a.v,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(K("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}class wU{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return Ri(this.U.delete())}}class ga extends se{constructor(e,n){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function pi(t){return t.name==="IndexedDbTransactionError"}class vU{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(K("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(K("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ri(r)}add(e){return K("SimpleDb","ADD",this.store.name,e,e),Ri(this.store.add(e))}get(e){return Ri(this.store.get(e)).next(n=>(n===void 0&&(n=null),K("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return K("SimpleDb","DELETE",this.store.name,e),Ri(this.store.delete(e))}count(){return K("SimpleDb","COUNT",this.store.name),Ri(this.store.count())}W(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const i=this.cursor(r),s=[];return this.H(i,(o,a)=>{s.push(a)}).next(()=>s)}{const i=this.store.getAll(r.range);return new k((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}J(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new k((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}Y(e,n){K("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.X=!1;const i=this.cursor(r);return this.H(i,(s,o,a)=>a.delete())}Z(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.H(i,n)}tt(e){const n=this.cursor({});return new k((r,i)=>{n.onerror=s=>{const o=Vg(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}H(e,n){const r=[];return new k((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new wU(a),c=n(a.primaryKey,a.value,l);if(c instanceof k){const u=c.catch(h=>(l.done(),k.reject(h)));r.push(u)}l.isDone?i():l.G===null?a.continue():a.continue(l.G)}}).next(()=>k.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ri(t){return new k((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Vg(r.target.error);n(i)}})}let bw=!1;function Vg(t){const e=vr.D(Tf());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bw||(bw=!0,setTimeout(()=>{throw r},0)),r}}return t}class EU{constructor(e,n){this.asyncQueue=e,this.et=n,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}nt(e){K("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{K("IndexBackiller",`Documents written: ${await this.et.st()}`)}catch(n){pi(n)?K("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await xs(n)}await this.nt(6e4)})}}class xU{constructor(e,n){this.localStore=e,this.persistence=n}async st(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.it(n,e))}it(e,n){const r=new Set;let i=n,s=!0;return k.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return K("IndexBackiller",`Processing collection: ${o}`),this.rt(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}rt(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ot(i,s)).next(a=>(K("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ot(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=xT(s);Fg(o,r)>0&&(r=o)}),new bn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>n.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ss(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function CT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In.at=-1;class it{constructor(e,n){this.comparator=e,this.root=n||vt.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,vt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,vt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ql(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ql(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ql(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ql(this.root,e,this.comparator,!0)}}class Ql{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class vt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r!=null?r:vt.RED,this.left=i!=null?i:vt.EMPTY,this.right=s!=null?s:vt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new vt(e!=null?e:this.key,n!=null?n:this.value,r!=null?r:this.color,i!=null?i:this.left,s!=null?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return vt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return vt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,vt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,vt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ae();const e=this.left.check();if(e!==this.right.check())throw ae();return e+(this.isRed()?0:1)}}vt.EMPTY=null,vt.RED=!0,vt.BLACK=!1;vt.EMPTY=new class{constructor(){this.size=0}get key(){throw ae()}get value(){throw ae()}get color(){throw ae()}get left(){throw ae()}get right(){throw ae()}copy(t,e,n,r,i){return this}insert(t,e,n){return new vt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new vw(this.data.getIterator())}getIteratorFrom(e){return new vw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof $e)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new $e(this.comparator);return n.data=e,n}}class vw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Os(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(tt.comparator)}static empty(){return new fn([])}unionWith(e){let n=new $e(tt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new fn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new pt(n)}static fromUint8Array(e){const n=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new pt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}pt.EMPTY_BYTE_STRING=new pt("");const SU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oi(t){if(be(!!t),typeof t=="string"){let e=0;const n=SU.exec(t);if(be(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function us(t){return typeof t=="string"?pt.fromBase64String(t):pt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function IT(t){const e=t.mapValue.fields.__previous_value__;return kT(e)?IT(e):e}function Xa(t){const e=oi(t.mapValue.fields.__local_write_time__.timestampValue);return new We(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(e,n,r,i,s,o,a,l){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=l}}class hs{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new hs("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof hs&&e.projectId===this.projectId&&e.database===this.database}}function ch(t){return t==null}function Ya(t){return t===0&&1/t==-1/0}function CU(t){return typeof t=="number"&&Number.isInteger(t)&&!Ya(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},mc={nullValue:"NULL_VALUE"};function ds(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?kT(t)?4:AT(t)?9007199254740991:10:ae()}function fr(t,e){if(t===e)return!0;const n=ds(t);if(n!==ds(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xa(t).isEqual(Xa(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const s=oi(r.timestampValue),o=oi(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return us(r.bytesValue).isEqual(us(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return Ge(r.geoPointValue.latitude)===Ge(i.geoPointValue.latitude)&&Ge(r.geoPointValue.longitude)===Ge(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Ge(r.integerValue)===Ge(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const s=Ge(r.doubleValue),o=Ge(i.doubleValue);return s===o?Ya(s)===Ya(o):isNaN(s)&&isNaN(o)}return!1}(t,e);case 9:return vo(t.arrayValue.values||[],e.arrayValue.values||[],fr);case 10:return function(r,i){const s=r.mapValue.fields||{},o=i.mapValue.fields||{};if(ww(s)!==ww(o))return!1;for(const a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!fr(s[a],o[a])))return!1;return!0}(t,e);default:return ae()}}function Qa(t,e){return(t.values||[]).find(n=>fr(n,e))!==void 0}function ai(t,e){if(t===e)return 0;const n=ds(t),r=ds(e);if(n!==r)return Te(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Te(t.booleanValue,e.booleanValue);case 2:return function(i,s){const o=Ge(i.integerValue||i.doubleValue),a=Ge(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return Ew(t.timestampValue,e.timestampValue);case 4:return Ew(Xa(t),Xa(e));case 5:return Te(t.stringValue,e.stringValue);case 6:return function(i,s){const o=us(i),a=us(s);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(i,s){const o=i.split("/"),a=s.split("/");for(let l=0;l<o.length&&l<a.length;l++){const c=Te(o[l],a[l]);if(c!==0)return c}return Te(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,s){const o=Te(Ge(i.latitude),Ge(s.latitude));return o!==0?o:Te(Ge(i.longitude),Ge(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(i,s){const o=i.values||[],a=s.values||[];for(let l=0;l<o.length&&l<a.length;++l){const c=ai(o[l],a[l]);if(c)return c}return Te(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===jr.mapValue&&s===jr.mapValue)return 0;if(i===jr.mapValue)return 1;if(s===jr.mapValue)return-1;const o=i.fields||{},a=Object.keys(o),l=s.fields||{},c=Object.keys(l);a.sort(),c.sort();for(let u=0;u<a.length&&u<c.length;++u){const h=Te(a[u],c[u]);if(h!==0)return h;const d=ai(o[a[u]],l[c[u]]);if(d!==0)return d}return Te(a.length,c.length)}(t.mapValue,e.mapValue);default:throw ae()}}function Ew(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Te(t,e);const n=oi(t),r=oi(e),i=Te(n.seconds,r.seconds);return i!==0?i:Te(n.nanos,r.nanos)}function eo(t){return jf(t)}function jf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const i=oi(r);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?us(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,ee.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let i="[",s=!0;for(const o of r.values||[])s?s=!1:i+=",",i+=jf(o);return i+"]"}(t.arrayValue):"mapValue"in t?function(r){const i=Object.keys(r.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${jf(r.fields[a])}`;return s+"}"}(t.mapValue):ae();var e,n}function $g(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Kf(t){return!!t&&"integerValue"in t}function Za(t){return!!t&&"arrayValue"in t}function xw(t){return!!t&&"nullValue"in t}function Sw(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function yc(t){return!!t&&"mapValue"in t}function ma(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ss(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ma(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ma(t.arrayValue.values[n]);return e}return Object.assign({},t)}function AT(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function kU(t){return"nullValue"in t?mc:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?$g(hs.empty(),ee.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:ae()}function IU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?$g(hs.empty(),ee.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?jr:ae()}function Tw(t,e){const n=ai(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Cw(t,e){const n=ai(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.value=e}static empty(){return new Ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!yc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ma(n)}setAll(e){let n=tt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ma(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());yc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return fr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];yc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Ss(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Ot(ma(this.value))}}function _T(t){const e=[];return Ss(t.fields,(n,r)=>{const i=new tt([n]);if(yc(r)){const s=_T(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,n,r,i,s,o){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new qe(e,0,ge.min(),ge.min(),Ot.empty(),0)}static newFoundDocument(e,n,r){return new qe(e,1,n,ge.min(),r,0)}static newNoDocument(e,n){return new qe(e,2,n,ge.min(),Ot.empty(),0)}static newUnknownDocument(e,n){return new qe(e,3,n,ge.min(),Ot.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ge.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qe(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ht=null}}function kw(t,e=null,n=[],r=[],i=null,s=null,o=null){return new AU(t,e,n,r,i,s,o)}function fs(t){const e=we(t);if(e.ht===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+eo(i.value);var i}).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),ch(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>eo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>eo(r)).join(",")),e.ht=n}return e.ht}function _U(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(r=n).field.canonicalString()} ${r.op} ${eo(r.value)}`;var r}).join(", ")}]`),ch(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(r){return`${r.field.canonicalString()} (${r.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>eo(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>eo(n)).join(",")),`Target(${e})`}function vl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<t.orderBy.length;i++)if(!BU(t.orderBy[i],e.orderBy[i]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!fr(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Mw(t.startAt,e.startAt)&&Mw(t.endAt,e.endAt)}function au(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function lu(t,e){return t.filters.filter(n=>n instanceof Rt&&n.field.isEqual(e))}function Iw(t,e,n){let r=mc,i=!0;for(const s of lu(t,e)){let o=mc,a=!0;switch(s.op){case"<":case"<=":o=kU(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=mc}Tw({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Tw({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function Aw(t,e,n){let r=jr,i=!0;for(const s of lu(t,e)){let o=jr,a=!0;switch(s.op){case">=":case">":o=IU(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=jr}Cw({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Cw({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}class Rt extends class{}{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.lt(e,n,r):new MU(e,n,r):n==="array-contains"?new DU(e,r):n==="in"?new RU(e,r):n==="not-in"?new PU(e,r):n==="array-contains-any"?new LU(e,r):new Rt(e,n,r)}static lt(e,n,r){return n==="in"?new OU(e,r):new NU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.ft(ai(n,this.value)):n!==null&&ds(this.value)===ds(n)&&this.ft(ai(n,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ae()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class MU extends Rt{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.ft(n)}}class OU extends Rt{constructor(e,n){super(e,"in",n),this.keys=MT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class NU extends Rt{constructor(e,n){super(e,"not-in",n),this.keys=MT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function MT(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class DU extends Rt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Za(n)&&Qa(n.arrayValue,this.value)}}class RU extends Rt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Qa(this.value.arrayValue,n)}}class PU extends Rt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Qa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Qa(this.value.arrayValue,n)}}class LU extends Rt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Za(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Qa(this.value.arrayValue,r))}}class Eo{constructor(e,n){this.position=e,this.inclusive=n}}class ya{constructor(e,n="asc"){this.field=e,this.dir=n}}function BU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function _w(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=ai(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mw(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!fr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this._t=null,this.wt=null,this.startAt,this.endAt}}function FU(t,e,n,r,i,s,o,a){return new uh(t,e,n,r,i,s,o,a)}function hh(t){return new uh(t)}function Ow(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function VU(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function $U(t){for(const e of t.filters)if(e.dt())return e.field;return null}function UU(t){return t.collectionGroup!==null}function el(t){const e=we(t);if(e._t===null){e._t=[];const n=$U(e),r=VU(e);if(n!==null&&r===null)n.isKeyField()||e._t.push(new ya(n)),e._t.push(new ya(tt.keyField(),"asc"));else{let i=!1;for(const s of e.explicitOrderBy)e._t.push(s),s.field.isKeyField()&&(i=!0);if(!i){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new ya(tt.keyField(),s))}}}return e._t}function qn(t){const e=we(t);if(!e.wt)if(e.limitType==="F")e.wt=kw(e.path,e.collectionGroup,el(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const s of el(e)){const o=s.dir==="desc"?"asc":"desc";n.push(new ya(s.field,o))}const r=e.endAt?new Eo(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Eo(e.startAt.position,e.startAt.inclusive):null;e.wt=kw(e.path,e.collectionGroup,n,e.filters,e.limit,r,i)}return e.wt}function qf(t,e,n){return new uh(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function dh(t,e){return vl(qn(t),qn(e))&&t.limitType===e.limitType}function OT(t){return`${fs(qn(t))}|lt:${t.limitType}`}function Wf(t){return`Query(target=${_U(qn(t))}; limitType=${t.limitType})`}function Ug(t,e){return e.isFoundDocument()&&function(n,r){const i=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):ee.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,r){for(const i of n.explicitOrderBy)if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const i of n.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(i,s,o){const a=_w(i,s,o);return i.inclusive?a<=0:a<0}(n.startAt,el(n),r)||n.endAt&&!function(i,s,o){const a=_w(i,s,o);return i.inclusive?a>=0:a>0}(n.endAt,el(n),r))}(t,e)}function zU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function NT(t){return(e,n)=>{let r=!1;for(const i of el(t)){const s=HU(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function HU(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,s,o){const a=s.data.field(i),l=o.data.field(i);return a!==null&&l!==null?ai(a,l):ae()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT(t,e){if(t.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ya(e)?"-0":e}}function RT(t){return{integerValue:""+t}}function jU(t,e){return CU(e)?RT(e):DT(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(){this._=void 0}}function KU(t,e,n){return t instanceof tl?function(r,i){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(s.fields.__previous_value__=i),{mapValue:s}}(n,e):t instanceof xo?LT(t,e):t instanceof So?BT(t,e):function(r,i){const s=PT(r,i),o=Nw(s)+Nw(r.yt);return Kf(s)&&Kf(r.yt)?RT(o):DT(r.It,o)}(t,e)}function qU(t,e,n){return t instanceof xo?LT(t,e):t instanceof So?BT(t,e):n}function PT(t,e){return t instanceof nl?Kf(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class tl extends fh{}class xo extends fh{constructor(e){super(),this.elements=e}}function LT(t,e){const n=FT(e);for(const r of t.elements)n.some(i=>fr(i,r))||n.push(r);return{arrayValue:{values:n}}}class So extends fh{constructor(e){super(),this.elements=e}}function BT(t,e){let n=FT(e);for(const r of t.elements)n=n.filter(i=>!fr(i,r));return{arrayValue:{values:n}}}class nl extends fh{constructor(e,n){super(),this.It=e,this.yt=n}}function Nw(t){return Ge(t.integerValue||t.doubleValue)}function FT(t){return Za(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,n){this.field=e,this.transform=n}}function GU(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof xo&&r instanceof xo||n instanceof So&&r instanceof So?vo(n.elements,r.elements,fr):n instanceof nl&&r instanceof nl?fr(n.yt,r.yt):n instanceof tl&&r instanceof tl}(t.transform,e.transform)}class JU{constructor(e,n){this.version=e,this.transformResults=n}}class Kt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Kt}static exists(e){return new Kt(void 0,e)}static updateTime(e){return new Kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ph{}function VT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new gh(t.key,Kt.none()):new Lo(t.key,t.data,Kt.none());{const n=t.data,r=Ot.empty();let i=new $e(tt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ir(t.key,r,new fn(i.toArray()),Kt.none())}}function XU(t,e,n){t instanceof Lo?function(r,i,s){const o=r.value.clone(),a=Rw(r.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Ir?function(r,i,s){if(!bc(r.precondition,i))return void i.convertToUnknownDocument(s.version);const o=Rw(r.fieldTransforms,i,s.transformResults),a=i.data;a.setAll($T(r)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(t,e,n):function(r,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function ba(t,e,n,r){return t instanceof Lo?function(i,s,o,a){if(!bc(i.precondition,s))return o;const l=i.value.clone(),c=Pw(i.fieldTransforms,a,s);return l.setAll(c),s.convertToFoundDocument(s.version,l).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ir?function(i,s,o,a){if(!bc(i.precondition,s))return o;const l=Pw(i.fieldTransforms,a,s),c=s.data;return c.setAll($T(i)),c.setAll(l),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(u=>u.field))}(t,e,n,r):function(i,s,o){return bc(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(t,e,n)}function YU(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=PT(r.transform,i||null);s!=null&&(n===null&&(n=Ot.empty()),n.set(r.field,s))}return n||null}function Dw(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&vo(n,r,(i,s)=>GU(i,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Lo extends ph{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ir extends ph{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function $T(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Rw(t,e,n){const r=new Map;be(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,qU(o,a,n[i]))}return r}function Pw(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,KU(s,o,e))}return r}class gh extends ph{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class UT extends ph{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QU{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ze,_e;function ZU(t){switch(t){default:return ae();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function zT(t){if(t===void 0)return zt("GRPC error has no .code"),U.UNKNOWN;switch(t){case Ze.OK:return U.OK;case Ze.CANCELLED:return U.CANCELLED;case Ze.UNKNOWN:return U.UNKNOWN;case Ze.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Ze.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Ze.INTERNAL:return U.INTERNAL;case Ze.UNAVAILABLE:return U.UNAVAILABLE;case Ze.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Ze.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Ze.NOT_FOUND:return U.NOT_FOUND;case Ze.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Ze.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Ze.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Ze.ABORTED:return U.ABORTED;case Ze.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Ze.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Ze.DATA_LOSS:return U.DATA_LOSS;default:return ae()}}(_e=Ze||(Ze={}))[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ss(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return CT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ez=new it(ee.comparator);function hn(){return ez}const HT=new it(ee.comparator);function ta(...t){let e=HT;for(const n of t)e=e.insert(n.key,n);return e}function jT(t){let e=HT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function sr(){return wa()}function KT(){return wa()}function wa(){return new gi(t=>t.toString(),(t,e)=>t.isEqual(e))}const tz=new it(ee.comparator),nz=new $e(ee.comparator);function Ie(...t){let e=nz;for(const n of t)e=e.add(n);return e}const rz=new $e(Te);function qT(){return rz}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n){const r=new Map;return r.set(e,El.createSynthesizedTargetChangeForCurrentChange(e,n)),new mh(ge.min(),r,qT(),hn(),Ie())}}class El{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n){return new El(pt.EMPTY_BYTE_STRING,n,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n,r,i){this.Tt=e,this.removedTargetIds=n,this.key=r,this.Et=i}}class WT{constructor(e,n){this.targetId=e,this.At=n}}class GT{constructor(e,n,r=pt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Lw{constructor(){this.Rt=0,this.bt=Fw(),this.Pt=pt.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return this.Rt!==0}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=Ie(),n=Ie(),r=Ie();return this.bt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ae()}}),new El(this.Pt,this.vt,e,n,r)}Nt(){this.Vt=!1,this.bt=Fw()}kt(e,n){this.Vt=!0,this.bt=this.bt.insert(e,n)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class iz{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=hn(),this.qt=Bw(),this.Kt=new $e(Te)}Gt(e){for(const n of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(n,e.Et):this.jt(n,e.key,e.Et);for(const n of e.removedTargetIds)this.jt(n,e.key,e.Et)}Wt(e){this.forEachTarget(e,n=>{const r=this.zt(n);switch(e.state){case 0:this.Ht(n)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(n);break;case 3:this.Ht(n)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(n)&&(this.Jt(n),r.Ct(e.resumeToken));break;default:ae()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Lt.forEach((r,i)=>{this.Ht(i)&&n(i)})}Yt(e){const n=e.targetId,r=e.At.count,i=this.Xt(n);if(i){const s=i.target;if(au(s))if(r===0){const o=new ee(s.path);this.jt(n,o,qe.newNoDocument(o,ge.min()))}else be(r===1);else this.Zt(n)!==r&&(this.Jt(n),this.Kt=this.Kt.add(n))}}te(e){const n=new Map;this.Lt.forEach((s,o)=>{const a=this.Xt(o);if(a){if(s.current&&au(a.target)){const l=new ee(a.target.path);this.Ut.get(l)!==null||this.ee(o,l)||this.jt(o,l,qe.newNoDocument(l,e))}s.Dt&&(n.set(o,s.xt()),s.Nt())}});let r=Ie();this.qt.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Xt(l);return!c||c.purpose===2||(a=!1,!1)}),a&&(r=r.add(s))}),this.Ut.forEach((s,o)=>o.setReadTime(e));const i=new mh(e,n,this.Kt,this.Ut,r);return this.Ut=hn(),this.qt=Bw(),this.Kt=new $e(Te),i}Qt(e,n){if(!this.Ht(e))return;const r=this.ee(e,n.key)?2:0;this.zt(e).kt(n.key,r),this.Ut=this.Ut.insert(n.key,n),this.qt=this.qt.insert(n.key,this.ne(n.key).add(e))}jt(e,n,r){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,n)?i.kt(n,1):i.Ot(n),this.qt=this.qt.insert(n,this.ne(n).delete(e)),r&&(this.Ut=this.Ut.insert(n,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const n=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let n=this.Lt.get(e);return n||(n=new Lw,this.Lt.set(e,n)),n}ne(e){let n=this.qt.get(e);return n||(n=new $e(Te),this.qt=this.qt.insert(e,n)),n}Ht(e){const n=this.Xt(e)!==null;return n||K("WatchChangeAggregator","Detected inactive target",e),n}Xt(e){const n=this.Lt.get(e);return n&&n.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new Lw),this.Bt.getRemoteKeysForTarget(e).forEach(n=>{this.jt(e,n,null)})}ee(e,n){return this.Bt.getRemoteKeysForTarget(e).has(n)}}function Bw(){return new it(ee.comparator)}function Fw(){return new it(ee.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sz=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),oz=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class az{constructor(e,n){this.databaseId=e,this.gt=n}}function rl(t,e){return t.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JT(t,e){return t.gt?e.toBase64():e.toUint8Array()}function lz(t,e){return rl(t,e.toTimestamp())}function pn(t){return be(!!t),ge.fromTimestamp(function(e){const n=oi(e);return new We(n.seconds,n.nanos)}(t))}function zg(t,e){return function(n){return new Ve(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function XT(t){const e=Ve.fromString(t);return be(r1(e)),e}function cu(t,e){return zg(t.databaseId,e.path)}function Zi(t,e){const n=XT(e);if(n.get(1)!==t.databaseId.projectId)throw new se(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new se(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(QT(n))}function Gf(t,e){return zg(t.databaseId,e)}function YT(t){const e=XT(t);return e.length===4?Ve.emptyPath():QT(e)}function Jf(t){return new Ve(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function QT(t){return be(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Vw(t,e,n){return{name:cu(t,e),fields:n.value.mapValue.fields}}function cz(t,e,n){const r=Zi(t,e.name),i=pn(e.updateTime),s=new Ot({mapValue:{fields:e.fields}}),o=qe.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function uz(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,c){return l.gt?(be(c===void 0||typeof c=="string"),pt.fromBase64String(c||"")):(be(c===void 0||c instanceof Uint8Array),pt.fromUint8Array(c||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){const c=l.code===void 0?U.UNKNOWN:zT(l.code);return new se(c,l.message||"")}(o);n=new GT(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Zi(t,r.document.name),s=pn(r.document.updateTime),o=new Ot({mapValue:{fields:r.document.fields}}),a=qe.newFoundDocument(i,s,o),l=r.targetIds||[],c=r.removedTargetIds||[];n=new wc(l,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Zi(t,r.document),s=r.readTime?pn(r.readTime):ge.min(),o=qe.newNoDocument(i,s),a=r.removedTargetIds||[];n=new wc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Zi(t,r.document),s=r.removedTargetIds||[];n=new wc([],s,i,null)}else{if(!("filter"in e))return ae();{e.filter;const r=e.filter;r.targetId;const i=r.count||0,s=new QU(i),o=r.targetId;n=new WT(o,s)}}return n}function uu(t,e){let n;if(e instanceof Lo)n={update:Vw(t,e.key,e.value)};else if(e instanceof gh)n={delete:cu(t,e.key)};else if(e instanceof Ir)n={update:Vw(t,e.key,e.data),updateMask:yz(e.fieldMask)};else{if(!(e instanceof UT))return ae();n={verify:cu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,s){const o=s.transform;if(o instanceof tl)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof xo)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof So)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof nl)return{fieldPath:s.field.canonicalString(),increment:o.yt};throw ae()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:lz(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ae()}(t,e.precondition)),n}function Xf(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Kt.updateTime(pn(i.updateTime)):i.exists!==void 0?Kt.exists(i.exists):Kt.none()}(e.currentDocument):Kt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let a=null;if("setToServerValue"in o)be(o.setToServerValue==="REQUEST_TIME"),a=new tl;else if("appendMissingElements"in o){const c=o.appendMissingElements.values||[];a=new xo(c)}else if("removeAllFromArray"in o){const c=o.removeAllFromArray.values||[];a=new So(c)}else"increment"in o?a=new nl(s,o.increment):ae();const l=tt.fromServerFormat(o.fieldPath);return new WU(l,a)}(t,i)):[];if(e.update){e.update.name;const i=Zi(t,e.update.name),s=new Ot({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const l=a.fieldPaths||[];return new fn(l.map(c=>tt.fromServerFormat(c)))}(e.updateMask);return new Ir(i,s,o,n,r)}return new Lo(i,s,n,r)}if(e.delete){const i=Zi(t,e.delete);return new gh(i,n)}if(e.verify){const i=Zi(t,e.verify);return new UT(i,n)}return ae()}function hz(t,e){return t&&t.length>0?(be(e!==void 0),t.map(n=>function(r,i){let s=r.updateTime?pn(r.updateTime):pn(i);return s.isEqual(ge.min())&&(s=pn(i)),new JU(s,r.transformResults||[])}(n,e))):[]}function ZT(t,e){return{documents:[Gf(t,e.path)]}}function e1(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Gf(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Gf(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(l){if(l.length===0)return;const c=l.map(u=>function(h){if(h.op==="=="){if(Sw(h.value))return{unaryFilter:{field:Ns(h.field),op:"IS_NAN"}};if(xw(h.value))return{unaryFilter:{field:Ns(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(Sw(h.value))return{unaryFilter:{field:Ns(h.field),op:"IS_NOT_NAN"}};if(xw(h.value))return{unaryFilter:{field:Ns(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ns(h.field),op:pz(h.op),value:h.value}}}(u));return c.length===1?c[0]:{compositeFilter:{op:"AND",filters:c}}}(e.filters);i&&(n.structuredQuery.where=i);const s=function(l){if(l.length!==0)return l.map(c=>function(u){return{field:Ns(u.field),direction:fz(u.dir)}}(c))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(l,c){return l.gt||ch(c)?c:{value:c}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),n}function t1(t){let e=YT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){be(r===1);const u=n.from[0];u.allDescendants?i=u.collectionId:e=e.child(u.collectionId)}let s=[];n.where&&(s=n1(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new ya(Ks(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,ch(h)?null:h}(n.limit));let l=null;n.startAt&&(l=function(u){const h=!!u.before,d=u.values||[];return new Eo(d,h)}(n.startAt));let c=null;return n.endAt&&(c=function(u){const h=!u.before,d=u.values||[];return new Eo(d,h)}(n.endAt)),FU(e,i,o,s,a,"F",l,c)}function dz(t,e){const n=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ae()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function n1(t){return t?t.unaryFilter!==void 0?[mz(t)]:t.fieldFilter!==void 0?[gz(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>n1(e)).reduce((e,n)=>e.concat(n)):ae():[]}function fz(t){return sz[t]}function pz(t){return oz[t]}function Ns(t){return{fieldPath:t.canonicalString()}}function Ks(t){return tt.fromServerFormat(t.fieldPath)}function gz(t){return Rt.create(Ks(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ae()}}(t.fieldFilter.op),t.fieldFilter.value)}function mz(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Ks(t.unaryFilter.field);return Rt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Ks(t.unaryFilter.field);return Rt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ks(t.unaryFilter.field);return Rt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ks(t.unaryFilter.field);return Rt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ae()}}function yz(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function r1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$w(e)),e=bz(t.get(n),e);return $w(e)}function bz(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function $w(t){return t+""}function or(t){const e=t.length;if(be(e>=2),e===2)return be(t.charAt(0)===""&&t.charAt(1)===""),Ve.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&ae(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ae()}s=o+2}return new Ve(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vc(t,e){return[t,qt(e)]}function i1(t,e,n){return[t,qt(e),n]}const wz={},vz=["prefixPath","collectionGroup","readTime","documentId"],Ez=["prefixPath","collectionGroup","documentId"],xz=["collectionGroup","readTime","prefixPath","documentId"],Sz=["canonicalId","targetId"],Tz=["targetId","path"],Cz=["path","targetId"],kz=["collectionId","parent"],Iz=["indexId","uid"],Az=["uid","sequenceNumber"],_z=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Mz=["indexId","uid","orderedDocumentKey"],Oz=["userId","collectionPath","documentId"],Nz=["userId","collectionPath","largestBatchId"],Dz=["userId","collectionGroup","largestBatchId"],s1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Rz=[...s1,"documentOverlays"],o1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],a1=o1,Pz=[...a1,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf extends TT{constructor(e,n){super(),this.ie=e,this.currentSequenceNumber=n}}function gt(t,e){const n=we(t);return vr.M(n.ie,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&XU(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=ba(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=ba(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=KT();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=VT(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(ge.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ie())}isEqual(e){return this.batchId===e.batchId&&vo(this.mutations,e.mutations,(n,r)=>Dw(n,r))&&vo(this.baseMutations,e.baseMutations,(n,r)=>Dw(n,r))}}class jg{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){be(e.mutations.length===r.length);let i=tz;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new jg(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,n,r,i,s=ge.min(),o=ge.min(),a=pt.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new Zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e){this.re=e}}function Lz(t,e){let n;if(e.document)n=cz(t.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),i=gs(e.noDocument.readTime);n=qe.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ae();{const r=ee.fromSegments(e.unknownDocument.path),i=gs(e.unknownDocument.version);n=qe.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(r){const i=new We(r[0],r[1]);return ge.fromTimestamp(i)}(e.readTime)),n}function zw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:hu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,s){return{name:cu(i,s.key),fields:s.data.value.mapValue.fields,updateTime:rl(i,s.version.toTimestamp())}}(t.re,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ps(e.version)};else{if(!e.isUnknownDocument())return ae();r.unknownDocument={path:n.path.toArray(),version:ps(e.version)}}return r}function hu(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ps(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function gs(t){const e=new We(t.seconds,t.nanoseconds);return ge.fromTimestamp(e)}function Pi(t,e){const n=(e.baseMutations||[]).map(s=>Xf(t.re,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Xf(t.re,s)),i=We.fromMillis(e.localWriteTimeMs);return new Hg(e.batchId,i,n,r)}function na(t){const e=gs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?gs(t.lastLimboFreeSnapshotVersion):ge.min();let r;var i;return t.query.documents!==void 0?(be((i=t.query).documents.length===1),r=qn(hh(YT(i.documents[0])))):r=function(s){return qn(t1(s))}(t.query),new Zr(r,t.targetId,0,t.lastListenSequenceNumber,e,n,pt.fromBase64String(t.resumeToken))}function c1(t,e){const n=ps(e.snapshotVersion),r=ps(e.lastLimboFreeSnapshotVersion);let i;i=au(e.target)?ZT(t.re,e.target):e1(t.re,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:fs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function u1(t){const e=t1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qf(e,e.limit,"L"):e}function Cd(t,e){return new Kg(e.largestBatchId,Xf(t.re,e.overlayMutation))}function Hw(t,e){const n=e.path.lastSegment();return[t,qt(e.path.popLast()),n]}function jw(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:ps(r.readTime),documentKey:qt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{getBundleMetadata(e,n){return Kw(e).get(n).next(r=>{if(r)return{id:(i=r).bundleId,createTime:gs(i.createTime),version:i.version};var i})}saveBundleMetadata(e,n){return Kw(e).put({bundleId:(r=n).id,createTime:ps(pn(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return qw(e).get(n).next(r=>{if(r)return{name:(i=r).name,query:u1(i.bundledQuery),readTime:gs(i.readTime)};var i})}saveNamedQuery(e,n){return qw(e).put(function(r){return{name:r.name,readTime:ps(pn(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function Kw(t){return gt(t,"bundles")}function qw(t){return gt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,n){this.It=e,this.userId=n}static oe(e,n){const r=n.uid||"";return new yh(e,r)}getOverlay(e,n){return zo(e).get(Hw(this.userId,n)).next(r=>r?Cd(this.It,r):null)}getOverlays(e,n){const r=sr();return k.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Kg(n,o);i.push(this.ue(e,a))}),k.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(qt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(zo(e).Y("collectionPathOverlayIndex",a))}),k.waitFor(s)}getOverlaysForCollection(e,n,r){const i=sr(),s=qt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return zo(e).W("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Cd(this.It,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=sr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return zo(e).Z({index:"collectionGroupOverlayIndex",range:a},(l,c,u)=>{const h=Cd(this.It,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>s)}ue(e,n){return zo(e).put(function(r,i,s){const[o,a,l]=Hw(i,s.mutation.key);return{userId:i,collectionPath:a,documentId:l,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:uu(r.re,s.mutation)}}(this.It,this.userId,n))}}function zo(t){return gt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(){}ce(e,n){this.ae(e,n),n.he()}ae(e,n){if("nullValue"in e)this.le(n,5);else if("booleanValue"in e)this.le(n,10),n.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(n,15),n.fe(Ge(e.integerValue));else if("doubleValue"in e){const r=Ge(e.doubleValue);isNaN(r)?this.le(n,13):(this.le(n,15),Ya(r)?n.fe(0):n.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(n,20),typeof r=="string"?n.de(r):(n.de(`${r.seconds||""}`),n.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,n),this.we(n);else if("bytesValue"in e)this.le(n,30),n.me(us(e.bytesValue)),this.we(n);else if("referenceValue"in e)this.ge(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(n,45),n.fe(r.latitude||0),n.fe(r.longitude||0)}else"mapValue"in e?AT(e)?this.le(n,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,n),this.we(n)):"arrayValue"in e?(this.pe(e.arrayValue,n),this.we(n)):ae()}_e(e,n){this.le(n,25),this.Ie(e,n)}Ie(e,n){n.de(e)}ye(e,n){const r=e.fields||{};this.le(n,55);for(const i of Object.keys(r))this._e(i,n),this.ae(r[i],n)}pe(e,n){const r=e.values||[];this.le(n,50);for(const i of r)this.ae(i,n)}ge(e,n){this.le(n,37),ee.fromName(e).path.forEach(r=>{this.le(n,60),this.Ie(r,n)})}le(e,n){e.fe(n)}we(e){e.fe(2)}}Li.Te=new Li;function Fz(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function Ww(t){const e=64-function(n){let r=0;for(let i=0;i<8;++i){const s=Fz(255&n[i]);if(r+=s,s!==8)break}return r}(t);return Math.ceil(e/8)}class Vz{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ae(r.value),r=n.next();this.Re()}be(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Pe(r.value),r=n.next();this.ve()}Ve(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=n.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}Se(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const i=n.codePointAt(0);this.Pe(240|i>>>18),this.Pe(128|63&i>>>12),this.Pe(128|63&i>>>6),this.Pe(128|63&i)}}this.ve()}De(e){const n=this.Ce(e),r=Ww(n);this.xe(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Ne(e){const n=this.Ce(e),r=Ww(n);this.xe(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}ke(){this.Oe(255),this.Oe(255)}Me(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const n=function(i){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ae(e){const n=255&e;n===0?(this.Oe(0),this.Oe(255)):n===255?(this.Oe(255),this.Oe(0)):this.Oe(n)}Pe(e){const n=255&e;n===0?(this.Fe(0),this.Fe(255)):n===255?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Oe(0),this.Oe(1)}ve(){this.Fe(0),this.Fe(1)}Oe(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class $z{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class Uz{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Me()}}class Ho{constructor(){this.Be=new Vz,this.Le=new $z(this.Be),this.Ue=new Uz(this.Be)}seed(e){this.Be.seed(e)}qe(e){return e===0?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Ke(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Bi(this.indexId,this.documentKey,this.arrayValue,r)}}function Ei(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Gw(t.arrayValue,e.arrayValue),n!==0?n:(n=Gw(t.directionalValue,e.directionalValue),n!==0?n:ee.comparator(t.documentKey,e.documentKey)))}function Gw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zz{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const n of e.filters){const r=n;r.dt()?this.je=r:this.Qe.push(r)}}We(e){const n=Hf(e);if(n!==void 0&&!this.ze(n))return!1;const r=Ii(e);let i=0,s=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(this.je!==void 0){const o=r[i];if(!this.He(this.je,o)||!this.Je(this.Ge[s++],o))return!1;++i}for(;i<r.length;++i){const o=r[i];if(s>=this.Ge.length||!this.Je(this.Ge[s++],o))return!1}return!0}ze(e){for(const n of this.Qe)if(this.He(n,e))return!0;return!1}He(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Je(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hz{constructor(){this.Ye=new qg}addToCollectionParentIndex(e,n){return this.Ye.add(n),k.resolve()}getCollectionParents(e,n){return k.resolve(this.Ye.getEntries(n))}addFieldIndex(e,n){return k.resolve()}deleteFieldIndex(e,n){return k.resolve()}getDocumentsMatchingTarget(e,n){return k.resolve(null)}getIndexType(e,n){return k.resolve(0)}getFieldIndexes(e,n){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,n){return k.resolve(bn.min())}getMinOffsetFromCollectionGroup(e,n){return k.resolve(bn.min())}updateCollectionGroup(e,n,r){return k.resolve()}updateIndexEntries(e,n){return k.resolve()}}class qg{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new $e(Ve.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $e(Ve.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=new Uint8Array(0);class jz{constructor(e,n){this.user=e,this.databaseId=n,this.Xe=new qg,this.Ze=new gi(r=>fs(r),(r,i)=>vl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Xe.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.Xe.add(n)});const s={collectionId:r,parent:qt(i)};return Jw(e).put(s)}return k.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[vT(n),""],!1,!0);return Jw(e).W(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(or(o.parent))}return r})}addFieldIndex(e,n){const r=ec(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Ko(e);return s.next(a=>{o.put(jw(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=ec(e),i=Ko(e),s=jo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=jo(e);let i=!0;const s=new Map;return k.forEach(this.tn(n),o=>this.en(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ie();const a=[];return k.forEach(s,(l,c)=>{var u;K("IndexedDbIndexManager",`Using index ${u=l,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`} to execute ${fs(n)}`);const h=function(M,y){const L=Hf(y);if(L===void 0)return null;for(const R of lu(M,L.fieldPath))switch(R.op){case"array-contains-any":return R.value.arrayValue.values||[];case"array-contains":return[R.value]}return null}(c,l),d=function(M,y){const L=new Map;for(const R of Ii(y))for(const j of lu(M,R.fieldPath))switch(j.op){case"==":case"in":L.set(R.fieldPath.canonicalString(),j.value);break;case"not-in":case"!=":return L.set(R.fieldPath.canonicalString(),j.value),Array.from(L.values())}return null}(c,l),f=function(M,y){const L=[];let R=!0;for(const j of Ii(y)){const N=j.kind===0?Iw(M,j.fieldPath,M.startAt):Aw(M,j.fieldPath,M.startAt);L.push(N.value),R&&(R=N.inclusive)}return new Eo(L,R)}(c,l),p=function(M,y){const L=[];let R=!0;for(const j of Ii(y)){const N=j.kind===0?Aw(M,j.fieldPath,M.endAt):Iw(M,j.fieldPath,M.endAt);L.push(N.value),R&&(R=N.inclusive)}return new Eo(L,R)}(c,l),g=this.nn(l,c,f),m=this.nn(l,c,p),w=this.sn(l,c,d),_=this.rn(l.indexId,h,g,f.inclusive,m,p.inclusive,w);return k.forEach(_,M=>r.J(M,n.limit).next(y=>{y.forEach(L=>{const R=ee.fromSegments(L.documentKey);o.has(R)||(o=o.add(R),a.push(R))})}))}).next(()=>a)}return k.resolve(null)})}tn(e){let n=this.Ze.get(e);return n||(n=[e],this.Ze.set(e,n),n)}rn(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),u=[];for(let h=0;h<l;++h){const d=n?this.on(n[h/c]):Zl,f=this.un(e,d,r[h%c],i),p=this.cn(e,d,s[h%c],o),g=a.map(m=>this.un(e,d,m,!0));u.push(...this.createRange(f,p,g))}return u}un(e,n,r,i){const s=new Bi(e,ee.empty(),n,r);return i?s:s.Ke()}cn(e,n,r,i){const s=new Bi(e,ee.empty(),n,r);return i?s.Ke():s}en(e,n){const r=new zz(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.We(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;return k.forEach(this.tn(n),i=>this.en(e,i).next(s=>{s?r!==0&&s.fields.length<function(o){let a=new $e(tt.comparator),l=!1;for(const c of o.filters){const u=c;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?l=!0:a=a.add(u.field))}for(const c of o.orderBy)c.field.isKeyField()||(a=a.add(c.field));return a.size+(l?1:0)}(i)&&(r=1):r=0})).next(()=>r)}an(e,n){const r=new Ho;for(const i of Ii(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.qe(i.kind);Li.Te.ce(s,o)}return r.$e()}on(e){const n=new Ho;return Li.Te.ce(e,n.qe(0)),n.$e()}hn(e,n){const r=new Ho;return Li.Te.ce($g(this.databaseId,n),r.qe(function(i){const s=Ii(i);return s.length===0?0:s[s.length-1].kind}(e))),r.$e()}sn(e,n,r){if(r===null)return[];let i=[];i.push(new Ho);let s=0;for(const o of Ii(e)){const a=r[s++];for(const l of i)if(this.ln(n,o.fieldPath)&&Za(a))i=this.fn(i,o,a);else{const c=l.qe(o.kind);Li.Te.ce(a,c)}}return this.dn(i)}nn(e,n,r){return this.sn(e,n,r.position)}dn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].$e();return n}fn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Ho;l.seed(a.$e()),Li.Te.ce(o,l.qe(n.kind)),s.push(l)}return s}ln(e,n){return!!e.filters.find(r=>r instanceof Rt&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ec(e),i=Ko(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{const o=[];return k.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(c,u){const h=u?new ou(u.sequenceNumber,new bn(gs(u.readTime),new ee(or(u.documentKey)),u.largestBatchId)):ou.empty(),d=c.fields.map(([f,p])=>new yU(tt.fromServerFormat(f),p));return new ET(c.indexId,c.collectionGroup,d,h)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Te(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ec(e),s=Ko(e);return this._n(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>k.forEach(a,l=>s.put(jw(l.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return k.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?k.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),k.forEach(a,l=>this.wn(e,i,l).next(c=>{const u=this.mn(s,l);return c.isEqual(u)?k.resolve():this.gn(e,s,l,c,u)}))))})}yn(e,n,r,i){return jo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.hn(r,n.key),documentKey:n.key.path.toArray()})}pn(e,n,r,i){return jo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.hn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=jo(e);let s=new $e(Ei);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.hn(r,n)])},(o,a)=>{s=s.add(new Bi(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}mn(e,n){let r=new $e(Ei);const i=this.an(n,e);if(i==null)return r;const s=Hf(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Za(o))for(const a of o.arrayValue.values||[])r=r.add(new Bi(n.indexId,e.key,this.on(a),i))}else r=r.add(new Bi(n.indexId,e.key,Zl,i));return r}gn(e,n,r,i,s){K("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,l,c,u,h){const d=a.getIterator(),f=l.getIterator();let p=Os(d),g=Os(f);for(;p||g;){let m=!1,w=!1;if(p&&g){const _=c(p,g);_<0?w=!0:_>0&&(m=!0)}else p!=null?w=!0:m=!0;m?(u(g),g=Os(f)):w?(h(p),p=Os(d)):(p=Os(d),g=Os(f))}}(i,s,Ei,a=>{o.push(this.yn(e,n,r,a))},a=>{o.push(this.pn(e,n,r,a))}),k.waitFor(o)}_n(e){let n=1;return Ko(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ei(o,a)).filter((o,a,l)=>!a||Ei(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ei(o,e),l=Ei(o,n);if(a===0)i[0]=e.Ke();else if(a>0&&l<0)i.push(o),i.push(o.Ke());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2)s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Zl,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Zl,[]]));return s}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Xw)}getMinOffset(e,n){return k.mapArray(this.tn(n),r=>this.en(e,r).next(i=>i||ae())).next(Xw)}}function Jw(t){return gt(t,"collectionParents")}function jo(t){return gt(t,"indexEntries")}function ec(t){return gt(t,"indexConfiguration")}function Ko(t){return gt(t,"indexState")}function Xw(t){be(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Fg(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new bn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class en{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new en(e,en.DEFAULT_COLLECTION_PERCENTILE,en.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.Z({range:o},(u,h,d)=>(a++,d.delete()));s.push(l.next(()=>{be(a===1)}));const c=[];for(const u of n.mutations){const h=i1(e,u.key.path,n.batchId);s.push(i.delete(h)),c.push(u.key)}return k.waitFor(s).next(()=>c)}function du(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ae();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */en.DEFAULT_COLLECTION_PERCENTILE=10,en.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,en.DEFAULT=new en(41943040,en.DEFAULT_COLLECTION_PERCENTILE,en.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),en.DISABLED=new en(-1,0,0);class bh{constructor(e,n,r,i){this.userId=e,this.It=n,this.indexManager=r,this.referenceDelegate=i,this.In={}}static oe(e,n,r,i){be(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new bh(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Or(e).Z({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Fs(e),o=Or(e);return o.add({}).next(a=>{be(typeof a=="number");const l=new Hg(a,n,r,i),c=function(d,f,p){const g=p.baseMutations.map(w=>uu(d.re,w)),m=p.mutations.map(w=>uu(d.re,w));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:g,mutations:m}}(this.It,this.userId,l),u=[];let h=new $e((d,f)=>Te(d.canonicalString(),f.canonicalString()));for(const d of i){const f=i1(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(c)),u.push(s.put(f,wz))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.In[a]=l.keys()}),k.waitFor(u).next(()=>l)})}lookupMutationBatch(e,n){return Or(e).get(n).next(r=>r?(be(r.userId===this.userId),Pi(this.It,r)):null)}Tn(e,n){return this.In[n]?k.resolve(this.In[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.In[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Or(e).Z({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(be(a.batchId>=r),s=Pi(this.It,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Or(e).Z({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Or(e).W("userMutationsIndex",n).next(r=>r.map(i=>Pi(this.It,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=vc(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Fs(e).Z({range:i},(o,a,l)=>{const[c,u,h]=o,d=or(u);if(c===this.userId&&n.path.isEqual(d))return Or(e).get(h).next(f=>{if(!f)throw ae();be(f.userId===this.userId),s.push(Pi(this.It,f))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(Te);const i=[];return n.forEach(s=>{const o=vc(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Fs(e).Z({range:a},(c,u,h)=>{const[d,f,p]=c,g=or(f);d===this.userId&&s.path.isEqual(g)?r=r.add(p):h.done()});i.push(l)}),k.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=vc(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new $e(Te);return Fs(e).Z({range:o},(l,c,u)=>{const[h,d,f]=l,p=or(d);h===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):u.done()}).next(()=>this.En(e,a))}En(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Or(e).get(s).next(o=>{if(o===null)throw ae();be(o.userId===this.userId),r.push(Pi(this.It,o))}))}),k.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return h1(e.ie,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.An(n.batchId)}),k.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return k.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return Fs(e).Z({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=or(s[1]);i.push(l)}else a.done()}).next(()=>{be(i.length===0)})})}containsKey(e,n){return d1(e,this.userId,n)}Rn(e){return f1(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function d1(t,e,n){const r=vc(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Fs(t).Z({range:s,X:!0},(a,l,c)=>{const[u,h,d]=a;u===e&&h===i&&(o=!0),c.done()}).next(()=>o)}function Or(t){return gt(t,"mutations")}function Fs(t){return gt(t,"documentMutations")}function f1(t){return gt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new ms(0)}static vn(){return new ms(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e,n){this.referenceDelegate=e,this.It=n}allocateTargetId(e){return this.Vn(e).next(n=>{const r=new ms(n.highestTargetId);return n.highestTargetId=r.next(),this.Sn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(n=>ge.fromTimestamp(new We(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Sn(e,i)))}addTargetData(e,n){return this.Dn(e,n).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(n,r),this.Sn(e,r))))}updateTargetData(e,n){return this.Dn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ds(e).delete(n.targetId)).next(()=>this.Vn(e)).next(r=>(be(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Ds(e).Z((o,a)=>{const l=na(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>k.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ds(e).Z((r,i)=>{const s=na(i);n(s)})}Vn(e){return Qw(e).get("targetGlobalKey").next(n=>(be(n!==null),n))}Sn(e,n){return Qw(e).put("targetGlobalKey",n)}Dn(e,n){return Ds(e).put(c1(this.It,n))}Cn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=fs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Ds(e).Z({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=na(a);vl(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Br(e);return n.forEach(o=>{const a=qt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),k.waitFor(i)}removeMatchingKeys(e,n,r){const i=Br(e);return k.forEach(n,s=>{const o=qt(s.path);return k.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Br(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Br(e);let s=Ie();return i.Z({range:r,X:!0},(o,a,l)=>{const c=or(o[1]),u=new ee(c);s=s.add(u)}).next(()=>s)}containsKey(e,n){const r=qt(n.path),i=IDBKeyRange.bound([r],[vT(r)],!1,!0);let s=0;return Br(e).Z({index:"documentTargetsIndex",X:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}se(e,n){return Ds(e).get(n).next(r=>r?na(r):null)}}function Ds(t){return gt(t,"targets")}function Qw(t){return gt(t,"targetGlobal")}function Br(t){return gt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw([t,e],[n,r]){const i=Te(t,n);return i===0?Te(e,r):i}class qz{constructor(e){this.xn=e,this.buffer=new $e(Zw),this.Nn=0}kn(){return++this.Nn}On(e){const n=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Zw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class Wz{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Mn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return this.Mn!==null}Fn(e){K("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Mn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){pi(n)?K("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await xs(n)}await this.Fn(3e5)})}}class Gz{constructor(e,n){this.$n=e,this.params=n}calculateTargetCount(e,n){return this.$n.Bn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return k.resolve(In.at);const r=new qz(n);return this.$n.forEachTarget(e,i=>r.On(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.On(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.$n.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.$n.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(K("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(Yw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(K("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yw):this.Un(e,n))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,n){let r,i,s,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(K("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),zf()<=Le.DEBUG&&K("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jz{constructor(e,n){this.db=e,this.garbageCollector=function(r,i){return new Gz(r,i)}(this,n)}Bn(e){const n=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}qn(e){let n=0;return this.Ln(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Ln(e,n){return this.Kn(e,(r,i)=>n(i))}addReference(e,n,r){return tc(e,r)}removeReference(e,n,r){return tc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return tc(e,n)}Gn(e,n){return function(r,i){let s=!1;return f1(r).tt(o=>d1(r,o,i).next(a=>(a&&(s=!0),k.resolve(!a)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Kn(e,(o,a)=>{if(a<=n){const l=this.Gn(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ge.min()),Br(e).delete([0,qt(o.path)])))});i.push(l)}}).next(()=>k.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return tc(e,n)}Kn(e,n){const r=Br(e);let i,s=In.at;return r.Z({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==In.at&&n(new ee(or(i)),s),s=c,i=l):s=In.at}).next(()=>{s!==In.at&&n(new ee(or(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function tc(t,e){return Br(t).put(function(n,r){return{targetId:0,path:qt(n.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{constructor(){this.changes=new gi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,qe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?k.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xi(e).put(r)}removeEntry(e,n,r){return xi(e).delete(function(i,s){const o=i.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],hu(s),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Qn(e,r)))}getEntry(e,n){let r=qe.newInvalidDocument(n);return xi(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(qo(n))},(i,s)=>{r=this.jn(n,s)}).next(()=>r)}Wn(e,n){let r={size:0,document:qe.newInvalidDocument(n)};return xi(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(qo(n))},(i,s)=>{r={document:this.jn(n,s),size:du(s)}}).next(()=>r)}getEntries(e,n){let r=hn();return this.zn(e,n,(i,s)=>{const o=this.jn(i,s);r=r.insert(i,o)}).next(()=>r)}Hn(e,n){let r=hn(),i=new it(ee.comparator);return this.zn(e,n,(s,o)=>{const a=this.jn(s,o);r=r.insert(s,a),i=i.insert(s,du(o))}).next(()=>({documents:r,Jn:i}))}zn(e,n,r){if(n.isEmpty())return k.resolve();let i=new $e(nv);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(qo(i.first()),qo(i.last())),o=i.getIterator();let a=o.getNext();return xi(e).Z({index:"documentKeyIndex",range:s},(l,c,u)=>{const h=ee.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&nv(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?u.j(qo(a)):u.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,r){const i=[n.popLast().toArray(),n.lastSegment(),hu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],s=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xi(e).W(IDBKeyRange.bound(i,s,!0)).next(o=>{let a=hn();for(const l of o){const c=this.jn(ee.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);a=a.insert(c.key,c)}return a})}getAllFromCollectionGroup(e,n,r,i){let s=hn();const o=tv(n,r),a=tv(n,bn.max());return xi(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,u)=>{const h=this.jn(ee.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&u.done()}).next(()=>s)}newChangeBuffer(e){return new Yz(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return ev(e).get("remoteDocumentGlobalKey").next(n=>(be(!!n),n))}Qn(e,n){return ev(e).put("remoteDocumentGlobalKey",n)}jn(e,n){if(n){const r=Lz(this.It,n);if(!(r.isNoDocument()&&r.version.isEqual(ge.min())))return r}return qe.newInvalidDocument(e)}}function g1(t){return new Xz(t)}class Yz extends p1{constructor(e,n){super(),this.Yn=e,this.trackRemovals=n,this.Xn=new gi(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new $e((s,o)=>Te(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.Xn.get(s);if(n.push(this.Yn.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=zw(this.Yn.It,o);i=i.add(s.path.popLast()),r+=du(l)-a.size,n.push(this.Yn.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=zw(this.Yn.It,o.convertToNoDocument(ge.min()));n.push(this.Yn.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.Yn.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.Yn.updateMetadata(e,r)),k.waitFor(n)}getFromCache(e,n){return this.Yn.Wn(e,n).next(r=>(this.Xn.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Yn.Hn(e,n).next(({documents:r,Jn:i})=>(i.forEach((s,o)=>{this.Xn.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function ev(t){return gt(t,"remoteDocumentGlobal")}function xi(t){return gt(t,"remoteDocumentsV14")}function qo(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function tv(t,e){const n=e.documentKey.path.toArray();return[t,hu(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function nv(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Te(n[s],r[s]),i)return i;return i=Te(n.length,r.length),i||(i=Te(n[n.length-2],r[r.length-2]),i||Te(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.getBaseDocument(e,n,r))).next(i=>(r!==null&&ba(r.mutation,i,fn.empty(),We.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ie()){const i=sr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ta();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=sr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ie()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=hn();const o=wa(),a=wa();return n.forEach((l,c)=>{const u=r.get(c.key);i.has(c.key)&&(u===void 0||u.mutation instanceof Ir)?s=s.insert(c.key,c):u!==void 0&&(o.set(c.key,u.mutation.getFieldMask()),ba(u.mutation,c,u.mutation.getFieldMask(),We.now()))}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,u)=>o.set(c,u)),n.forEach((c,u)=>{var h;return a.set(c,new Qz(u,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=wa();let i=new it((o,a)=>o-a),s=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let u=r.get(l)||fn.empty();u=a.applyToLocalView(c,u),r.set(l,u);const h=(i.get(a.batchId)||Ie()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,h=KT();u.forEach(d=>{if(!s.has(d)){const f=VT(n.get(d),r.get(d));f!==null&&h.set(d,f),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return k.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(i){return ee.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):UU(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):k.resolve(sr());let a=-1,l=s;return o.next(c=>k.forEach(c,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(u)?k.resolve():this.getBaseDocument(e,u,h).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Ie())).next(u=>({batchId:a,changes:jT(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let i=ta();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const i=n.collectionGroup;let s=ta();return this.indexManager.getCollectionParents(e,i).next(o=>k.forEach(o,a=>{const l=function(c,u){return new uh(u,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt)}(n,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,l,r).next(c=>{c.forEach((u,h)=>{s=s.insert(u,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,n.path,r).next(s=>(i=s,this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId))).next(s=>{s.forEach((a,l)=>{const c=l.getKey();i.get(c)===null&&(i=i.insert(c,qe.newInvalidDocument(c)))});let o=ta();return i.forEach((a,l)=>{const c=s.get(a);c!==void 0&&ba(c.mutation,l,fn.empty(),We.now()),Ug(n,l)&&(o=o.insert(a,l))}),o})}getBaseDocument(e,n,r){return r===null||r.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):k.resolve(qe.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,n){return k.resolve(this.Zn.get(n))}saveBundleMetadata(e,n){var r;return this.Zn.set(n.id,{id:(r=n).id,version:r.version,createTime:pn(r.createTime)}),k.resolve()}getNamedQuery(e,n){return k.resolve(this.ts.get(n))}saveNamedQuery(e,n){return this.ts.set(n.name,function(r){return{name:r.name,query:u1(r.bundledQuery),readTime:pn(r.readTime)}}(n)),k.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eH{constructor(){this.overlays=new it(ee.comparator),this.es=new Map}getOverlay(e,n){return k.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sr();return k.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ue(e,n,s)}),k.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.es.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.es.delete(r)),k.resolve()}getOverlaysForCollection(e,n,r){const i=sr(),s=n.length+1,o=new ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return k.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new it((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let u=s.get(c.largestBatchId);u===null&&(u=sr(),s=s.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=sr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=i)););return k.resolve(a)}ue(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Kg(n,r));let s=this.es.get(n);s===void 0&&(s=Ie(),this.es.set(n,s)),this.es.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(){this.ns=new $e(lt.ss),this.rs=new $e(lt.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,n){const r=new lt(e,n);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.cs(new lt(e,n))}hs(e,n){e.forEach(r=>this.removeReference(r,n))}ls(e){const n=new ee(new Ve([])),r=new lt(n,e),i=new lt(n,e+1),s=[];return this.rs.forEachInRange([r,i],o=>{this.cs(o),s.push(o.key)}),s}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const n=new ee(new Ve([])),r=new lt(n,e),i=new lt(n,e+1);let s=Ie();return this.rs.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new lt(e,0),r=this.ns.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class lt{constructor(e,n){this.key=e,this._s=n}static ss(e,n){return ee.comparator(e.key,n.key)||Te(e._s,n._s)}static os(e,n){return Te(e._s,n._s)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tH{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.ws=1,this.gs=new $e(lt.ss)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Hg(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.gs=this.gs.add(new lt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,n){return k.resolve(this.ys(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.ps(r),s=i<0?0:i;return k.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?-1:this.ws-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new lt(n,0),i=new lt(n,Number.POSITIVE_INFINITY),s=[];return this.gs.forEachInRange([r,i],o=>{const a=this.ys(o._s);s.push(a)}),k.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(Te);return n.forEach(i=>{const s=new lt(i,0),o=new lt(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([s,o],a=>{r=r.add(a._s)})}),k.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ee.isDocumentKey(s)||(s=s.child(""));const o=new lt(new ee(s),0);let a=new $e(Te);return this.gs.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l._s)),!0)},o),k.resolve(this.Is(a))}Is(e){const n=[];return e.forEach(r=>{const i=this.ys(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){be(this.Ts(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.gs;return k.forEach(n.mutations,i=>{const s=new lt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,n){const r=new lt(n,0),i=this.gs.firstAfterOrEqual(r);return k.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}Ts(e,n){return this.ps(e)}ps(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ys(e){const n=this.ps(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nH{constructor(e){this.Es=e,this.docs=new it(ee.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Es(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return k.resolve(r?r.document.mutableCopy():qe.newInvalidDocument(n))}getEntries(e,n){let r=hn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():qe.newInvalidDocument(i))}),k.resolve(r)}getAllFromCollection(e,n,r){let i=hn();const s=new ee(n.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:a,value:{document:l}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Fg(xT(l),r)<=0||(i=i.insert(l.key,l.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,n,r,i){ae()}As(e,n){return k.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rH(this)}getSize(e){return k.resolve(this.size)}}class rH extends p1{constructor(e){super(),this.Yn=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),k.waitFor(n)}getFromCache(e,n){return this.Yn.getEntry(e,n)}getAllFromCache(e,n){return this.Yn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{constructor(e){this.persistence=e,this.Rs=new gi(n=>fs(n),vl),this.lastRemoteSnapshotVersion=ge.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Wg,this.targetCount=0,this.vs=ms.Pn()}forEachTarget(e,n){return this.Rs.forEach((r,i)=>n(i)),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.bs&&(this.bs=n),k.resolve()}Dn(e){this.Rs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.vs=new ms(n),this.highestTargetId=n),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,n){return this.Dn(n),this.targetCount+=1,k.resolve()}updateTargetData(e,n){return this.Dn(n),k.resolve()}removeTargetData(e,n){return this.Rs.delete(n.target),this.Ps.ls(n.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Rs.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Rs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),k.waitFor(s).next(()=>i)}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,n){const r=this.Rs.get(n)||null;return k.resolve(r)}addMatchingKeys(e,n,r){return this.Ps.us(n,r),k.resolve()}removeMatchingKeys(e,n,r){this.Ps.hs(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),k.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Ps.ls(n),k.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Ps.ds(n);return k.resolve(r)}containsKey(e,n){return k.resolve(this.Ps.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,n){this.Vs={},this.overlays={},this.Ss=new In(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new iH(this),this.indexManager=new Hz,this.remoteDocumentCache=function(r){return new nH(r)}(r=>this.referenceDelegate.xs(r)),this.It=new l1(n),this.Ns=new Zz(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new eH,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Vs[e.toKey()];return r||(r=new tH(n,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,n,r){K("MemoryPersistence","Starting transaction:",e);const i=new sH(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(s=>this.referenceDelegate.Os(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ms(e,n){return k.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,n)))}}class sH extends TT{constructor(e){super(),this.currentSequenceNumber=e}}class wh{constructor(e){this.persistence=e,this.Fs=new Wg,this.$s=null}static Bs(e){return new wh(e)}get Ls(){if(this.$s)return this.$s;throw ae()}addReference(e,n,r){return this.Fs.addReference(r,n),this.Ls.delete(r.toString()),k.resolve()}removeReference(e,n,r){return this.Fs.removeReference(r,n),this.Ls.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,n){return this.Ls.add(n.toString()),k.resolve()}removeTarget(e,n){this.Fs.ls(n.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Ls.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}ks(){this.$s=new Set}Os(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.Ls,r=>{const i=ee.fromPath(r);return this.Us(e,i).next(s=>{s||n.removeEntry(i,ge.min())})}).next(()=>(this.$s=null,n.apply(e)))}updateLimboDocument(e,n){return this.Us(e,n).next(r=>{r?this.Ls.delete(n.toString()):this.Ls.add(n.toString())})}xs(e){return 0}Us(e,n){return k.or([()=>k.resolve(this.Fs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ms(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oH{constructor(e){this.It=e}$(e,n,r,i){const s=new lh("createOrUpgrade",n);r<1&&i>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Uw,{unique:!0}),a.createObjectStore("documentMutations")}(e),rv(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=k.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),rv(e)),o=o.next(()=>function(a){const l=a.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ge.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",c)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(a,l){return l.store("mutations").W().next(c=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Uw,{unique:!0});const u=l.store("mutations"),h=c.map(d=>u.put(d));return k.waitFor(h)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.qs(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(s)))),r<7&&i>=7&&(o=o.next(()=>this.Gs(s))),r<8&&i>=8&&(o=o.next(()=>this.Qs(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.js(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(a){const l=a.createObjectStore("documentOverlays",{keyPath:Oz});l.createIndex("collectionPathOverlayIndex",Nz,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",Dz,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(a){const l=a.createObjectStore("remoteDocumentsV14",{keyPath:vz});l.createIndex("documentKeyIndex",Ez),l.createIndex("collectionGroupIndex",xz)}(e)).next(()=>this.Ws(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.zs(e,s))),r<15&&i>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:Iz}).createIndex("sequenceNumberIndex",Az,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:_z}).createIndex("documentKeyIndex",Mz,{unique:!1})}(e))),o}Ks(e){let n=0;return e.store("remoteDocuments").Z((r,i)=>{n+=du(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>k.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>k.forEach(a,l=>{be(l.userId===s.userId);const c=Pi(this.It,l);return h1(e,s.userId,c).next(()=>{})}))}))}Gs(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.Z((o,a)=>{const l=new Ve(o),c=function(u){return[0,qt(u)]}(l);s.push(n.get(c).next(u=>u?k.resolve():(h=>n.put({targetId:0,path:qt(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>k.waitFor(s))})}Qs(e,n){e.createObjectStore("collectionParents",{keyPath:kz});const r=n.store("collectionParents"),i=new qg,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:qt(l)})}};return n.store("remoteDocuments").Z({X:!0},(o,a)=>{const l=new Ve(o);return s(l.popLast())}).next(()=>n.store("documentMutations").Z({X:!0},([o,a,l],c)=>{const u=or(a);return s(u.popLast())}))}js(e){const n=e.store("targets");return n.Z((r,i)=>{const s=na(i),o=c1(this.It,s);return n.put(o)})}Ws(e,n){const r=n.store("remoteDocuments"),i=[];return r.Z((s,o)=>{const a=n.store("remoteDocumentsV14"),l=(c=o,c.document?new ee(Ve.fromString(c.document.name).popFirst(5)):c.noDocument?ee.fromSegments(c.noDocument.path):c.unknownDocument?ee.fromSegments(c.unknownDocument.path):ae()).path.toArray();var c;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>k.waitFor(i))}zs(e,n){const r=n.store("mutations"),i=g1(this.It),s=new y1(wh.Bs,this.It.re);return r.W().next(o=>{const a=new Map;return o.forEach(l=>{var c;let u=(c=a.get(l.userId))!==null&&c!==void 0?c:Ie();Pi(this.It,l).keys().forEach(h=>u=u.add(h)),a.set(l.userId,u)}),k.forEach(a,(l,c)=>{const u=new wt(c),h=yh.oe(this.It,u),d=s.getIndexManager(u),f=bh.oe(u,this.It,d,s.referenceDelegate);return new m1(i,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Yf(n,In.at),l).next()})})}}function rv(t){t.createObjectStore("targetDocuments",{keyPath:Tz}).createIndex("documentTargetsIndex",Cz,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",Sz,{unique:!0}),t.createObjectStore("targetGlobal")}const kd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Gg{constructor(e,n,r,i,s,o,a,l,c,u,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Hs=s,this.window=o,this.document=a,this.Js=c,this.Ys=u,this.Xs=h,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=d=>Promise.resolve(),!Gg.C())throw new se(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Jz(this,i),this.ii=n+"main",this.It=new l1(l),this.ri=new vr(this.ii,this.Xs,new oH(this.It)),this.Cs=new Kz(this.referenceDelegate,this.It),this.remoteDocumentCache=g1(this.It),this.Ns=new Bz,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,u===!1&&zt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new se(U.FAILED_PRECONDITION,kd);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new In(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){return this.si=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget(async()=>{this.started&&await this.ui()}))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>nc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(n=>{n||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(n=>this.isPrimary&&!n?this._i(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(pi(e))return K("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return K("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return Wo(e).get("owner").next(n=>k.resolve(this.mi(n)))}gi(e){return nc(e).delete(this.clientId)}async yi(){if(this.isPrimary&&!this.pi(this.ni,18e5)){this.ni=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=gt(n,"clientMetadata");return r.W().next(i=>{const s=this.Ii(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return k.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.oi)for(const n of e)this.oi.removeItem(this.Ti(n.clientId))}}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?k.resolve(!0):Wo(e).get("owner").next(n=>{if(n!==null&&this.pi(n.leaseTimestampMs,5e3)&&!this.Ei(n.ownerId)){if(this.mi(n)&&this.networkEnabled)return!0;if(!this.mi(n)){if(!n.allowTabSynchronization)throw new se(U.FAILED_PRECONDITION,kd);return!1}}return!(!this.networkEnabled||!this.inForeground)||nc(e).W().next(r=>this.Ii(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&K("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Ds=!1,this.Ai(),this.ei&&(this.ei.cancel(),this.ei=null),this.Ri(),this.bi(),await this.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Yf(e,In.at);return this._i(n).next(()=>this.gi(n))}),this.ri.close(),this.Pi()}Ii(e,n){return e.filter(r=>this.pi(r.updateTimeMs,n)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>nc(e).W().next(n=>this.Ii(n,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,n){return bh.oe(e,this.It,n,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jz(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return yh.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,n,r){K("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=(o=this.Xs)===15?Pz:o===14?a1:o===13?o1:o===12?Rz:o===11?s1:void ae();var o;let a;return this.ri.runTransaction(e,i,s,l=>(a=new Yf(l,this.Ss?this.Ss.next():In.at),n==="readwrite-primary"?this.fi(a).next(c=>!!c||this.di(a)).next(c=>{if(!c)throw zt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new se(U.FAILED_PRECONDITION,ST);return r(a)}).next(c=>this.wi(a).next(()=>c)):this.Vi(a).next(()=>r(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Vi(e){return Wo(e).get("owner").next(n=>{if(n!==null&&this.pi(n.leaseTimestampMs,5e3)&&!this.Ei(n.ownerId)&&!this.mi(n)&&!(this.Ys||this.allowTabSynchronization&&n.allowTabSynchronization))throw new se(U.FAILED_PRECONDITION,kd)})}wi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wo(e).put("owner",n)}static C(){return vr.C()}_i(e){const n=Wo(e);return n.get("owner").next(r=>this.mi(r)?(K("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):k.resolve())}pi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(zt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}ci(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground=this.document.visibilityState==="visible")}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Zs=()=>{this.Ai(),zF()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var n;try{const r=((n=this.oi)===null||n===void 0?void 0:n.getItem(this.Ti(e)))!==null;return K("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return zt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){zt("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wo(t){return gt(t,"owner")}function nc(t){return gt(t,"clientMetadata")}function aH(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.Si=r,this.Di=i}static Ci(e,n){let r=Ie(),i=Ie();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Jg(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.xi=!1}initialize(e,n){this.Ni=e,this.indexManager=n,this.xi=!0}getDocumentsMatchingQuery(e,n,r,i){return this.ki(e,n).next(s=>s||this.Oi(e,n,i,r)).next(s=>s||this.Mi(e,n))}ki(e,n){if(Ow(n))return k.resolve(null);let r=qn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=qf(n,null,"F"),r=qn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ie(...s);return this.Ni.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Fi(n,a);return this.$i(n,c,o,l.readTime)?this.ki(e,qf(n,null,"F")):this.Bi(e,c,n,l)}))})))}Oi(e,n,r,i){return Ow(n)||i.isEqual(ge.min())?this.Mi(e,n):this.Ni.getDocuments(e,r).next(s=>{const o=this.Fi(n,s);return this.$i(n,o,r,i)?this.Mi(e,n):(zf()<=Le.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wf(n)),this.Bi(e,o,n,bU(i,-1)))})}Fi(e,n){let r=new $e(NT(e));return n.forEach((i,s)=>{Ug(e,s)&&(r=r.add(s))}),r}$i(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Mi(e,n){return zf()<=Le.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Wf(n)),this.Ni.getDocumentsMatchingQuery(e,n,bn.min())}Bi(e,n,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(e,n,r,i){this.persistence=e,this.Li=n,this.It=i,this.Ui=new it(Te),this.qi=new gi(s=>fs(s),vl),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new m1(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ui))}}function w1(t,e,n,r){return new lH(t,e,n,r)}async function v1(t,e){const n=we(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.Qi(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ie();for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return n.localDocuments.getDocuments(r,l).next(c=>({ji:c,removedBatchIds:o,addedBatchIds:a}))})})}function cH(t,e){const n=we(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.Gi.newChangeBuffer({trackRemovals:!0});return function(o,a,l,c){const u=l.batch,h=u.keys();let d=k.resolve();return h.forEach(f=>{d=d.next(()=>c.getEntry(a,f)).next(p=>{const g=l.docVersions.get(f);be(g!==null),p.version.compareTo(g)<0&&(u.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),c.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=Ie();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(a=a.add(o.batch.mutations[l].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function E1(t){const e=we(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Cs.getLastRemoteSnapshotVersion(n))}function uH(t,e){const n=we(t),r=e.snapshotVersion;let i=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.Ui;const a=[];e.targetChanges.forEach((u,h)=>{const d=i.get(h);if(!d)return;a.push(n.Cs.removeMatchingKeys(s,u.removedDocuments,h).next(()=>n.Cs.addMatchingKeys(s,u.addedDocuments,h)));let f=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(pt.EMPTY_BYTE_STRING,ge.min()).withLastLimboFreeSnapshotVersion(ge.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,r)),i=i.insert(h,f),function(p,g,m){return p.resumeToken.approximateByteSize()===0||g.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:m.addedDocuments.size+m.modifiedDocuments.size+m.removedDocuments.size>0}(d,f,u)&&a.push(n.Cs.updateTargetData(s,f))});let l=hn(),c=Ie();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,u))}),a.push(hH(s,o,e.documentUpdates).next(u=>{l=u.Wi,c=u.zi})),!r.isEqual(ge.min())){const u=n.Cs.getLastRemoteSnapshotVersion(s).next(h=>n.Cs.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(u)}return k.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.Ui=i,s))}function hH(t,e,n){let r=Ie(),i=Ie();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=hn();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(ge.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):K("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Wi:o,zi:i}})}function dH(t,e){const n=we(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function fH(t,e){const n=we(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Cs.getTargetData(r,e).next(s=>s?(i=s,k.resolve(i)):n.Cs.allocateTargetId(r).next(o=>(i=new Zr(e,o,0,r.currentSequenceNumber),n.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.Ui.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(r.targetId,r),n.qi.set(e,r.targetId)),r})}async function Qf(t,e,n){const r=we(t),i=r.Ui.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!pi(o))throw o;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ui=r.Ui.remove(e),r.qi.delete(i.target)}function iv(t,e,n){const r=we(t);let i=ge.min(),s=Ie();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,l,c){const u=we(a),h=u.qi.get(c);return h!==void 0?k.resolve(u.Ui.get(h)):u.Cs.getTargetData(l,c)}(r,o,qn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.Li.getDocumentsMatchingQuery(o,e,n?i:ge.min(),n?s:Ie())).next(a=>(pH(r,zU(e),a),{documents:a,Hi:s})))}function pH(t,e,n){let r=t.Ki.get(e)||ge.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.Ki.set(e,r)}class sv{constructor(){this.activeTargetIds=qT()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class x1{constructor(){this.Lr=new sv,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,n,r){this.Ur[e]=n}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new sv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gH{qr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yH{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bH extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.oo=n+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,n,r,i,s){const o=this.ho(e,n);K("RestConnection","Sending: ",o,r);const a={};return this.lo(a,i,s),this.fo(e,o,a,r).then(l=>(K("RestConnection","Received: ",l),l),l=>{throw su("RestConnection",`${e} failed with error: `,l,"url: ",o,"request:",r),l})}_o(e,n,r,i,s,o){return this.ao(e,n,r,i,s)}lo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Po,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}ho(e,n){const r=mH[e];return`${this.oo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,n,r,i){return new Promise((s,o)=>{const a=new aU;a.listenOnce(iU.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Td.NO_ERROR:const c=a.getResponseJson();K("Connection","XHR received:",JSON.stringify(c)),s(c);break;case Td.TIMEOUT:K("Connection",'RPC "'+e+'" timed out'),o(new se(U.DEADLINE_EXCEEDED,"Request time out"));break;case Td.HTTP_ERROR:const u=a.getStatus();if(K("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(p)>=0?p:U.UNKNOWN}(h.status);o(new se(d,h.message))}else o(new se(U.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new se(U.UNAVAILABLE,"Connection failed."));break;default:ae()}}finally{K("Connection",'RPC "'+e+'" completed.')}});const l=JSON.stringify(i);a.send(n,"POST",l,r,15)})}wo(e,n,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=nU(),o=rU(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new oU({})),this.lo(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const l=i.join("");K("Connection","Creating WebChannel: "+l,a);const c=s.createWebChannel(l,a);let u=!1,h=!1;const d=new yH({Hr:p=>{h?K("Connection","Not sending because WebChannel is closed:",p):(u||(K("Connection","Opening WebChannel transport."),c.open(),u=!0),K("Connection","WebChannel sending:",p),c.send(p))},Jr:()=>c.close()}),f=(p,g,m)=>{p.listen(g,w=>{try{m(w)}catch(_){setTimeout(()=>{throw _},0)}})};return f(c,Yl.EventType.OPEN,()=>{h||K("Connection","WebChannel transport opened.")}),f(c,Yl.EventType.CLOSE,()=>{h||(h=!0,K("Connection","WebChannel transport closed"),d.io())}),f(c,Yl.EventType.ERROR,p=>{h||(h=!0,su("Connection","WebChannel transport errored:",p),d.io(new se(U.UNAVAILABLE,"The operation could not be completed")))}),f(c,Yl.EventType.MESSAGE,p=>{var g;if(!h){const m=p.data[0];be(!!m);const w=m,_=w.error||((g=w[0])===null||g===void 0?void 0:g.error);if(_){K("Connection","WebChannel received error:",_);const M=_.status;let y=function(R){const j=Ze[R];if(j!==void 0)return zT(j)}(M),L=_.message;y===void 0&&(y=U.INTERNAL,L="Unknown error status: "+M+" with message "+_.message),h=!0,d.io(new se(y,L)),c.close()}else K("Connection","WebChannel received:",m),d.ro(m)}}),f(o,sU.STAT_EVENT,p=>{p.stat===mw.PROXY?K("Connection","Detected buffering proxy"):p.stat===mw.NOPROXY&&K("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.so()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wH(){return typeof window<"u"?window:null}function Ec(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(t){return new az(t,!0)}class S1{constructor(e,n,r=1e3,i=1.5,s=6e4){this.Hs=e,this.timerId=n,this.mo=r,this.yo=i,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,n-r);i>0&&K("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){this.To!==null&&(this.To.skipDelay(),this.To=null)}cancel(){this.To!==null&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(e,n,r,i,s,o,a,l){this.Hs=e,this.vo=r,this.Vo=i,this.So=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new S1(e,n)}ko(){return this.state===1||this.state===5||this.Oo()}Oo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Mo()}async stop(){this.ko()&&await this.close(0)}Fo(){this.state=0,this.No.reset()}$o(){this.Oo()&&this.Co===null&&(this.Co=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.Bo()))}Lo(e){this.Uo(),this.stream.send(e)}async Bo(){if(this.Oo())return this.close(0)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}qo(){this.xo&&(this.xo.cancel(),this.xo=null)}async close(e,n){this.Uo(),this.qo(),this.No.cancel(),this.Do++,e!==4?this.No.reset():n&&n.code===U.RESOURCE_EXHAUSTED?(zt(n.toString()),zt("Using maximum backoff delay to prevent overloading the backend."),this.No.Ao()):n&&n.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Ko(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(n)}Ko(){}auth(){this.state=1;const e=this.Go(this.Do),n=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Do===n&&this.Qo(r,i)},r=>{e(()=>{const i=new se(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.jo(i)})})}Qo(e,n){const r=this.Go(this.Do);this.stream=this.Wo(e,n),this.stream.Yr(()=>{r(()=>(this.state=2,this.xo=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.Oo()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.jo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Mo(){this.state=5,this.No.Ro(async()=>{this.state=0,this.start()})}jo(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Go(e){return n=>{this.Hs.enqueueAndForget(()=>this.Do===e?n():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class vH extends T1{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.It=s}Wo(e,n){return this.So.wo("Listen",e,n)}onMessage(e){this.No.reset();const n=uz(this.It,e),r=function(i){if(!("targetChange"in i))return ge.min();const s=i.targetChange;return s.targetIds&&s.targetIds.length?ge.min():s.readTime?pn(s.readTime):ge.min()}(e);return this.listener.zo(n,r)}Ho(e){const n={};n.database=Jf(this.It),n.addTarget=function(i,s){let o;const a=s.target;return o=au(a)?{documents:ZT(i,a)}:{query:e1(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?o.resumeToken=JT(i,s.resumeToken):s.snapshotVersion.compareTo(ge.min())>0&&(o.readTime=rl(i,s.snapshotVersion.toTimestamp())),o}(this.It,e);const r=dz(this.It,e);r&&(n.labels=r),this.Lo(n)}Jo(e){const n={};n.database=Jf(this.It),n.removeTarget=e,this.Lo(n)}}class EH extends T1{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.It=s,this.Yo=!1}get Xo(){return this.Yo}start(){this.Yo=!1,this.lastStreamToken=void 0,super.start()}Ko(){this.Yo&&this.Zo([])}Wo(e,n){return this.So.wo("Write",e,n)}onMessage(e){if(be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Yo){this.No.reset();const n=hz(e.writeResults,e.commitTime),r=pn(e.commitTime);return this.listener.tu(r,n)}return be(!e.writeResults||e.writeResults.length===0),this.Yo=!0,this.listener.eu()}nu(){const e={};e.database=Jf(this.It),this.Lo(e)}Zo(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>uu(this.It,r))};this.Lo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xH extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.So=r,this.It=i,this.su=!1}iu(){if(this.su)throw new se(U.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,n,r){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.So.ao(e,n,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new se(U.UNKNOWN,i.toString())})}_o(e,n,r,i){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.So._o(e,n,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new se(U.UNKNOWN,s.toString())})}terminate(){this.su=!0}}class SH{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}cu(){this.ru===0&&(this.au("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ou=null,this.hu("Backend didn't respond within 10 seconds."),this.au("Offline"),Promise.resolve())))}lu(e){this.state==="Online"?this.au("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.au("Offline")))}set(e){this.fu(),this.ru=0,e==="Online"&&(this.uu=!1),this.au(e)}au(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}hu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.uu?(zt(n),this.uu=!1):K("OnlineStateTracker",n)}fu(){this.ou!==null&&(this.ou.cancel(),this.ou=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TH{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=s,this.gu.qr(o=>{r.enqueueAndForget(async()=>{Ts(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(a){const l=we(a);l.wu.add(4),await xl(l),l.yu.set("Unknown"),l.wu.delete(4),await Eh(l)}(this))})}),this.yu=new SH(r,i)}}async function Eh(t){if(Ts(t))for(const e of t.mu)await e(!0)}async function xl(t){for(const e of t.mu)await e(!1)}function C1(t,e){const n=we(t);n._u.has(e.targetId)||(n._u.set(e.targetId,e),Qg(n)?Yg(n):Bo(n).Oo()&&Xg(n,e))}function k1(t,e){const n=we(t),r=Bo(n);n._u.delete(e),r.Oo()&&I1(n,e),n._u.size===0&&(r.Oo()?r.$o():Ts(n)&&n.yu.set("Unknown"))}function Xg(t,e){t.pu.Mt(e.targetId),Bo(t).Ho(e)}function I1(t,e){t.pu.Mt(e),Bo(t).Jo(e)}function Yg(t){t.pu=new iz({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),se:e=>t._u.get(e)||null}),Bo(t).start(),t.yu.cu()}function Qg(t){return Ts(t)&&!Bo(t).ko()&&t._u.size>0}function Ts(t){return we(t).wu.size===0}function A1(t){t.pu=void 0}async function CH(t){t._u.forEach((e,n)=>{Xg(t,e)})}async function kH(t,e){A1(t),Qg(t)?(t.yu.lu(e),Yg(t)):t.yu.set("Unknown")}async function IH(t,e,n){if(t.yu.set("Online"),e instanceof GT&&e.state===2&&e.cause)try{await async function(r,i){const s=i.cause;for(const o of i.targetIds)r._u.has(o)&&(await r.remoteSyncer.rejectListen(o,s),r._u.delete(o),r.pu.removeTarget(o))}(t,e)}catch(r){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await fu(t,r)}else if(e instanceof wc?t.pu.Gt(e):e instanceof WT?t.pu.Yt(e):t.pu.Wt(e),!n.isEqual(ge.min()))try{const r=await E1(t.localStore);n.compareTo(r)>=0&&await function(i,s){const o=i.pu.te(s);return o.targetChanges.forEach((a,l)=>{if(a.resumeToken.approximateByteSize()>0){const c=i._u.get(l);c&&i._u.set(l,c.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach(a=>{const l=i._u.get(a);if(!l)return;i._u.set(a,l.withResumeToken(pt.EMPTY_BYTE_STRING,l.snapshotVersion)),I1(i,a);const c=new Zr(l.target,a,1,l.sequenceNumber);Xg(i,c)}),i.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){K("RemoteStore","Failed to raise snapshot:",r),await fu(t,r)}}async function fu(t,e,n){if(!pi(e))throw e;t.wu.add(1),await xl(t),t.yu.set("Offline"),n||(n=()=>E1(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await n(),t.wu.delete(1),await Eh(t)})}function _1(t,e){return e().catch(n=>fu(t,n,e))}async function Sl(t){const e=we(t),n=li(e);let r=e.du.length>0?e.du[e.du.length-1].batchId:-1;for(;AH(e);)try{const i=await dH(e.localStore,r);if(i===null){e.du.length===0&&n.$o();break}r=i.batchId,_H(e,i)}catch(i){await fu(e,i)}M1(e)&&O1(e)}function AH(t){return Ts(t)&&t.du.length<10}function _H(t,e){t.du.push(e);const n=li(t);n.Oo()&&n.Xo&&n.Zo(e.mutations)}function M1(t){return Ts(t)&&!li(t).ko()&&t.du.length>0}function O1(t){li(t).start()}async function MH(t){li(t).nu()}async function OH(t){const e=li(t);for(const n of t.du)e.Zo(n.mutations)}async function NH(t,e,n){const r=t.du.shift(),i=jg.from(r,e,n);await _1(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Sl(t)}async function DH(t,e){e&&li(t).Xo&&await async function(n,r){if(i=r.code,ZU(i)&&i!==U.ABORTED){const s=n.du.shift();li(n).Fo(),await _1(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,r)),await Sl(n)}var i}(t,e),M1(t)&&O1(t)}async function av(t,e){const n=we(t);n.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const r=Ts(n);n.wu.add(3),await xl(n),r&&n.yu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.wu.delete(3),await Eh(n)}async function RH(t,e){const n=we(t);e?(n.wu.delete(2),await Eh(n)):e||(n.wu.add(2),await xl(n),n.yu.set("Unknown"))}function Bo(t){return t.Iu||(t.Iu=function(e,n,r){const i=we(e);return i.iu(),new vH(n,i.So,i.authCredentials,i.appCheckCredentials,i.It,r)}(t.datastore,t.asyncQueue,{Yr:CH.bind(null,t),Zr:kH.bind(null,t),zo:IH.bind(null,t)}),t.mu.push(async e=>{e?(t.Iu.Fo(),Qg(t)?Yg(t):t.yu.set("Unknown")):(await t.Iu.stop(),A1(t))})),t.Iu}function li(t){return t.Tu||(t.Tu=function(e,n,r){const i=we(e);return i.iu(),new EH(n,i.So,i.authCredentials,i.appCheckCredentials,i.It,r)}(t.datastore,t.asyncQueue,{Yr:MH.bind(null,t),Zr:DH.bind(null,t),eu:OH.bind(null,t),tu:NH.bind(null,t)}),t.mu.push(async e=>{e?(t.Tu.Fo(),await Sl(t)):(await t.Tu.stop(),t.du.length>0&&(K("RemoteStore",`Stopping write stream with ${t.du.length} pending writes`),t.du=[]))})),t.Tu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new jn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Zg(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function em(t,e){if(zt("AsyncQueue",`${e}: ${t}`),pi(t))return new se(U.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=ta(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new to(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof to)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new to;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(){this.Eu=new it(ee.comparator)}track(e){const n=e.doc.key,r=this.Eu.get(n);r?e.type!==0&&r.type===3?this.Eu=this.Eu.insert(n,e):e.type===3&&r.type!==1?this.Eu=this.Eu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Eu=this.Eu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Eu=this.Eu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Eu=this.Eu.remove(n):e.type===1&&r.type===2?this.Eu=this.Eu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Eu=this.Eu.insert(n,{type:2,doc:e.doc}):ae():this.Eu=this.Eu.insert(n,e)}Au(){const e=[];return this.Eu.inorderTraversal((n,r)=>{e.push(r)}),e}}class To{constructor(e,n,r,i,s,o,a,l){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l}static fromInitialDocuments(e,n,r,i){const s=[];return n.forEach(o=>{s.push({type:0,doc:o})}),new To(e,n,to.emptySet(n),s,r,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PH{constructor(){this.Ru=void 0,this.listeners=[]}}class LH{constructor(){this.queries=new gi(e=>OT(e),dh),this.onlineState="Unknown",this.bu=new Set}}async function N1(t,e){const n=we(t),r=e.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new PH),i)try{s.Ru=await n.onListen(r)}catch(o){const a=em(o,`Initialization of query '${Wf(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.listeners.push(e),e.Pu(n.onlineState),s.Ru&&e.vu(s.Ru)&&tm(n)}async function D1(t,e){const n=we(t),r=e.query;let i=!1;const s=n.queries.get(r);if(s){const o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function BH(t,e){const n=we(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.listeners)a.vu(i)&&(r=!0);o.Ru=i}}r&&tm(n)}function FH(t,e,n){const r=we(t),i=r.queries.get(e);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(e)}function tm(t){t.bu.forEach(e=>{e.next()})}class R1{constructor(e,n,r){this.query=e,this.Vu=n,this.Su=!1,this.Du=null,this.onlineState="Unknown",this.options=r||{}}vu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new To(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.Su?this.Cu(e)&&(this.Vu.next(e),n=!0):this.xu(e,this.onlineState)&&(this.Nu(e),n=!0),this.Du=e,n}onError(e){this.Vu.error(e)}Pu(e){this.onlineState=e;let n=!1;return this.Du&&!this.Su&&this.xu(this.Du,e)&&(this.Nu(this.Du),n=!0),n}xu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.ku||!r)&&(!e.docs.isEmpty()||n==="Offline")}Cu(e){if(e.docChanges.length>0)return!0;const n=this.Du&&this.Du.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Nu(e){e=To.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Su=!0,this.Vu.next(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P1{constructor(e){this.key=e}}class L1{constructor(e){this.key=e}}class VH{constructor(e,n){this.query=e,this.Uu=n,this.qu=null,this.current=!1,this.Ku=Ie(),this.mutatedKeys=Ie(),this.Gu=NT(e),this.Qu=new to(this.Gu)}get ju(){return this.Uu}Wu(e,n){const r=n?n.zu:new lv,i=n?n.Qu:this.Qu;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((u,h)=>{const d=i.get(u),f=Ug(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let m=!1;d&&f?d.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Hu(d,f)||(r.track({type:2,doc:f}),m=!0,(l&&this.Gu(f,l)>0||c&&this.Gu(f,c)<0)&&(a=!0)):!d&&f?(r.track({type:0,doc:f}),m=!0):d&&!f&&(r.track({type:1,doc:d}),m=!0,(l||c)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(u):s.delete(u)):(o=o.delete(u),s=s.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),s=s.delete(u.key),r.track({type:1,doc:u})}return{Qu:o,zu:r,$i:a,mutatedKeys:s}}Hu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const s=e.zu.Au();s.sort((c,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ae()}};return f(h)-f(d)}(c.type,u.type)||this.Gu(c.doc,u.doc)),this.Ju(r);const o=n?this.Yu():[],a=this.Ku.size===0&&this.current?1:0,l=a!==this.qu;return this.qu=a,s.length!==0||l?{snapshot:new To(this.query,e.Qu,i,s,e.mutatedKeys,a===0,l,!1),Xu:o}:{Xu:o}}Pu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new lv,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(n=>this.Uu=this.Uu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Uu=this.Uu.delete(n)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Ie(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const n=[];return e.forEach(r=>{this.Ku.has(r)||n.push(new L1(r))}),this.Ku.forEach(r=>{e.has(r)||n.push(new P1(r))}),n}tc(e){this.Uu=e.Hi,this.Ku=Ie();const n=this.Wu(e.documents);return this.applyChanges(n,!0)}ec(){return To.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,this.qu===0)}}class $H{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class UH{constructor(e){this.key=e,this.nc=!1}}class zH{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.sc={},this.ic=new gi(a=>OT(a),dh),this.rc=new Map,this.oc=new Set,this.uc=new it(ee.comparator),this.cc=new Map,this.ac=new Wg,this.hc={},this.lc=new Map,this.fc=ms.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return this.dc===!0}}async function HH(t,e){const n=ZH(t);let r,i;const s=n.ic.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.ec();else{const o=await fH(n.localStore,qn(e));n.isPrimaryClient&&C1(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await jH(n,e,r,a==="current")}return i}async function jH(t,e,n,r){t._c=(u,h,d)=>async function(f,p,g,m){let w=p.view.Wu(g);w.$i&&(w=await iv(f.localStore,p.query,!1).then(({documents:y})=>p.view.Wu(y,w)));const _=m&&m.targetChanges.get(p.targetId),M=p.view.applyChanges(w,f.isPrimaryClient,_);return uv(f,p.targetId,M.Xu),M.snapshot}(t,u,h,d);const i=await iv(t.localStore,e,!0),s=new VH(e,i.Hi),o=s.Wu(i.documents),a=El.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),l=s.applyChanges(o,t.isPrimaryClient,a);uv(t,n,l.Xu);const c=new $H(e,n,s);return t.ic.set(e,c),t.rc.has(n)?t.rc.get(n).push(e):t.rc.set(n,[e]),l.snapshot}async function KH(t,e){const n=we(t),r=n.ic.get(e),i=n.rc.get(r.targetId);if(i.length>1)return n.rc.set(r.targetId,i.filter(s=>!dh(s,e))),void n.ic.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Qf(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),k1(n.remoteStore,r.targetId),Zf(n,r.targetId)}).catch(xs)):(Zf(n,r.targetId),await Qf(n.localStore,r.targetId,!0))}async function qH(t,e,n){const r=U1(t);try{const i=await function(s,o){const a=we(s),l=We.now(),c=o.reduce((d,f)=>d.add(f.key),Ie());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=hn(),p=Ie();return a.Gi.getEntries(d,c).next(g=>{f=g,f.forEach((m,w)=>{w.isValidDocument()||(p=p.add(m))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(g=>{u=g;const m=[];for(const w of o){const _=YU(w,u.get(w.key).overlayedDocument);_!=null&&m.push(new Ir(w.key,_,_T(_.value.mapValue),Kt.exists(!0)))}return a.mutationQueue.addMutationBatch(d,l,m,o)}).next(g=>{h=g;const m=g.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,g.batchId,m)})}).then(()=>({batchId:h.batchId,changes:jT(u)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let l=s.hc[s.currentUser.toKey()];l||(l=new it(Te)),l=l.insert(o,a),s.hc[s.currentUser.toKey()]=l}(r,i.batchId,n),await Tl(r,i.changes),await Sl(r.remoteStore)}catch(i){const s=em(i,"Failed to persist write");n.reject(s)}}async function B1(t,e){const n=we(t);try{const r=await uH(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.cc.get(s);o&&(be(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.nc=!0:i.modifiedDocuments.size>0?be(o.nc):i.removedDocuments.size>0&&(be(o.nc),o.nc=!1))}),await Tl(n,r,e)}catch(r){await xs(r)}}function cv(t,e,n){const r=we(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.ic.forEach((s,o)=>{const a=o.view.Pu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){const a=we(s);a.onlineState=o;let l=!1;a.queries.forEach((c,u)=>{for(const h of u.listeners)h.Pu(o)&&(l=!0)}),l&&tm(a)}(r.eventManager,e),i.length&&r.sc.zo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function WH(t,e,n){const r=we(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.cc.get(e),s=i&&i.key;if(s){let o=new it(ee.comparator);o=o.insert(s,qe.newNoDocument(s,ge.min()));const a=Ie().add(s),l=new mh(ge.min(),new Map,new $e(Te),o,a);await B1(r,l),r.uc=r.uc.remove(s),r.cc.delete(e),nm(r)}else await Qf(r.localStore,e,!1).then(()=>Zf(r,e,n)).catch(xs)}async function GH(t,e){const n=we(t),r=e.batch.batchId;try{const i=await cH(n.localStore,e);V1(n,r,null),F1(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Tl(n,i)}catch(i){await xs(i)}}async function JH(t,e,n){const r=we(t);try{const i=await function(s,o){const a=we(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let c;return a.mutationQueue.lookupMutationBatch(l,o).next(u=>(be(u!==null),c=u.keys(),a.mutationQueue.removeMutationBatch(l,u))).next(()=>a.mutationQueue.performConsistencyCheck(l)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(l,c,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,c)).next(()=>a.localDocuments.getDocuments(l,c))})}(r.localStore,e);V1(r,e,n),F1(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Tl(r,i)}catch(i){await xs(i)}}function F1(t,e){(t.lc.get(e)||[]).forEach(n=>{n.resolve()}),t.lc.delete(e)}function V1(t,e,n){const r=we(t);let i=r.hc[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.hc[r.currentUser.toKey()]=i}}function Zf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.rc.get(e))t.ic.delete(r),n&&t.sc.wc(r,n);t.rc.delete(e),t.isPrimaryClient&&t.ac.ls(e).forEach(r=>{t.ac.containsKey(r)||$1(t,r)})}function $1(t,e){t.oc.delete(e.path.canonicalString());const n=t.uc.get(e);n!==null&&(k1(t.remoteStore,n),t.uc=t.uc.remove(e),t.cc.delete(n),nm(t))}function uv(t,e,n){for(const r of n)r instanceof P1?(t.ac.addReference(r.key,e),XH(t,r)):r instanceof L1?(K("SyncEngine","Document no longer in limbo: "+r.key),t.ac.removeReference(r.key,e),t.ac.containsKey(r.key)||$1(t,r.key)):ae()}function XH(t,e){const n=e.key,r=n.path.canonicalString();t.uc.get(n)||t.oc.has(r)||(K("SyncEngine","New document in limbo: "+n),t.oc.add(r),nm(t))}function nm(t){for(;t.oc.size>0&&t.uc.size<t.maxConcurrentLimboResolutions;){const e=t.oc.values().next().value;t.oc.delete(e);const n=new ee(Ve.fromString(e)),r=t.fc.next();t.cc.set(r,new UH(n)),t.uc=t.uc.insert(n,r),C1(t.remoteStore,new Zr(qn(hh(n.path)),r,2,In.at))}}async function Tl(t,e,n){const r=we(t),i=[],s=[],o=[];r.ic.isEmpty()||(r.ic.forEach((a,l)=>{o.push(r._c(l,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(l.targetId,c!=null&&c.fromCache?"not-current":"current"),c){i.push(c);const u=Jg.Ci(l.targetId,c);s.push(u)}}))}),await Promise.all(o),r.sc.zo(i),await async function(a,l){const c=we(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>k.forEach(l,h=>k.forEach(h.Si,d=>c.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>k.forEach(h.Di,d=>c.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!pi(u))throw u;K("LocalStore","Failed to update sequence numbers: "+u)}for(const u of l){const h=u.targetId;if(!u.fromCache){const d=c.Ui.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);c.Ui=c.Ui.insert(h,p)}}}(r.localStore,s))}async function YH(t,e){const n=we(t);if(!n.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const r=await v1(n.localStore,e);n.currentUser=e,function(i,s){i.lc.forEach(o=>{o.forEach(a=>{a.reject(new se(U.CANCELLED,s))})}),i.lc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Tl(n,r.ji)}}function QH(t,e){const n=we(t),r=n.cc.get(e);if(r&&r.nc)return Ie().add(r.key);{let i=Ie();const s=n.rc.get(e);if(!s)return i;for(const o of s){const a=n.ic.get(o);i=i.unionWith(a.view.ju)}return i}}function ZH(t){const e=we(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=B1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=QH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WH.bind(null,e),e.sc.zo=BH.bind(null,e.eventManager),e.sc.wc=FH.bind(null,e.eventManager),e}function U1(t){const e=we(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JH.bind(null,e),e}class z1{constructor(){this.synchronizeTabs=!1}async initialize(e){this.It=vh(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,n){return null}Ec(e,n){return null}Ic(e){return w1(this.persistence,new b1,e.initialUser,this.It)}yc(e){return new y1(wh.Bs,this.It)}gc(e){return new x1}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ej extends z1{constructor(e,n,r){super(),this.Ac=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ac.initialize(this,e),await U1(this.Ac.syncEngine),await Sl(this.Ac.remoteStore),await this.persistence.li(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Ic(e){return w1(this.persistence,new b1,e.initialUser,this.It)}Tc(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new Wz(r,e.asyncQueue,n)}Ec(e,n){const r=new xU(n,this.persistence);return new EU(e.asyncQueue,r)}yc(e){const n=aH(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?en.withCacheSize(this.cacheSizeBytes):en.DEFAULT;return new Gg(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,wH(),Ec(),this.It,this.sharedClientState,!!this.forceOwnership)}gc(e){return new x1}}class H1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>cv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=YH.bind(null,this.syncEngine),await RH(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new LH}createDatastore(e){const n=vh(e.databaseInfo.databaseId),r=(i=e.databaseInfo,new bH(i));var i;return function(s,o,a,l){return new xH(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,i=e.asyncQueue,s=a=>cv(this.syncEngine,a,0),o=ov.C()?new ov:new gH,new TH(n,r,i,s,o);var n,r,i,s,o}createSyncEngine(e,n){return function(r,i,s,o,a,l,c){const u=new zH(r,i,s,o,a,l);return c&&(u.dc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=we(e);K("RemoteStore","RemoteStore shutting down."),n.wu.add(5),await xl(n),n.gu.shutdown(),n.yu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(t,e,n){if(!n)throw new se(U.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function tj(t,e,n,r){if(e===!0&&r===!0)throw new se(U.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function hv(t){if(!ee.isDocumentKey(t))throw new se(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dv(t){if(ee.isDocumentKey(t))throw new se(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ae()}function pr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new se(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=rm(t);throw new se(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv=new Map;class pv{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new se(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new se(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,tj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pv({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new se(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new se(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pv(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new lU;switch(n.type){case"gapi":const r=n.client;return new dU(r,n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new se(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=fv.get(e);n&&(K("ComponentProvider","Removing Datastore"),fv.delete(e),n.terminate())}(this),Promise.resolve()}}function nj(t,e,n,r={}){var i;const s=(t=pr(t,xh))._getSettings();if(s.host!=="firestore.googleapis.com"&&s.host!==e&&su("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let o,a;if(typeof r.mockUserToken=="string")o=r.mockUserToken,a=wt.MOCK_USER;else{o=sS(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new se(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new wt(l)}t._authCredentials=new cU(new bT(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ei(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new gn(this.firestore,e,this._key)}}class Sh{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Sh(this.firestore,e,this._query)}}class ei extends Sh{constructor(e,n,r){super(e,n,hh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new gn(this.firestore,null,new ee(e))}withConverter(e){return new ei(this.firestore,e,this._path)}}function Id(t,e,...n){if(t=Nn(t),j1("collection","path",e),t instanceof xh){const r=Ve.fromString(e,...n);return dv(r),new ei(t,null,r)}{if(!(t instanceof gn||t instanceof ei))throw new se(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return dv(r),new ei(t.firestore,null,r)}}function xc(t,e,...n){if(t=Nn(t),arguments.length===1&&(e=wT.R()),j1("doc","path",e),t instanceof xh){const r=Ve.fromString(e,...n);return hv(r),new gn(t,null,new ee(r))}{if(!(t instanceof gn||t instanceof ei))throw new se(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ve.fromString(e,...n));return hv(r),new gn(t.firestore,t instanceof ei?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):zt("Uncaught Error in snapshot listener:",e)}bc(){this.muted=!0}Rc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=wt.UNAUTHENTICATED,this.clientId=wT.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{K("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(K("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new se(U.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=em(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function q1(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await v1(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function W1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await ij(t);K("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(i=>av(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,s)=>av(e.remoteStore,s)),t.onlineComponents=e}async function ij(t){return t.offlineComponents||(K("FirestoreClient","Using default OfflineComponentProvider"),await q1(t,new z1)),t.offlineComponents}async function G1(t){return t.onlineComponents||(K("FirestoreClient","Using default OnlineComponentProvider"),await W1(t,new H1)),t.onlineComponents}function sj(t){return G1(t).then(e=>e.syncEngine)}async function J1(t){const e=await G1(t),n=e.eventManager;return n.onListen=HH.bind(null,e.syncEngine),n.onUnlisten=KH.bind(null,e.syncEngine),n}function oj(t,e,n={}){const r=new jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,l){const c=new K1({next:h=>{s.enqueueAndForget(()=>D1(i,u));const d=h.docs.has(o);!d&&h.fromCache?l.reject(new se(U.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?l.reject(new se(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(h)},error:h=>l.reject(h)}),u=new R1(hh(o.path),c,{includeMetadataChanges:!0,ku:!0});return N1(i,u)}(await J1(t),t.asyncQueue,e,n,r)),r.promise}function aj(t,e,n={}){const r=new jn;return t.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,l){const c=new K1({next:h=>{s.enqueueAndForget(()=>D1(i,u)),h.fromCache&&a.source==="server"?l.reject(new se(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(h)},error:h=>l.reject(h)}),u=new R1(o,c,{includeMetadataChanges:!0,ku:!0});return N1(i,u)}(await J1(t),t.asyncQueue,e,n,r)),r.promise}class lj{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.No=new S1(this,"async_queue_retry"),this.Wc=()=>{const n=Ec();n&&K("AsyncQueue","Visibility state changed to "+n.visibilityState),this.No.Po()};const e=Ec();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const n=Ec();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise(()=>{});const n=new jn;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}async Jc(){if(this.Lc.length!==0){try{await this.Lc[0](),this.Lc.shift(),this.No.reset()}catch(e){if(!pi(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.No.Ro(()=>this.Jc())}}Hc(e){const n=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{this.Kc=r,this.Gc=!1;const i=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(r);throw zt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Gc=!1,r))));return this.Bc=n,n}enqueueAfterDelay(e,n,r){this.zc(),this.jc.indexOf(e)>-1&&(n=0);const i=Zg.createAndSchedule(this,e,n,r,s=>this.Yc(s));return this.qc.push(i),i}zc(){this.Kc&&ae()}verifyOperationInProgress(){}async Xc(){let e;do e=this.Bc,await e;while(e!==this.Bc)}Zc(e){for(const n of this.qc)if(n.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.qc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.qc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const n=this.qc.indexOf(e);this.qc.splice(n,1)}}class Cs extends xh{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new lj,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||X1(this),this._firestoreClient.terminate()}}function cj(t,e){const n=typeof t=="object"?t:fS(),r=typeof t=="string"?t:e||"(default)",i=uS(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=iS("firestore");if(s){const[o,a]=s.split(":");nj(i,o,parseInt(a,10))}}return i}function Th(t){return t._firestoreClient||X1(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function X1(t){var e;const n=t._freezeSettings(),r=function(i,s,o,a){return new TU(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new rj(t._authCredentials,t._appCheckCredentials,t._queue,r)}function uj(t,e){dj(t=pr(t,Cs));const n=Th(t),r=t._freezeSettings(),i=new H1;return hj(n,i,new ej(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function hj(t,e,n){const r=new jn;return t.asyncQueue.enqueue(async()=>{try{await q1(t,n),await W1(t,e),r.resolve()}catch(i){const s=i;if(!function(o){return o.name==="FirebaseError"?o.code===U.FAILED_PRECONDITION||o.code===U.UNIMPLEMENTED:typeof DOMException<"u"&&o instanceof DOMException?o.code===22||o.code===20||o.code===11:!0}(s))throw s;su("Error enabling offline persistence. Falling back to persistence disabled: "+s),r.reject(s)}}).then(()=>r.promise)}function dj(t){if(t._initialized||t._terminated)throw new se(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Co(pt.fromBase64String(e))}catch(n){throw new se(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Co(pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new se(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new se(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new se(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=/^__.*__$/;class pj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ir(e,this.data,this.fieldMask,n,this.fieldTransforms):new Lo(e,this.data,n,this.fieldTransforms)}}class Y1{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ir(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Q1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ae()}}class om{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.It=r,this.ignoreUndefinedProperties=i,s===void 0&&this.na(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new om(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.ia({path:r,oa:!1});return i.ua(e),i}ca(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.ia({path:r,oa:!1});return i.na(),i}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return pu(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(e.length===0)throw this.ha("Document fields must not be empty");if(Q1(this.sa)&&fj.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class gj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.It=r||vh(e)}da(e,n,r,i=!1){return new om({sa:e,methodName:n,fa:r,path:tt.emptyPath(),oa:!1,la:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Z1(t){const e=t._freezeSettings(),n=vh(t._databaseId);return new gj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function mj(t,e,n,r,i,s={}){const o=t.da(s.merge||s.mergeFields?2:0,e,n,i);am("Data must be an object, but it was:",o,r);const a=eC(r,o);let l,c;if(s.merge)l=new fn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const u=[];for(const h of s.mergeFields){const d=ep(e,h,n);if(!o.contains(d))throw new se(U.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);nC(u,d)||u.push(d)}l=new fn(u),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new pj(new Ot(a),l,c)}class kh extends im{_toFieldTransform(e){if(e.sa!==2)throw e.sa===1?e.ha(`${this._methodName}() can only appear at the top level of your update data`):e.ha(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof kh}}function yj(t,e,n,r){const i=t.da(1,e,n);am("Data must be an object, but it was:",i,r);const s=[],o=Ot.empty();Ss(r,(l,c)=>{const u=lm(e,l,n);c=Nn(c);const h=i.ca(u);if(c instanceof kh)s.push(u);else{const d=Ih(c,h);d!=null&&(s.push(u),o.set(u,d))}});const a=new fn(s);return new Y1(o,a,i.fieldTransforms)}function bj(t,e,n,r,i,s){const o=t.da(1,e,n),a=[ep(e,r,n)],l=[i];if(s.length%2!=0)throw new se(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(ep(e,s[d])),l.push(s[d+1]);const c=[],u=Ot.empty();for(let d=a.length-1;d>=0;--d)if(!nC(c,a[d])){const f=a[d];let p=l[d];p=Nn(p);const g=o.ca(f);if(p instanceof kh)c.push(f);else{const m=Ih(p,g);m!=null&&(c.push(f),u.set(f,m))}}const h=new fn(c);return new Y1(u,h,o.fieldTransforms)}function Ih(t,e){if(tC(t=Nn(t)))return am("Unsupported field value:",e,t),eC(t,e);if(t instanceof im)return function(n,r){if(!Q1(r.sa))throw r.ha(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.oa&&e.sa!==4)throw e.ha("Nested arrays are not supported");return function(n,r){const i=[];let s=0;for(const o of n){let a=Ih(o,r.aa(s));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(t,e)}return function(n,r){if((n=Nn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return jU(r.It,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=We.fromDate(n);return{timestampValue:rl(r.It,i)}}if(n instanceof We){const i=new We(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:rl(r.It,i)}}if(n instanceof sm)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Co)return{bytesValue:JT(r.It,n._byteString)};if(n instanceof gn){const i=r.databaseId,s=n.firestore._databaseId;if(!s.isEqual(i))throw r.ha(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:zg(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.ha(`Unsupported field value: ${rm(n)}`)}(t,e)}function eC(t,e){const n={};return CT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ss(t,(r,i)=>{const s=Ih(i,e.ra(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function tC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof We||t instanceof sm||t instanceof Co||t instanceof gn||t instanceof im)}function am(t,e,n){if(!tC(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=rm(n);throw r==="an object"?e.ha(t+" a custom object"):e.ha(t+" "+r)}}function ep(t,e,n){if((e=Nn(e))instanceof Ch)return e._internalPath;if(typeof e=="string")return lm(t,e);throw pu("Field path arguments must be of type string or ",t,!1,void 0,n)}const wj=new RegExp("[~\\*/\\[\\]]");function lm(t,e,n){if(e.search(wj)>=0)throw pu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ch(...e.split("."))._internalPath}catch{throw pu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function pu(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new se(U.INVALID_ARGUMENT,a+t+l)}function nC(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new gn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(iC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class vj extends rC{data(){return super.data()}}function iC(t,e){return typeof e=="string"?lm(t,e):e instanceof Ch?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new se(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{convertValue(e,n="none"){switch(ds(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw ae()}}convertObject(e,n){const r={};return Ss(e.fields,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new sm(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=IT(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xa(e));default:return null}}convertTimestamp(e){const n=oi(e);return new We(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ve.fromString(e);be(r1(r));const i=new hs(r.get(1),r.get(3)),s=new ee(r.popFirst(5));return i.isEqual(n)||zt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sj(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class sC extends rC{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Sc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(iC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Sc extends sC{data(e={}){return super.data(e)}}class Tj{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ra(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Sc(this._firestore,this._userDataWriter,r.key,r,new ra(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new se(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(o=>({type:"added",doc:new Sc(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ra(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}))}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const a=new Sc(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ra(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let l=-1,c=-1;return o.type!==0&&(l=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),c=s.indexOf(o.doc.key)),{type:Cj(o.type),doc:a,oldIndex:l,newIndex:c}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function Cj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ae()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(t){t=pr(t,gn);const e=pr(t.firestore,Cs);return oj(Th(e),t._key).then(n=>Mj(e,t,n))}class oC extends xj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Co(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new gn(this.firestore,null,n)}}function Ij(t){t=pr(t,Sh);const e=pr(t.firestore,Cs),n=Th(e),r=new oC(e);return Ej(t._query),aj(n,t._query).then(i=>new Tj(e,r,t,i))}function Aj(t,e,n,...r){t=pr(t,gn);const i=pr(t.firestore,Cs),s=Z1(i);let o;return o=typeof(e=Nn(e))=="string"||e instanceof Ch?bj(s,"updateDoc",t._key,e,n,r):yj(s,"updateDoc",t._key,e),cm(i,[o.toMutation(t._key,Kt.exists(!0))])}function _j(t){return cm(pr(t.firestore,Cs),[new gh(t._key,Kt.none())])}function gv(t,e){const n=pr(t.firestore,Cs),r=xc(t),i=Sj(t.converter,e);return cm(n,[mj(Z1(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,Kt.exists(!1))]).then(()=>r)}function cm(t,e){return function(n,r){const i=new jn;return n.asyncQueue.enqueueAndForget(async()=>qH(await sj(n),r,i)),i.promise}(Th(t),e)}function Mj(t,e,n){const r=n.docs.get(e._key),i=new oC(t);return new sC(t,i,e._key,r,new ra(n.hasPendingWrites,n.fromCache),e.converter)}(function(t,e=!0){(function(n){Po=n})(hS),za(new bo("firestore",(n,{instanceIdentifier:r,options:i})=>{const s=n.getProvider("app").getImmediate(),o=new Cs(new uU(n.getProvider("auth-internal")),new pU(n.getProvider("app-check-internal")),function(a,l){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new se(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(a.options.projectId,l)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Qr(yw,"3.6.0",t),Qr(yw,"3.6.0","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC="firebasestorage.googleapis.com",lC="storageBucket",Oj=2*60*1e3,Nj=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye extends vs{constructor(e,n){super(Ad(e),`Firebase Storage: ${n} (${Ad(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ye.prototype)}_codeEquals(e){return Ad(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function Ad(t){return"storage/"+t}function um(){const t="An unknown error occurred, please check the error payload for server response.";return new Ye("unknown",t)}function Dj(t){return new Ye("object-not-found","Object '"+t+"' does not exist.")}function Rj(t){return new Ye("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Pj(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ye("unauthenticated",t)}function Lj(){return new Ye("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function Bj(t){return new Ye("unauthorized","User does not have permission to access '"+t+"'.")}function Fj(){return new Ye("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function cC(){return new Ye("canceled","User canceled the upload/download.")}function Vj(t){return new Ye("invalid-url","Invalid URL '"+t+"'.")}function $j(t){return new Ye("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function Uj(){return new Ye("no-default-bucket","No default bucket found. Did you set the '"+lC+"' property when initializing the app?")}function uC(){return new Ye("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function zj(){return new Ye("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function Hj(){return new Ye("no-download-url","The given file does not have any download URLs.")}function tp(t){return new Ye("invalid-argument",t)}function hC(){return new Ye("app-deleted","The Firebase app was deleted.")}function jj(t){return new Ye("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function va(t,e){return new Ye("invalid-format","String does not match format '"+t+"': "+e)}function Go(t){throw new Ye("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=dn.makeFromUrl(e,n)}catch{return new dn(e,"")}if(r.path==="")return r;throw $j(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(y){y.path.charAt(y.path.length-1)==="/"&&(y.path_=y.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(y){y.path_=decodeURIComponent(y.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${i}/o${d}`,"i"),p={bucket:1,path:3},g=n===aC?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",w=new RegExp(`^https?://${g}/${i}/${m}`,"i"),M=[{regex:a,indices:l,postModify:s},{regex:f,indices:p,postModify:c},{regex:w,indices:{bucket:1,path:2},postModify:c}];for(let y=0;y<M.length;y++){const L=M[y],R=L.regex.exec(e);if(R){const j=R[L.indices.bucket];let N=R[L.indices.path];N||(N=""),r=new dn(j,N),L.postModify(r);break}}if(r==null)throw Vj(e);return r}}class Kj{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qj(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...m){c||(c=!0,e.apply(null,m))}function h(m){i=setTimeout(()=>{i=null,t(f,l())},m)}function d(){s&&clearTimeout(s)}function f(m,...w){if(c){d();return}if(m){d(),u.call(null,m,...w);return}if(l()||o){d(),u.call(null,m,...w);return}r<64&&(r*=2);let M;a===1?(a=2,M=0):M=(r+Math.random())*1e3,h(M)}let p=!1;function g(m){p||(p=!0,d(),!c&&(i!==null?(m||(a=2),clearTimeout(i),h(0)):m||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function Wj(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(t){return t!==void 0}function Jj(t){return typeof t=="function"}function Xj(t){return typeof t=="object"&&!Array.isArray(t)}function Ah(t){return typeof t=="string"||t instanceof String}function mv(t){return hm()&&t instanceof Blob}function hm(){return typeof Blob<"u"}function yv(t,e,n,r){if(r<e)throw tp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw tp(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cl(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function dC(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var es;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(es||(es={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e,n,r,i,s,o,a,l,c,u,h){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new rc(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===es.NO_ERROR,l=s.getStatus();if(!a||this.isRetryStatusCode_(l)){const u=s.getErrorCode()===es.ABORT;r(!1,new rc(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new rc(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Gj(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=um();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?hC():cC();o(l)}else{const l=Fj();o(l)}};this.canceled_?n(!1,new rc(!1,null,!0)):this.backoffId_=qj(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Wj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,i=[408,429].indexOf(e)!==-1,s=this.additionalRetryCodes_.indexOf(e)!==-1;return n||i||s}}class rc{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Qj(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Zj(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function eK(t,e){e&&(t["X-Firebase-GMPID"]=e)}function tK(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function nK(t,e,n,r,i,s){const o=dC(t.urlParams),a=t.url+o,l=Object.assign({},t.headers);return eK(l,e),Qj(l,n),Zj(l,s),tK(l,r),new Yj(a,t.method,l,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rK(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function iK(...t){const e=rK();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(hm())return new Blob(t);throw new Ye("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function sK(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oK(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class _d{constructor(e,n){this.data=e,this.contentType=n||null}}function aK(t,e){switch(t){case ar.RAW:return new _d(fC(e));case ar.BASE64:case ar.BASE64URL:return new _d(pC(t,e));case ar.DATA_URL:return new _d(cK(e),uK(e))}throw um()}function fC(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const s=r,o=t.charCodeAt(++n);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function lK(t){let e;try{e=decodeURIComponent(t)}catch{throw va(ar.DATA_URL,"Malformed data URL.")}return fC(e)}function pC(t,e){switch(t){case ar.BASE64:{const i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw va(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case ar.BASE64URL:{const i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw va(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=oK(e)}catch{throw va(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class gC{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw va(ar.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=hK(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function cK(t){const e=new gC(t);return e.base64?pC(ar.BASE64,e.rest):lK(e.rest)}function uK(t){return new gC(t).contentType}function hK(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(e,n){let r=0,i="";mv(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(mv(this.data_)){const r=this.data_,i=sK(r,e,n);return i===null?null:new Fr(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Fr(r,!0)}}static getBlob(...e){if(hm()){const n=e.map(r=>r instanceof Fr?r.data_:r);return new Fr(iK.apply(null,n))}else{const n=e.map(o=>Ah(o)?aK(ar.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const i=new Uint8Array(r);let s=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new Fr(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mC(t){let e;try{e=JSON.parse(t)}catch{return null}return Xj(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dK(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function fK(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function yC(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pK(t,e){return e}class $t{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||pK}}let ic=null;function gK(t){return!Ah(t)||t.length<2?t:yC(t)}function bC(){if(ic)return ic;const t=[];t.push(new $t("bucket")),t.push(new $t("generation")),t.push(new $t("metageneration")),t.push(new $t("name","fullPath",!0));function e(s,o){return gK(o)}const n=new $t("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new $t("size");return i.xform=r,t.push(i),t.push(new $t("timeCreated")),t.push(new $t("updated")),t.push(new $t("md5Hash",null,!0)),t.push(new $t("cacheControl",null,!0)),t.push(new $t("contentDisposition",null,!0)),t.push(new $t("contentEncoding",null,!0)),t.push(new $t("contentLanguage",null,!0)),t.push(new $t("contentType",null,!0)),t.push(new $t("metadata","customMetadata",!0)),ic=t,ic}function mK(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new dn(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function yK(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return mK(r,t),r}function wC(t,e,n){const r=mC(e);return r===null?null:yK(t,r,n)}function bK(t,e,n,r){const i=mC(e);if(i===null||!Ah(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=Cl(d,n,r),p=dC({alt:"media",token:c});return f+p})[0]}function vC(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const s=e[i];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}class Fo{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(t){if(!t)throw um()}function dm(t,e){function n(r,i){const s=wC(t,i,e);return xr(s!==null),s}return n}function wK(t,e){function n(r,i){const s=wC(t,i,e);return xr(s!==null),bK(s,i,t.host,t._protocol)}return n}function kl(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=Lj():i=Pj():n.getStatus()===402?i=Rj(t.bucket):n.getStatus()===403?i=Bj(t.path):i=r,i.serverResponse=r.serverResponse,i}return e}function EC(t){const e=kl(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=Dj(t.path)),s.serverResponse=i.serverResponse,s}return n}function vK(t,e,n){const r=e.fullServerUrl(),i=Cl(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new Fo(i,s,dm(t,n),o);return a.errorHandler=EC(e),a}function EK(t,e,n){const r=e.fullServerUrl(),i=Cl(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new Fo(i,s,wK(t,n),o);return a.errorHandler=EC(e),a}function xK(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function xC(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=xK(null,e)),r}function SK(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let M="";for(let y=0;y<2;y++)M=M+Math.random().toString().slice(2);return M}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=xC(e,r,i),u=vC(c,n),h="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",f=Fr.getBlob(h,r,d);if(f===null)throw uC();const p={name:c.fullPath},g=Cl(s,t.host,t._protocol),m="POST",w=t.maxUploadRetryTime,_=new Fo(g,m,dm(t,n),w);return _.urlParams=p,_.headers=o,_.body=f.uploadData(),_.errorHandler=kl(e),_}class gu{constructor(e,n,r,i){this.current=e,this.total=n,this.finalized=!!r,this.metadata=i||null}}function fm(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{xr(!1)}return xr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function TK(t,e,n,r,i){const s=e.bucketOnlyServerUrl(),o=xC(e,r,i),a={name:o.fullPath},l=Cl(s,t.host,t._protocol),c="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=vC(o,n),d=t.maxUploadRetryTime;function f(g){fm(g);let m;try{m=g.getResponseHeader("X-Goog-Upload-URL")}catch{xr(!1)}return xr(Ah(m)),m}const p=new Fo(l,c,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=kl(e),p}function CK(t,e,n,r){const i={"X-Goog-Upload-Command":"query"};function s(c){const u=fm(c,["active","final"]);let h=null;try{h=c.getResponseHeader("X-Goog-Upload-Size-Received")}catch{xr(!1)}h||xr(!1);const d=Number(h);return xr(!isNaN(d)),new gu(d,r.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,l=new Fo(n,o,s,a);return l.headers=i,l.errorHandler=kl(e),l}const bv=256*1024;function kK(t,e,n,r,i,s,o,a){const l=new gu(0,0);if(o?(l.current=o.current,l.total=o.total):(l.current=0,l.total=r.size()),r.size()!==l.total)throw zj();const c=l.total-l.current;let u=c;i>0&&(u=Math.min(u,i));const h=l.current,d=h+u,p={"X-Goog-Upload-Command":u===c?"upload, finalize":"upload","X-Goog-Upload-Offset":`${l.current}`},g=r.slice(h,d);if(g===null)throw uC();function m(y,L){const R=fm(y,["active","final"]),j=l.current+u,N=r.size();let G;return R==="final"?G=dm(e,s)(y,L):G=null,new gu(j,N,R==="final",G)}const w="POST",_=e.maxUploadRetryTime,M=new Fo(n,w,m,_);return M.headers=p,M.body=g.uploadData(),M.progressCallback=a||null,M.errorHandler=kl(t),M}const tn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Md(t){switch(t){case"running":case"pausing":case"canceling":return tn.RUNNING;case"paused":return tn.PAUSED;case"success":return tn.SUCCESS;case"canceled":return tn.CANCELED;case"error":return tn.ERROR;default:return tn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IK{constructor(e,n,r){if(Jj(e)||n!=null||r!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=r!=null?r:void 0;else{const s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rs(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class AK{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=es.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=es.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=es.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw Go("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Go("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Go("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Go("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Go("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class _K extends AK{initXhr(){this.xhr_.responseType="text"}}function Vs(){return new _K}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MK{constructor(e,n,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=bC(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=i,this._transition("error"))},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,r])=>{switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const r=TK(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Vs,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,r)=>{const i=CK(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,Vs,n,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=bv*this._chunkMultiplier,n=new gu(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=kK(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(l){this._error=l,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Vs,i,s);this._request=a,a.getPromise().then(l=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(l.current),l.finalized?(this._metadata=l.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){bv*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const r=vK(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,Vs,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const r=SK(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,Vs,e,n);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=cC(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Md(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,r,i){const s=new IK(n||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Md(this._state)){case tn.SUCCESS:Rs(this._resolve.bind(null,this.snapshot))();break;case tn.CANCELED:case tn.ERROR:const n=this._reject;Rs(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Md(this._state)){case tn.RUNNING:case tn.PAUSED:e.next&&Rs(e.next.bind(e,this.snapshot))();break;case tn.SUCCESS:e.complete&&Rs(e.complete.bind(e))();break;case tn.CANCELED:case tn.ERROR:e.error&&Rs(e.error.bind(e,this._error))();break;default:e.error&&Rs(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys{constructor(e,n){this._service=e,n instanceof dn?this._location=n:this._location=dn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ys(e,n)}get root(){const e=new dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return yC(this._location.path)}get storage(){return this._service}get parent(){const e=dK(this._location.path);if(e===null)return null;const n=new dn(this._location.bucket,e);return new ys(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw jj(e)}}function OK(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new MK(t,new Fr(e),n)}function NK(t){t._throwIfRoot("getDownloadURL");const e=EK(t.storage,t._location,bC());return t.storage.makeRequestWithTokens(e,Vs).then(n=>{if(n===null)throw Hj();return n})}function DK(t,e){const n=fK(t._location.path,e),r=new dn(t._location.bucket,n);return new ys(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RK(t){return/^[A-Za-z]+:\/\//.test(t)}function PK(t,e){return new ys(t,e)}function SC(t,e){if(t instanceof pm){const n=t;if(n._bucket==null)throw Uj();const r=new ys(n,n._bucket);return e!=null?SC(r,e):r}else return e!==void 0?DK(t,e):t}function LK(t,e){if(e&&RK(e)){if(t instanceof pm)return PK(t,e);throw tp("To use ref(service, url), the first argument must be a Storage instance.")}else return SC(t,e)}function wv(t,e){const n=e==null?void 0:e[lC];return n==null?null:dn.makeFromBucketSpec(n,t)}function BK(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:sS(i,t.app.options.projectId))}class pm{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=aC,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Oj,this._maxUploadRetryTime=Nj,this._requests=new Set,i!=null?this._bucket=dn.makeFromBucketSpec(i,this._host):this._bucket=wv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dn.makeFromBucketSpec(this._url,e):this._bucket=wv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ys(this,e)}_makeRequest(e,n,r,i){if(this._deleted)return new Kj(hC());{const s=nK(e,this._appId,r,i,n,this._firebaseVersion);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const vv="@firebase/storage",Ev="0.9.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC="storage";function FK(t,e,n){return t=Nn(t),OK(t,e,n)}function VK(t){return t=Nn(t),NK(t)}function $K(t,e){return t=Nn(t),LK(t,e)}function UK(t=fS(),e){t=Nn(t);const r=uS(t,TC).getImmediate({identifier:e}),i=iS("storage");if(i){const[s,o]=i.split(":");zK(r,s,parseInt(o,10))}return r}function zK(t,e,n,r={}){BK(t,e,n,r)}function HK(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new pm(n,r,i,e,hS)}function jK(){za(new bo(TC,HK,"PUBLIC").setMultipleInstances(!0)),Qr(vv,Ev,""),Qr(vv,Ev,"esm2017")}jK();const CC=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n};ul.registerLanguage("html",AL);ul.registerLanguage("css",vL);ul.registerLanguage("js",CL);ul.registerLanguage("ts",IL);const KK={apiKey:"AIzaSyCubD42khVRvb7mj1TGhiZCih0XOLUc9bM",authDomain:"pcou-editor.firebaseapp.com",projectId:"pcou-editor",storageBucket:"pcou-editor.appspot.com",messagingSenderId:"810870940225",appId:"1:810870940225:web:9b6169b6168c80ef8cdcc0"},qK=dS(KK),Ai=cj(qK);uj(Ai).catch(t=>{(t.code=="failed-precondition"||t.code=="unimplemented")&&console.log(t.code)});const WK=UK(),GK={components:{EditorContent:mR,BubbleMenu:pR},data(){return{editor:null,html:null,htmltitle:null,pageid:null,editable:!1,isLoading:!1,isDeleting:!1,isSaving:!1,toc:[],caption:"",img1:"",imageData:null,progress:0}},mounted(){this.openToc(),this.editor=new gR({editable:this.editable,content:this.openContent("r0eEMUtWa3jGwTdWrYTk"),extensions:[pP,fL.configure({lowlight:ul}),BF,NF.configure({resizable:!0}),PF,RF,DF]}),this.html=this.editor.getHTML(),this.editor.on("update",()=>{this.html=this.editor.getHTML()})},watch:{editable(){this.editor.setEditable(this.editable)}},methods:{setContent(){this.editor.commands.setContent(`
        <p>
          test content
        </p>
      `,!0),this.editor.commands.focus()},clearContent(){this.editor.chain().clearContent(!0).focus().run()},openToc:async function(){this.isLoading=!0,await Ij(Id(Ai,"topics")).then(t=>this.toc=t.docs).finally(()=>this.isLoading=!1)},openContent:async function(t){const e=xc(Ai,"topics",t),n=await kj(e);n.exists()&&(this.editor.commands.setContent(n.data().body,!0),this.pageid=t,this.htmltitle=n.data().title)},saveContent:async function(t){this.isSaving=!0;const e=xc(Ai,"topics",t);await Aj(e,{body:this.html,title:this.htmltitle}).then(()=>this.isSaving=!1),this.editor.commands.setContent(this.html,!0),this.editor.commands.focus()},deletePage:async function(t){this.isDeleting=!0;const e=xc(Ai,"topics",t);await _j(e).then(()=>{console.log("Entire Document has been deleted successfully.")}).finally(()=>this.isDeleting=!1),this.editor.commands.setContent("<p>content deleted</p>",!0),this.editor.commands.focus()},newContent:async function(){this.editor.commands.setContent("<p>new content</p>",!0),this.editor.commands.focus();const t=await gv(Id(Ai,"topics"),{title:"Title temp",body:"<p>new content</p>"});this.pageid=t.id},click1(){this.$refs.input1.click()},previewImage(t){this.uploadValue=0,this.img1=null,this.imageData=t.target.files[0],console.log("imagedata:",this.imageData),this.onUpload()},onUpload(){this.img1=null;const t=$K(WK,this.imageData.name),e=FK(t,this.imageData);e.on("state_changed",n=>{const r=n.bytesTransferred/n.totalBytes*100;switch(console.log("Upload is "+r+"% done"),n.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running");break}},n=>{},()=>{VK(e.snapshot.ref).then(n=>{this.img1=n,this.addImage()})})},addImage(){const t=this.img1;t&&this.editor.chain().focus().setImage({src:t}).run()},create:async function(){await gv(Id(Ai,"images"),{url:this.img1,caption:this.caption})}},beforeUnmount(){this.editor.destroy()}},JK={class:"actions"},XK={class:"map-actions"},YK=Y("i",{class:"fa fa-plus"},null,-1),QK=[YK],ZK=Y("i",{class:"fa fa-minus"},null,-1),eq=[ZK],tq={class:"content-actions"},nq={class:"checkboxedit",style:{"text-align":"right"}},rq=Y("label",{for:"editable"},"edit",-1),iq=Y("i",{class:"fa fa-bold"},null,-1),sq=[iq],oq=Y("i",{class:"fa fa-italic"},null,-1),aq=[oq],lq=Y("i",{class:"fa fa-list"},null,-1),cq=[lq],uq=Y("i",{class:"fa fa-image"},null,-1),hq=[uq],dq=Y("i",{class:"fa fa-table"},null,-1),fq=[dq],pq=["disabled"],gq=Y("i",{class:"fa fa-code"},null,-1),mq=[gq],yq=Y("i",{class:"fa fa-code"},"-",-1),bq=[yq],wq=["disabled"],vq=Y("i",{class:"fa fa-rotate-left"},null,-1),Eq=[vq],xq=["disabled"],Sq=Y("i",{class:"fa fa-rotate-right"},null,-1),Tq=[Sq],Cq=Y("i",{class:"fa fa-new"},null,-1),kq=Y("i",{class:"fa fa-save"},null,-1),Iq=Y("i",{class:"fa fa-upload"},null,-1),Aq=Y("i",{class:"fa fa-trash"},null,-1),_q=[Aq],Mq={key:1,class:"view-actions"},Oq=Y("i",{class:"fa fa-star"},null,-1),Nq=Y("i",{class:"fa fa-file-pdf"},null,-1),Dq=Y("i",{class:"fa fa-share"},null,-1),Rq=Y("div",{class:"rw-actions"},null,-1),Pq={class:"content-row"},Lq={class:"map-tree"},Bq=Y("h4",null,"Map",-1),Fq={key:0},Vq=["onClick"],$q={class:"editor"},Uq={key:0},zq={key:1},Hq=Y("i",{class:"fa fa-bold"},null,-1),jq=[Hq],Kq=Y("i",{class:"fa fa-italic"},null,-1),qq=[Kq],Wq={class:"export"},Gq=Y("h4",null,"HTML Rendering for check",-1),Jq={class:"rw-content"},Xq={key:0},Yq=Y("label",null,"Topic title: ",-1),Qq=EI('<p></p><label for="fname">Page alias: </label><br><input type="text" id="fname" name="fname" value="page1"><br><p></p><label class="container">Machine translation <input type="checkbox" checked="checked"><span class="checkmark"></span></label><p>Redability index: 30</p><p>seo-suggested search term: acme, pcou, </p><p>Product: Acme</p><p>Version: prod</p><h4>Chat/feedback </h4>',12),Zq={key:1},e2=Y("h4",null," On this page ",-1),t2=Y("p",null,"DataRelated Information ",-1),n2=Y("h4",null,"Was this page helpful? ",-1),r2=Y("p",null,"Yes/No",-1),i2=[e2,t2,n2,r2];function s2(t,e,n,r,i,s){const o=Vd("bubble-menu"),a=Vd("editor-content");return cn(),Rn(Sn,null,[Y("div",JK,[Y("div",XK,[Y("button",{class:"bta-v",onClick:e[0]||(e[0]=(...l)=>t.tbd&&t.tbd(...l))},QK),Y("button",{class:"bta-v",onClick:e[1]||(e[1]=(...l)=>t.tbd&&t.tbd(...l))},eq)]),Y("div",tq,[Y("div",nq,[rq,Mm(Y("input",{type:"checkbox",id:"editable","onUpdate:modelValue":e[2]||(e[2]=l=>i.editable=l)},null,512),[[tA,i.editable]])]),i.editable?(cn(),Rn("div",{key:0,class:Qt(["edit-actions",{editable:i.editable}])},[Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("heading",{level:1})}]),onClick:e[3]||(e[3]=l=>i.editor.chain().focus().toggleHeading({level:1}).run())},"H1",2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("heading",{level:2})}]),onClick:e[4]||(e[4]=l=>i.editor.chain().focus().toggleHeading({level:2}).run())},"H2",2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("heading",{level:3})}]),onClick:e[5]||(e[5]=l=>i.editor.chain().focus().toggleHeading({level:3}).run())},"H3",2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("bold")}]),onClick:e[6]||(e[6]=l=>i.editor.chain().focus().toggleBold().run())},sq,2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("italic")}]),onClick:e[7]||(e[7]=l=>i.editor.chain().focus().toggleItalic().run())},aq,2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("bulletList")}]),onClick:e[8]||(e[8]=l=>i.editor.chain().focus().toggleBulletList().run())},cq,2),Y("button",{class:"bta",onClick:e[9]||(e[9]=(...l)=>s.click1&&s.click1(...l))},hq),Y("input",{type:"file",ref:"input1",style:{display:"none"},onChange:e[10]||(e[10]=(...l)=>s.previewImage&&s.previewImage(...l)),accept:"image/*"},null,544),Y("button",{class:"bta",onClick:e[11]||(e[11]=l=>i.editor.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run())},fq),Y("button",{class:"bta",onClick:e[12]||(e[12]=l=>i.editor.chain().focus().setCodeBlock().run()),disabled:i.editor.isActive("codeBlock")},mq,8,pq),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("codeBlock")}]),onClick:e[13]||(e[13]=l=>i.editor.chain().focus().toggleCodeBlock().run())},bq,2),Y("button",{class:"bta",onClick:e[14]||(e[14]=l=>i.editor.chain().focus().undo().run()),disabled:!i.editor.can().undo()},Eq,8,wq),Y("button",{class:"bta",onClick:e[15]||(e[15]=l=>i.editor.chain().focus().redo().run()),disabled:!i.editor.can().redo()},Tq,8,xq),Y("button",{class:"bta",onClick:e[16]||(e[16]=l=>s.newContent())},[Cq,Ti("New")]),Y("button",{class:"bta",onClick:e[17]||(e[17]=l=>s.saveContent(i.pageid))},[Ti("Draft "),kq]),Y("button",{class:"bta",onClick:e[18]||(e[18]=(...l)=>t.tbd&&t.tbd(...l))},[Ti("Publish "),Iq]),Y("button",{class:"bta",onClick:e[19]||(e[19]=l=>s.deletePage(i.pageid))},_q)],2)):(cn(),Rn("div",Mq,[Y("button",{class:"bta-v",onClick:e[20]||(e[20]=(...l)=>t.tbd&&t.tbd(...l))},[Ti("Favorite "),Oq]),Y("button",{class:"bta-v",onClick:e[21]||(e[21]=(...l)=>t.tbd&&t.tbd(...l))},[Ti("pdf "),Nq]),Y("button",{class:"bta-v",onClick:e[22]||(e[22]=(...l)=>t.tbd&&t.tbd(...l))},[Ti("share "),Dq])]))]),Rq]),Y("div",Pq,[Y("div",Lq,[Bq,i.isLoading?(cn(),Rn("div",Fq,"Loading... ")):Pl("",!0),Y("ul",null,[(cn(!0),Rn(Sn,null,Yk(i.toc,l=>(cn(),Rn("li",null,[Y("a",{href:"#",onClick:sA(c=>s.openContent(l.id),["prevent"]),target:"_blank"},mm(l.data().title),9,Vq)]))),256))])]),Y("div",$q,[i.isDeleting?(cn(),Rn("div",Uq,"Deleting...")):Pl("",!0),i.isSaving?(cn(),Rn("div",zq,"Saving...")):Pl("",!0),i.editor?(cn(),h0(o,{key:2,editor:i.editor,"tippy-options":{duration:100}},{default:Xv(()=>[Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("bold")}]),onClick:e[23]||(e[23]=l=>i.editor.chain().focus().toggleBold().run())},jq,2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("italic")}]),onClick:e[24]||(e[24]=l=>i.editor.chain().focus().toggleItalic().run())},qq,2),Y("button",{class:Qt(["bta",{"is-active":i.editor.isActive("strike")}]),onClick:e[25]||(e[25]=l=>i.editor.chain().focus().toggleStrike().run())},"uicommand",2)]),_:1},8,["editor"])):Pl("",!0),Dt(a,{editor:i.editor},null,8,["editor"]),Y("div",Wq,[Gq,Y("pre",null,[Y("code",null,mm(i.html),1)])])]),Y("div",Jq,[i.editable?(cn(),Rn("div",Xq,[Yq,Mm(Y("input",{type:"text","onUpdate:modelValue":e[26]||(e[26]=l=>i.htmltitle=l),class:"input",required:""},null,512),[[eA,i.htmltitle]]),Qq])):(cn(),Rn("div",Zq,i2))])])],64)}const o2=CC(GK,[["render",s2]]);const a2={name:"app",components:{tthtml:o2}},l2={id:"app"},c2=Y("div",{class:"header"},[Y("p",{class:"header"}," Gazelle ua")],-1),u2=Y("div",{class:"infos"},[Y("p",{class:"infos"}," Item > Collection > topic1")],-1),h2={class:"viewer"};function d2(t,e,n,r,i,s){const o=Vd("tthtml");return cn(),Rn("div",l2,[c2,u2,Y("div",h2,[Dt(o)])])}const f2=CC(a2,[["render",d2]]);const p2=lA(f2);p2.mount("#app");
